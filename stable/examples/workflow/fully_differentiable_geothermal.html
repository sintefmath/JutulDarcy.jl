<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>A fully differentiable geothermal doublet: History matching and control optimization | JutulDarcy.jl</title>
    <meta name="description" content="Documentation for JutulDarcy.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/JutulDarcy.jl/stable/assets/style.CqUz2RbK.css" as="style">
    <link rel="preload stylesheet" href="/JutulDarcy.jl/stable/vp-icons.css" as="style">
    
    <script type="module" src="/JutulDarcy.jl/stable/assets/app.C7jJ6a9R.js"></script>
    <link rel="preload" href="/JutulDarcy.jl/stable/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/JutulDarcy.jl/stable/assets/chunks/theme.CfQLNLw1.js">
    <link rel="modulepreload" href="/JutulDarcy.jl/stable/assets/chunks/framework.DN6oqPSl.js">
    <link rel="modulepreload" href="/JutulDarcy.jl/stable/assets/examples_workflow_fully_differentiable_geothermal.md.Dd3CsqZ1.lean.js">
    <link rel="icon" href="/JutulDarcy.jl/stable/favicon.ico">
    <script src="/JutulDarcy.jl/versions.js"></script>
    <script src="/JutulDarcy.jl/stable/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/JutulDarcy.jl/stable/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/JutulDarcy.jl/stable/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>JutulDarcy.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Manual</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Introduction</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/index" data-v-acbfed09><!--[--><span data-v-acbfed09>JutulDarcy.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/intro" data-v-acbfed09><!--[--><span data-v-acbfed09>Getting started</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/first_ex" data-v-acbfed09><!--[--><span data-v-acbfed09>Your first JutulDarcy.jl simulation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/extras/faq" data-v-acbfed09><!--[--><span data-v-acbfed09>FAQ</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Fundamentals</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/highlevel" data-v-acbfed09><!--[--><span data-v-acbfed09>High-level API</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/input_files" data-v-acbfed09><!--[--><span data-v-acbfed09>Input formats</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/systems" data-v-acbfed09><!--[--><span data-v-acbfed09>Supported physical systems</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/solution" data-v-acbfed09><!--[--><span data-v-acbfed09>Solving the equations</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Detailed API</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/forces" data-v-acbfed09><!--[--><span data-v-acbfed09>Driving forces</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/wells" data-v-acbfed09><!--[--><span data-v-acbfed09>Wells and controls</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/primary" data-v-acbfed09><!--[--><span data-v-acbfed09>Primary variables</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/secondary" data-v-acbfed09><!--[--><span data-v-acbfed09>Secondary variables (properties)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/parameters" data-v-acbfed09><!--[--><span data-v-acbfed09>Parameters</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/plotting" data-v-acbfed09><!--[--><span data-v-acbfed09>Plotting and visualization</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/utilities" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Parallelism and compilation</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/advanced/mpi" data-v-acbfed09><!--[--><span data-v-acbfed09>Multi-threading and MPI support</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/advanced/gpu" data-v-acbfed09><!--[--><span data-v-acbfed09>GPU support</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/advanced/compiled" data-v-acbfed09><!--[--><span data-v-acbfed09>Standalone reservoir simulator</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>References</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/basics/package" data-v-acbfed09><!--[--><span data-v-acbfed09>Package docstring</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/extras/paper_list" data-v-acbfed09><!--[--><span data-v-acbfed09>Publications making use of JutulDarcy.jl</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/ref/jutul" data-v-acbfed09><!--[--><span data-v-acbfed09>Jutul functions</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/extras/refs" data-v-acbfed09><!--[--><span data-v-acbfed09>Bibliography</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Examples</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/overview/example_overview" data-v-acbfed09><!--[--><span data-v-acbfed09>Example overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Introduction</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/afi_input_file" data-v-acbfed09><!--[--><span data-v-acbfed09>Set up a .AFI file for simulation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/data_input_file" data-v-acbfed09><!--[--><span data-v-acbfed09>Simulating Eclipse/DATA input files</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/intro_sensitivities" data-v-acbfed09><!--[--><span data-v-acbfed09>Intro to sensitivities in JutulDarcy</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/spe10" data-v-acbfed09><!--[--><span data-v-acbfed09>SPE10, model 2</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/two_phase_buckley_leverett" data-v-acbfed09><!--[--><span data-v-acbfed09>Buckley-Leverett two-phase problem</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/two_phase_gravity_segregation" data-v-acbfed09><!--[--><span data-v-acbfed09>Gravity segregation example</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/two_phase_unstable_gravity" data-v-acbfed09><!--[--><span data-v-acbfed09>Gravity circulation with CPR preconditioner</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/introduction/wells_intro" data-v-acbfed09><!--[--><span data-v-acbfed09>Introduction to wells</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Workflow</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/adding_new_wells" data-v-acbfed09><!--[--><span data-v-acbfed09>Adding new wells to an existing model</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/co2_sloped" data-v-acbfed09><!--[--><span data-v-acbfed09>CO2 injection in saline aquifer with storage inventory</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/equilibrium_state" data-v-acbfed09><!--[--><span data-v-acbfed09>Hydrostatic equilibriation of models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/five_spot_ensemble" data-v-acbfed09><!--[--><span data-v-acbfed09>Quarter-five-spot example</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link active" href="/JutulDarcy.jl/stable/examples/workflow/fully_differentiable_geothermal" data-v-acbfed09><!--[--><span data-v-acbfed09>A fully differentiable geothermal doublet: History matching and control optimization</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/hybrid_simulation_relperm" data-v-acbfed09><!--[--><span data-v-acbfed09>Hybrid simulation with neural network for relative permeability</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/model_coarsening" data-v-acbfed09><!--[--><span data-v-acbfed09>Model coarsening</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/rate_optimization" data-v-acbfed09><!--[--><span data-v-acbfed09>Gradient-based optimization of net present value (NPV)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/workflow/tracers_two_wells" data-v-acbfed09><!--[--><span data-v-acbfed09>Adding tracers to a flow simulation</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Data assimilation</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/data_assimilation/advanced_history_match" data-v-acbfed09><!--[--><span data-v-acbfed09>Advanced history matching: Regions, blending and parametric models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/data_assimilation/cgnet_egg" data-v-acbfed09><!--[--><span data-v-acbfed09>History matching a coarse model - CGNet</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/data_assimilation/optimize_simple_bl" data-v-acbfed09><!--[--><span data-v-acbfed09>Gradient-based matching of parameters against observations</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/data_assimilation/spe1_gradients" data-v-acbfed09><!--[--><span data-v-acbfed09>Adjoint gradients for the SPE1 model</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Geothermal</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/geothermal/geothermal_doublet" data-v-acbfed09><!--[--><span data-v-acbfed09>Geothermal doublet</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/geothermal/htates_intro" data-v-acbfed09><!--[--><span data-v-acbfed09>High-temperature Aquifer Thermal Energy Storage (HT-ATES)</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Compositional</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/compositional/clapeyron" data-v-acbfed09><!--[--><span data-v-acbfed09>Compositional simulation with Clapeyron.jl equations of state</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/compositional/compositional_2d_vertical" data-v-acbfed09><!--[--><span data-v-acbfed09>Intro to compositional flow</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/compositional/compositional_5components" data-v-acbfed09><!--[--><span data-v-acbfed09>A more complex compositional model</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Discretization</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/discretization/consistent_avgmpfa" data-v-acbfed09><!--[--><span data-v-acbfed09>Consistent discretizations: Average MPFA and nonlinear TPFA</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/discretization/mpfa_weno_discretizations" data-v-acbfed09><!--[--><span data-v-acbfed09>Consistent and high-resolution: WENO, NTPFA and AvgMPFA</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Properties</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/properties/co2_props" data-v-acbfed09><!--[--><span data-v-acbfed09>CO2-brine correlations with salinity</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/properties/relperms" data-v-acbfed09><!--[--><span data-v-acbfed09>Relative Permeabilities in JutulDarcy</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Validation</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/man/validation" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Models</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_compositional" data-v-acbfed09><!--[--><span data-v-acbfed09>Validation of equation-of-state compositional flow</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_egg" data-v-acbfed09><!--[--><span data-v-acbfed09>The Egg model: Two-phase oil-water model</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_mrst" data-v-acbfed09><!--[--><span data-v-acbfed09>Comparison between JutulDarcy.jl and MRST</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_norne_nohyst" data-v-acbfed09><!--[--><span data-v-acbfed09>Norne: Real field black-oil model</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_olympus_1" data-v-acbfed09><!--[--><span data-v-acbfed09>The OLYMPUS benchmark model: Two-phase corner-point reservoir</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_polymer" data-v-acbfed09><!--[--><span data-v-acbfed09>Polymer injection in a 2D black-oil reservoir model</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_spe1" data-v-acbfed09><!--[--><span data-v-acbfed09>SPE1: Small black-oil gas injection</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_spe9" data-v-acbfed09><!--[--><span data-v-acbfed09>SPE9: Black-oil depletion with dissolved gas</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/JutulDarcy.jl/stable/examples/validation/validation_thermal" data-v-acbfed09><!--[--><span data-v-acbfed09>Aquifer thermal energy storage (ATES) validation</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/JutulDarcy.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/JutulDarcy.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Manual</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Introduction</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>JutulDarcy.jl</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/intro" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Getting started</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/first_ex" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Your first JutulDarcy.jl simulation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/extras/faq" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>FAQ</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Fundamentals</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/highlevel" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>High-level API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/input_files" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Input formats</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/systems" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Supported physical systems</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/solution" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Solving the equations</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Detailed API</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/forces" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Driving forces</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/wells" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Wells and controls</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/primary" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Primary variables</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/secondary" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Secondary variables (properties)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/parameters" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Parameters</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/plotting" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Plotting and visualization</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/utilities" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Parallelism and compilation</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/advanced/mpi" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Multi-threading and MPI support</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/advanced/gpu" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>GPU support</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/advanced/compiled" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Standalone reservoir simulator</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>References</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/basics/package" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Package docstring</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/extras/paper_list" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Publications making use of JutulDarcy.jl</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/ref/jutul" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Jutul functions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/extras/refs" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/overview/example_overview" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Example overview</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Introduction</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/afi_input_file" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Set up a .AFI file for simulation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/data_input_file" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Simulating Eclipse/DATA input files</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/intro_sensitivities" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Intro to sensitivities in JutulDarcy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/spe10" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SPE10, model 2</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/two_phase_buckley_leverett" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Buckley-Leverett two-phase problem</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/two_phase_gravity_segregation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Gravity segregation example</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/two_phase_unstable_gravity" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Gravity circulation with CPR preconditioner</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/introduction/wells_intro" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Introduction to wells</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible has-active" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Workflow</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/adding_new_wells" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Adding new wells to an existing model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/co2_sloped" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>CO2 injection in saline aquifer with storage inventory</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/equilibrium_state" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Hydrostatic equilibriation of models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/five_spot_ensemble" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Quarter-five-spot example</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/fully_differentiable_geothermal" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>A fully differentiable geothermal doublet: History matching and control optimization</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/hybrid_simulation_relperm" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Hybrid simulation with neural network for relative permeability</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/model_coarsening" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Model coarsening</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/rate_optimization" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Gradient-based optimization of net present value (NPV)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/workflow/tracers_two_wells" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Adding tracers to a flow simulation</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Data assimilation</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/data_assimilation/advanced_history_match" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Advanced history matching: Regions, blending and parametric models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/data_assimilation/cgnet_egg" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>History matching a coarse model - CGNet</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/data_assimilation/optimize_simple_bl" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Gradient-based matching of parameters against observations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/data_assimilation/spe1_gradients" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Adjoint gradients for the SPE1 model</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Geothermal</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/geothermal/geothermal_doublet" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Geothermal doublet</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/geothermal/htates_intro" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>High-temperature Aquifer Thermal Energy Storage (HT-ATES)</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Compositional</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/compositional/clapeyron" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Compositional simulation with Clapeyron.jl equations of state</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/compositional/compositional_2d_vertical" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Intro to compositional flow</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/compositional/compositional_5components" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>A more complex compositional model</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Discretization</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/discretization/consistent_avgmpfa" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Consistent discretizations: Average MPFA and nonlinear TPFA</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/discretization/mpfa_weno_discretizations" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Consistent and high-resolution: WENO, NTPFA and AvgMPFA</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Properties</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/properties/co2_props" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>CO2-brine correlations with salinity</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/properties/relperms" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Relative Permeabilities in JutulDarcy</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Validation</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/man/validation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Models</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_compositional" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Validation of equation-of-state compositional flow</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_egg" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>The Egg model: Two-phase oil-water model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_mrst" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Comparison between JutulDarcy.jl and MRST</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_norne_nohyst" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Norne: Real field black-oil model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_olympus_1" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>The OLYMPUS benchmark model: Two-phase corner-point reservoir</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_polymer" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Polymer injection in a 2D black-oil reservoir model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_spe1" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SPE1: Small black-oil gas injection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_spe9" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SPE9: Black-oil depletion with dissolved gas</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JutulDarcy.jl/stable/examples/validation/validation_thermal" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Aquifer thermal energy storage (ATES) validation</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _JutulDarcy_jl_stable_examples_workflow_fully_differentiable_geothermal" data-v-83890dd9><div><h1 id="A-fully-differentiable-geothermal-doublet:-History-matching-and-control-optimization" tabindex="-1">A fully differentiable geothermal doublet: History matching and control optimization <a class="header-anchor" href="#A-fully-differentiable-geothermal-doublet:-History-matching-and-control-optimization" aria-label="Permalink to &quot;A fully differentiable geothermal doublet: History matching and control optimization {#A-fully-differentiable-geothermal-doublet:-History-matching-and-control-optimization}&quot;"></a></h1><!--[--><span class="badge" style="background-color:rgb(130, 198, 226);" data-v-d5b0cf35><a href="../../examples/overview/example_overview#Geothermal" data-v-d5b0cf35>Geothermal</a></span>  <!--]--><!--[--><span class="badge" style="background-color:rgb(238, 133, 74);" data-v-d5b0cf35><a href="../../examples/overview/example_overview#StartToFinish" data-v-d5b0cf35>StartToFinish</a></span>  <!--]--><!--[--><span class="badge" style="background-color:rgb(106, 204, 100);" data-v-d5b0cf35><a href="../../examples/overview/example_overview#Advanced" data-v-d5b0cf35>Advanced</a></span>  <!--]--><!--[--><span class="badge" style="background-color:rgb(121, 121, 121);" data-v-d5b0cf35><a href="../../examples/overview/example_overview#HistoryMatching" data-v-d5b0cf35>HistoryMatching</a></span>  <!--]--><!--[--><span class="badge" style="background-color:rgb(214, 95, 95);" data-v-d5b0cf35><a href="../../examples/overview/example_overview#Optimization" data-v-d5b0cf35>Optimization</a></span>  <!--]--><!--[--><span class="badge" style="background-color:rgb(220, 126, 192);" data-v-d5b0cf35><a href="../../examples/overview/example_overview#Differentiability" data-v-d5b0cf35>Differentiability</a></span>  <!--]--><p>We are going to set up a conceptual geothermal doublet model in 2D and perform gradient based history matching. This example serves two main purposes:</p><ol><li><p>It demonstrates the conceptual workflow for setting up a geothermal model from scratch with a fairly straightforward mesh setup.</p></li><li><p>It shows how to set up a gradient based history matching workflow with the generic optimization interface that allows for optimizing any input parameter used in the setup of a model.</p></li></ol><h2 id="Load-packages-and-define-units" tabindex="-1">Load packages and define units <a class="header-anchor" href="#Load-packages-and-define-units" aria-label="Permalink to &quot;Load packages and define units {#Load-packages-and-define-units}&quot;"></a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul, JutulDarcy, HYPRE, GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter, kilogram, bar, year, liter, second, darcy, day </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_units</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:meter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:kilogram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:liter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:second</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:darcy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">(1.0, 1.0, 100000.0, 3.1556952e7, 0.001, 1.0, 9.86923266716013e-13, 86400.0)</span></span></code></pre></div><h2 id="Set-up-the-reservoir-mesh" tabindex="-1">Set up the reservoir mesh <a class="header-anchor" href="#Set-up-the-reservoir-mesh" aria-label="Permalink to &quot;Set up the reservoir mesh {#Set-up-the-reservoir-mesh}&quot;"></a></h2><p>The model is a typical geothermal case where there is a layer of high permeability in the middle, confined between two low-permeable layers. For a geothermal model, the low permeable layers are important, as they store significant amounts of heat that can be conducted to the high permeable layer during production.</p><p>We set up the mesh so that the high permeable layer where most of the advective transport occurs has a higher lateral resolution than the low permeable layers. The model is also essentally 2D as there is only one cell thickness in the y direction - a choice that is made to make the example fast to run, especially during the later optimization stages where many simulations must be run to achieve convergence.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ntop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nmiddle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nbottom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ntop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nmiddle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nbottom</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">20</span></span></code></pre></div><h3 id="Set-up-layer-thicknesses-and-vertical-cell-thicknesses" tabindex="-1">Set up layer thicknesses and vertical cell thicknesses <a class="header-anchor" href="#Set-up-layer-thicknesses-and-vertical-cell-thicknesses" aria-label="Permalink to &quot;Set up layer thicknesses and vertical cell thicknesses {#Set-up-layer-thicknesses-and-vertical-cell-thicknesses}&quot;"></a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">top_layer_thickness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 300.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">middle_layer_thickness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bottom_layer_thickness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 300.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Float64[]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ntop</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    push!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dz, top_layer_thickness</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ntop)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nmiddle</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    push!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dz, middle_layer_thickness</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nmiddle)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ntop</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    push!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dz, bottom_layer_thickness</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nbottom)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cmesh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CartesianMesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((nx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nz), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dz))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rmesh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> UnstructuredMesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cmesh, z_is_depth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">UnstructuredMesh with 1000 cells, 1930 faces and 2140 boundary faces</span></span></code></pre></div><h3 id="Define-regions-based-on-our-selected-depths" tabindex="-1">Define regions based on our selected depths <a class="header-anchor" href="#Define-regions-based-on-our-selected-depths" aria-label="Permalink to &quot;Define regions based on our selected depths {#Define-regions-based-on-our-selected-depths}&quot;"></a></h3><p>We tag each cell with a region number based on its depth. The top layer is region 1, the middle layer is region 2, and the bottom layer is region 3.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">geo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tpfv_geometry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rmesh)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">depths </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_centroids[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">regions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Int[]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, d_i) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(depths)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d_i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> top_layer_thickness</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d_i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> top_layer_thickness </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> middle_layer_thickness</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    push!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(regions, r)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h3 id="Plot-the-mesh-and-regions" tabindex="-1">Plot the mesh and regions <a class="header-anchor" href="#Plot-the-mesh-and-regions" aria-label="Permalink to &quot;Plot the mesh and regions {#Plot-the-mesh-and-regions}&quot;"></a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig, ax, plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rmesh, regions,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    alpha </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    outer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    transparency </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Categorical</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:heat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">elevation[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">azimuth[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_mesh_edges!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, rmesh)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/JutulDarcy.jl/stable/assets/wbyjlff.DeOAGTOq.jpeg" alt=""></p><h2 id="Define-functions-for-setting-up-the-simulation" tabindex="-1">Define functions for setting up the simulation <a class="header-anchor" href="#Define-functions-for-setting-up-the-simulation" aria-label="Permalink to &quot;Define functions for setting up the simulation {#Define-functions-for-setting-up-the-simulation}&quot;"></a></h2><p>We will define a function that takes in a Dict with different values and sets up the simulation. The key idea is that we can then optimize the values in the Dict to perform optimization. As we can define any such Dict to set up the model, this interface is very flexible and can be used for both control optimization and history matching with respect to almost any parameter of the model. The disadvantage is that the setup function will be called many times, which can be a substantial cost compared to the more structured optimization interface that only allows for optimization of the numerical parameters (e.g. for the CGNet example).</p><h3 id="Define-the-time-schedule" tabindex="-1">Define the time schedule <a class="header-anchor" href="#Define-the-time-schedule" aria-label="Permalink to &quot;Define the time schedule {#Define-the-time-schedule}&quot;"></a></h3><p>We set up a time schedule for the simulation. The total simulation time is 30 years, and we report the results every 120 days. We also define ten different intervals in this 30 year period, which are the period where we will allow the rates and temperatures to vary during the last part of the optimization tutorial.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">total_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">year</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">report_step_length </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 120.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(report_step_length, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ceil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(total_time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">report_step_length)))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_intervals </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">interval_interval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_intervals</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">interval_for_step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ceil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">interval_interval)), num_intervals), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cumsum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dt))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">92-element Vector{Int64}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  2</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 10</span></span></code></pre></div><h3 id="Define-the-wells" tabindex="-1">Define the wells <a class="header-anchor" href="#Define-the-wells" aria-label="Permalink to &quot;Define the wells {#Define-the-wells}&quot;"></a></h3><p>We set up two wells, one injector and one producer. The injector is located at the left side of the model, and the producer is located at the right side. We use multisegment wells.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">base_rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">liter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">second</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">base_temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rmesh)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inj_well </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_vertical_well</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    heel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ntop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    toe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ntop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nmiddle,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    simple_well </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prod_well </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_vertical_well</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, nx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    heel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ntop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    toe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ntop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nmiddle,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    simple_well </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model_base </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    domain, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:geothermal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [inj_well, prod_well],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="Set-up-a-helper-to-define-the-forces-for-a-given-rate-and-temperature" tabindex="-1">Set up a helper to define the forces for a given rate and temperature <a class="header-anchor" href="#Set-up-a-helper-to-define-the-forces-for-a-given-rate-and-temperature" aria-label="Permalink to &quot;Set up a helper to define the forces for a given rate and temperature {#Set-up-a-helper-to-define-the-forces-for-a-given-rate-and-temperature}&quot;"></a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup_doublet_forces</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, inj_temp, inj_rate)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    T_Kelvin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_to_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(inj_temp, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rate_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TotalRateTarget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(inj_rate)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ctrl_inj  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> InjectorControl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rate_target, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, temperature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T_Kelvin)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bhp_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BottomHolePressureTarget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ctrl_prod </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ProducerControl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bhp_target)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    control </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctrl_inj, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctrl_prod)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_forces</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, control </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> control)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">setup_doublet_forces (generic function with 1 method)</span></span></code></pre></div><h3 id="Define-the-main-setup-function" tabindex="-1">Define the main setup function <a class="header-anchor" href="#Define-the-main-setup-function" aria-label="Permalink to &quot;Define the main setup function {#Define-the-main-setup-function}&quot;"></a></h3><p>This function sets up the model based on the parameters provided in the Dict. It takes in two arguments: The required parameters in a Dict and an optional step_info argument that can be used to set up the model for a specific time step. The function returns a JutulCase object that can be used to simulate the reservoir. Here, we ignore the <code>step_info</code> argument and set up the entire schedule every time. Jutul will then automatically use the correct force based on the time step in the simulation.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup_doublet_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prm, step_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> missing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deepcopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model_base)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rdomain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rdomain[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:permeability</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prm[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;layer_perm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][regions]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rdomain[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:porosity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prm[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;layer_porosities&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][regions]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rdomain[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rock_heat_capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prm[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;layer_heat_capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][regions]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    T0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_to_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    thermal_gradient </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    eql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EquilibriumRegion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, temperature_vs_depth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">thermal_gradient)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    state0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, eql)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    forces_per_interval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((T, rate) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_doublet_forces</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, T, rate),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        prm[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_temperature_C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], prm[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_rate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    forces </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> forces_per_interval[interval_for_step]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, dt, forces, state0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state0)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">setup_doublet_case (generic function with 2 methods)</span></span></code></pre></div><h2 id="Perform-a-history-match" tabindex="-1">Perform a history match <a class="header-anchor" href="#Perform-a-history-match" aria-label="Permalink to &quot;Perform a history match {#Perform-a-history-match}&quot;"></a></h2><p>We first set up a truth case that we will use to generate the data for the history match. We define high perm and porosity in the middle layer, and low perm and porosity in the top and bottom layers before simulating the model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prm_truth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;injection_rate&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_rate, num_intervals),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;injection_temperature_C&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_temp, num_intervals),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;layer_porosities&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;layer_perm&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">darcy,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;layer_heat_capacity&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">450.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Watt / m K</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">case_truth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_doublet_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prm_truth)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws, states </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case_truth)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 92 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (2 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Producer</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Injector</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 92 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 92</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 92 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Feb. 04 2026 10:48 after 4 seconds, 351 milliseconds, 966 microseconds.</span></span></code></pre></div><h3 id="Define-a-mismatch-objective-function" tabindex="-1">Define a mismatch objective function <a class="header-anchor" href="#Define-a-mismatch-objective-function" aria-label="Permalink to &quot;Define a mismatch objective function {#Define-a-mismatch-objective-function}&quot;"></a></h3><p>The mismatch objective function is defined as the sum of squares difference between the simulated values and the reference values observed in the wells. Note that we only make use of the well data:</p><ul><li><p>The temperature at the producer well</p></li><li><p>The mass rate at the producer well (since it is controlled on BHP)</p></li><li><p>The BHP at the injector well (since it is controlled on rate)</p></li></ul><p>We use the <code>get_1d_interpolator</code> function to create interpolators for the reference values, since we cannot assume that the simulator will use exactly the same time-steps as the reference values.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prod_rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:wrat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prod_temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inj_bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prod_temp_by_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_1d_interpolator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time, prod_temp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prod_rate_by_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_1d_interpolator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time, prod_rate)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inj_pressure_by_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_1d_interpolator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time, inj_bhp)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> compute_well_qoi</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mismatch_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, dt, step_info, forces)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    current_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> step_info[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Current values</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    T_at_prod </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compute_well_qoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, forces, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compute_well_qoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, forces, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:wrat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compute_well_qoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, forces, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Reference values</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    T_at_prod_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> prod_temp_by_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(current_time)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rate_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> prod_rate_by_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(current_time)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bhp_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> inj_pressure_by_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(current_time)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Define mismatch by scaling each term</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    T_mismatch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (T_at_prod_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T_at_prod)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rate_mismatch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (rate_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rate)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bhp_mismatch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bhp_ref)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sqrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T_mismatch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rate_mismatch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bhp_mismatch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_time</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">mismatch_objective (generic function with 1 method)</span></span></code></pre></div><h3 id="Pick-an-initial-guess" tabindex="-1">Pick an initial guess <a class="header-anchor" href="#Pick-an-initial-guess" aria-label="Permalink to &quot;Pick an initial guess {#Pick-an-initial-guess}&quot;"></a></h3><p>We set up an initial guess for the parameters that we will optimize. We assume the injection rate and temperature to be known and we set the porosities and permeabilities to uniform values. The heat capacity is given a bit of layering, but still with completely wrong values.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prm_guess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;injection_rate&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_rate, num_intervals),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;injection_temperature_C&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(base_temp, num_intervals),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;layer_porosities&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;layer_perm&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">darcy,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;layer_heat_capacity&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">case_guess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_doublet_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prm_guess)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws_guess, states_guess </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case_guess)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 92 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (2 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Producer</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Injector</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 92 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 92</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 92 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Feb. 04 2026 10:48 after 754 milliseconds, 657 microseconds, 665 nanoseconds.</span></span></code></pre></div><h3 id="Set-up-the-optimization" tabindex="-1">Set up the optimization <a class="header-anchor" href="#Set-up-the-optimization" aria-label="Permalink to &quot;Set up the optimization {#Set-up-the-optimization}&quot;"></a></h3><p>We define a dictionary optimization problem that will optimize the parameters in the <code>prm_guess</code> dictionary. We start by setting up the object itself, which takes in the initial guess <code>Dict</code> and the corresponding setup function.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup_reservoir_dict_optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prm_guess, setup_doublet_case)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">DictParameters with 5 parameters (0 active), and 0 multipliers:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No active optimization parameters.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Inactive optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                    Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value    </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     layer_heat_capacity  400.0  0.0           3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          injection_rate  0.015  3.47e-18     10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> injection_temperature_C  15.0  0.0           10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">              layer_perm  1.97e-13  0.0        3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">        layer_porosities  0.2  2.78e-17        3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No multipliers set.</span></span></code></pre></div><h3 id="Define-active-parameters-and-their-limits" tabindex="-1">Define active parameters and their limits <a class="header-anchor" href="#Define-active-parameters-and-their-limits" aria-label="Permalink to &quot;Define active parameters and their limits {#Define-active-parameters-and-their-limits}&quot;"></a></h3><p>Note that while the parameters get listed, they are all marked as inactive. We need to explicitly make them free/active and specify a range for each parameter before we can optimize them. We use wide absolute limits for each entry.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">free_optimization_parameter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;layer_perm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">darcy, abs_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">darcy)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">free_optimization_parameter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;layer_heat_capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 400.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">free_optimization_parameter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;layer_porosities&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.35</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">DictParameters with 5 parameters (3 active), and 0 multipliers:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Active optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">      Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">      Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          layer_perm  1.97e-13  0.0      3  9.87e-15  1.48e-12 </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> layer_heat_capacity  400.0  0.0         3     400.0    1000.0 </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    layer_porosities  0.2  2.78e-17      3      0.05      0.35 </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Inactive optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                    Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value    </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          injection_rate  0.015  3.47e-18     10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> injection_temperature_C  15.0  0.0           10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No multipliers set.</span></span></code></pre></div><h3 id="Call-the-optimizer" tabindex="-1">Call the optimizer <a class="header-anchor" href="#Call-the-optimizer" aria-label="Permalink to &quot;Call the optimizer {#Call-the-optimizer}&quot;"></a></h3><p>Now that we have freed a few parameters, we can call the optimizer with the objective function. The defaults for the optimizer are fairly reasonable, so we do not tweak the convergence criteria or the maximum number of iterations. Note that by default the optimizer uses LBFGS, but it is also possible to pass other optimizers as a function callable. The default for the optimizer is to minimize the objective function, which is the case for a history match. By passing for example <code>lbfgs_num = 1, max_it = 50</code> it is possible to obtain a better match, but this is not necessary for the purpose of this example.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prm_opt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">optimize_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt, mismatch_objective, max_it </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, gradient_scaling </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, optimizer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :lbfgsb_qp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">setup_reservoir_state: Received primary variable Saturations, but this is not known to reservoir model.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Starting calibration of 9 parameters.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Setting up adjoint storage.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Finished setup in 62.738916404 seconds.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 35.801333166 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #1: 1.81499e+01, gradient 2-norm: 8.40785e+12</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  0 | v: 1.815e+01 | ls-its:  0 | pg: 8.03e+12 | :       NaN | qp-its:  0 +  0 | n-active:   0</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.838381364 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #2: 5.85646e+01 (f/f0=3.227e+00), gradient 2-norm: 5.74716e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.859780035 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #3: 1.42655e+01 (f/f0=7.860e-01), gradient 2-norm: 3.55326e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.751049935 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #4: 5.85646e+01 (f/f0=3.227e+00), gradient 2-norm: 5.74716e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.715054913 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #5: 1.56059e+01 (f/f0=8.598e-01), gradient 2-norm: 2.68161e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.767326328 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #6: 1.36118e+01 (f/f0=7.500e-01), gradient 2-norm: 5.83781e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 1.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  1 | v: 1.361e+01 | ls-its:  5 | pg: 5.18e+13 | :  1.35e+00 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.702458325 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #7: 1.84651e+01 (f/f0=1.017e+00), gradient 2-norm: 2.51501e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.813046128 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #8: 2.01529e+01 (f/f0=1.110e+00), gradient 2-norm: 3.14677e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.713115111 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #9: 1.56340e+01 (f/f0=8.614e-01), gradient 2-norm: 5.51693e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.850161441 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #10: 1.34540e+01 (f/f0=7.413e-01), gradient 2-norm: 4.57268e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 2.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  2 | v: 1.345e+01 | ls-its:  4 | pg: 4.06e+13 | :  1.40e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.794185846 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #11: 6.27248e+01 (f/f0=3.456e+00), gradient 2-norm: 6.13877e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.748796101 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #12: 1.26267e+01 (f/f0=6.957e-01), gradient 2-norm: 3.21132e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.828345336 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #13: 1.13807e+01 (f/f0=6.270e-01), gradient 2-norm: 1.14628e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 3.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  3 | v: 1.138e+01 | ls-its:  3 | pg: 1.08e+14 | :  7.99e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.790303431 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #14: 1.76893e+01 (f/f0=9.746e-01), gradient 2-norm: 2.34045e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.838926784 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #15: 1.86313e+01 (f/f0=1.027e+00), gradient 2-norm: 4.05026e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.784853796 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #16: 1.38003e+01 (f/f0=7.604e-01), gradient 2-norm: 6.70483e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.84791697 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #17: 1.07225e+01 (f/f0=5.908e-01), gradient 2-norm: 7.08001e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 4.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  4 | v: 1.072e+01 | ls-its:  4 | pg: 6.38e+13 | :  1.88e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.814694215 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #18: 6.33532e+01 (f/f0=3.491e+00), gradient 2-norm: 6.17373e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.718788325 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #19: 1.08161e+01 (f/f0=5.959e-01), gradient 2-norm: 3.33160e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.797014371 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #20: 8.76220e+00 (f/f0=4.828e-01), gradient 2-norm: 9.97974e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 5.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  5 | v: 8.762e+00 | ls-its:  3 | pg: 8.30e+13 | :  7.36e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.707415791 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #21: 1.67969e+01 (f/f0=9.255e-01), gradient 2-norm: 1.92142e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.775143531 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #22: 1.70529e+01 (f/f0=9.396e-01), gradient 2-norm: 4.78261e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.705575299 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #23: 1.15286e+01 (f/f0=6.352e-01), gradient 2-norm: 8.12134e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.771097861 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #24: 8.41309e+00 (f/f0=4.635e-01), gradient 2-norm: 8.49765e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 6.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  6 | v: 8.413e+00 | ls-its:  4 | pg: 7.98e+13 | :  1.75e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.731212218 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #25: 6.40248e+01 (f/f0=3.528e+00), gradient 2-norm: 6.20940e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.706704627 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #26: 1.05522e+01 (f/f0=5.814e-01), gradient 2-norm: 3.86686e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717478167 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #27: 7.18648e+00 (f/f0=3.960e-01), gradient 2-norm: 9.47106e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 7.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  7 | v: 7.186e+00 | ls-its:  3 | pg: 6.97e+13 | :  6.66e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.705927403 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #28: 1.63057e+01 (f/f0=8.984e-01), gradient 2-norm: 1.44108e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.875516508 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #29: 1.58417e+01 (f/f0=8.728e-01), gradient 2-norm: 5.18004e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.821720418 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #30: 1.00076e+01 (f/f0=5.514e-01), gradient 2-norm: 8.97529e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.863132889 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #31: 6.97730e+00 (f/f0=3.844e-01), gradient 2-norm: 9.21663e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 8.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  8 | v: 6.977e+00 | ls-its:  4 | pg: 8.81e+13 | :  1.57e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.796123339 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #32: 6.44678e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23182e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.780711518 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #33: 1.05931e+01 (f/f0=5.836e-01), gradient 2-norm: 4.19768e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.701170005 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #34: 6.17543e+00 (f/f0=3.402e-01), gradient 2-norm: 8.78918e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 9.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It:  9 | v: 6.175e+00 | ls-its:  3 | pg: 7.01e+13 | :  6.49e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.699461627 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #35: 1.62273e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31302e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.769949779 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #36: 1.50089e+01 (f/f0=8.269e-01), gradient 2-norm: 5.37728e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.722554423 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #37: 8.65614e+00 (f/f0=4.769e-01), gradient 2-norm: 9.69542e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.789647422 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #38: 6.05543e+00 (f/f0=3.336e-01), gradient 2-norm: 9.31091e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 10.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 10 | v: 6.055e+00 | ls-its:  4 | pg: 9.06e+13 | :  1.63e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.733460617 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #39: 6.44696e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23201e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.78545083 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #40: 1.08660e+01 (f/f0=5.987e-01), gradient 2-norm: 4.44329e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717675146 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #41: 5.60421e+00 (f/f0=3.088e-01), gradient 2-norm: 8.26109e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 11.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 11 | v: 5.604e+00 | ls-its:  3 | pg: 7.55e+13 | :  6.45e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.707123547 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #42: 1.62273e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31272e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.711594841 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #43: 1.43325e+01 (f/f0=7.897e-01), gradient 2-norm: 5.62771e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.712247352 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #44: 7.16109e+00 (f/f0=3.946e-01), gradient 2-norm: 1.03940e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.736264294 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #45: 5.52793e+00 (f/f0=3.046e-01), gradient 2-norm: 8.97159e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 12.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 12 | v: 5.528e+00 | ls-its:  4 | pg: 8.90e+13 | :  2.74e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.720898176 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #46: 6.44703e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23208e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.897127201 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #47: 1.12814e+01 (f/f0=6.216e-01), gradient 2-norm: 4.69052e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.719160996 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #48: 5.32345e+00 (f/f0=2.933e-01), gradient 2-norm: 8.16699e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 13.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 13 | v: 5.323e+00 | ls-its:  3 | pg: 7.73e+13 | :  6.40e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.784944827 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #49: 1.62273e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31258e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.711950373 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #50: 1.38945e+01 (f/f0=7.655e-01), gradient 2-norm: 5.79281e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.724801047 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #51: 6.42360e+00 (f/f0=3.539e-01), gradient 2-norm: 1.05416e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.719139008 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #52: 5.26907e+00 (f/f0=2.903e-01), gradient 2-norm: 8.76928e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 14.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 14 | v: 5.269e+00 | ls-its:  4 | pg: 8.74e+13 | :  3.32e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.746152952 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #53: 6.44707e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23213e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.83450554 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #54: 1.14159e+01 (f/f0=6.290e-01), gradient 2-norm: 4.77424e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717382664 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #55: 5.13834e+00 (f/f0=2.831e-01), gradient 2-norm: 8.07871e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 15.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 15 | v: 5.138e+00 | ls-its:  3 | pg: 7.77e+13 | :  6.47e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.790722779 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #56: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31250e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.70534684 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #57: 1.35549e+01 (f/f0=7.468e-01), gradient 2-norm: 5.91906e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.784069495 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #58: 5.96626e+00 (f/f0=3.287e-01), gradient 2-norm: 1.05188e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.718752707 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #59: 5.09648e+00 (f/f0=2.808e-01), gradient 2-norm: 8.64863e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 16.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 16 | v: 5.096e+00 | ls-its:  4 | pg: 8.63e+13 | :  3.68e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.726805517 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #60: 6.44711e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23216e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.733212052 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #61: 1.14831e+01 (f/f0=6.327e-01), gradient 2-norm: 4.81709e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.711006339 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #62: 5.00206e+00 (f/f0=2.756e-01), gradient 2-norm: 8.00322e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 17.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 17 | v: 5.002e+00 | ls-its:  3 | pg: 7.76e+13 | :  6.48e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.725141334 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #63: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31244e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.699925051 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #64: 1.32664e+01 (f/f0=7.309e-01), gradient 2-norm: 6.02746e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.801379983 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #65: 5.64382e+00 (f/f0=3.110e-01), gradient 2-norm: 1.04153e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.713019798 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #66: 4.96850e+00 (f/f0=2.737e-01), gradient 2-norm: 8.52709e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 18.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 18 | v: 4.968e+00 | ls-its:  4 | pg: 8.52e+13 | :  3.93e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.797485174 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #67: 6.44714e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23219e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.721518054 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #68: 1.15256e+01 (f/f0=6.350e-01), gradient 2-norm: 4.84408e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.71394617 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #69: 4.89578e+00 (f/f0=2.697e-01), gradient 2-norm: 7.93446e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 19.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 19 | v: 4.896e+00 | ls-its:  3 | pg: 7.74e+13 | :  6.52e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.728147974 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #70: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31239e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.700819609 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #71: 1.30132e+01 (f/f0=7.170e-01), gradient 2-norm: 6.12277e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.736514083 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #72: 5.40522e+00 (f/f0=2.978e-01), gradient 2-norm: 1.02758e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.71081789 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #73: 4.86813e+00 (f/f0=2.682e-01), gradient 2-norm: 8.42347e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 20.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 20 | v: 4.868e+00 | ls-its:  4 | pg: 8.42e+13 | :  4.10e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.810852364 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #74: 6.44717e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23221e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.719632985 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #75: 1.15544e+01 (f/f0=6.366e-01), gradient 2-norm: 4.86224e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.798661273 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #76: 4.80966e+00 (f/f0=2.650e-01), gradient 2-norm: 7.86708e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 21.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 21 | v: 4.810e+00 | ls-its:  3 | pg: 7.70e+13 | :  6.55e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.70490413 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #77: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31235e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.768195817 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #78: 1.27847e+01 (f/f0=7.044e-01), gradient 2-norm: 6.20814e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.718076134 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #79: 5.22083e+00 (f/f0=2.877e-01), gradient 2-norm: 1.01258e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717949305 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #80: 4.78637e+00 (f/f0=2.637e-01), gradient 2-norm: 8.32492e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 22.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 22 | v: 4.786e+00 | ls-its:  4 | pg: 8.32e+13 | :  4.24e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.744967905 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #81: 6.44719e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23224e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.721180487 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #82: 1.15758e+01 (f/f0=6.378e-01), gradient 2-norm: 4.87560e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.810524861 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #83: 4.73802e+00 (f/f0=2.610e-01), gradient 2-norm: 7.80118e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 23.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 23 | v: 4.738e+00 | ls-its:  3 | pg: 7.66e+13 | :  6.58e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.699682078 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #84: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31231e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.785083298 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #85: 1.25751e+01 (f/f0=6.928e-01), gradient 2-norm: 6.28747e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.71405704 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #86: 5.07420e+00 (f/f0=2.796e-01), gradient 2-norm: 9.96629e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.786602318 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #87: 4.71810e+00 (f/f0=2.600e-01), gradient 2-norm: 8.23425e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 24.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 24 | v: 4.718e+00 | ls-its:  4 | pg: 8.23e+13 | :  4.34e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.726082773 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #88: 6.44721e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23226e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.718428406 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #89: 1.15922e+01 (f/f0=6.387e-01), gradient 2-norm: 4.88565e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.725799278 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #90: 4.67720e+00 (f/f0=2.577e-01), gradient 2-norm: 7.73701e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 25.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 25 | v: 4.677e+00 | ls-its:  3 | pg: 7.61e+13 | :  6.60e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.698400616 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #91: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31228e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.720394624 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #92: 1.23797e+01 (f/f0=6.821e-01), gradient 2-norm: 6.36370e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.713462924 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #93: 4.95467e+00 (f/f0=2.730e-01), gradient 2-norm: 9.80300e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.805925488 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #94: 4.65990e+00 (f/f0=2.567e-01), gradient 2-norm: 8.14944e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 26.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 26 | v: 4.660e+00 | ls-its:  4 | pg: 8.15e+13 | :  4.43e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.722519227 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #95: 6.44723e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23228e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.79596922 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #96: 1.16057e+01 (f/f0=6.394e-01), gradient 2-norm: 4.89367e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717532051 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #97: 4.62477e+00 (f/f0=2.548e-01), gradient 2-norm: 7.67684e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 27.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 27 | v: 4.625e+00 | ls-its:  3 | pg: 7.57e+13 | :  6.62e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.770321605 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #98: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31225e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.708064018 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #99: 1.21973e+01 (f/f0=6.720e-01), gradient 2-norm: 6.43374e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.710907875 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #100: 4.85621e+00 (f/f0=2.676e-01), gradient 2-norm: 9.64619e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.73128343 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #101: 4.60960e+00 (f/f0=2.540e-01), gradient 2-norm: 8.06822e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 28.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 28 | v: 4.610e+00 | ls-its:  4 | pg: 8.07e+13 | :  4.50e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.728328787 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #102: 6.44725e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23230e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.73926817 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #103: 1.16167e+01 (f/f0=6.400e-01), gradient 2-norm: 4.90009e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.713292516 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #104: 4.57900e+00 (f/f0=2.523e-01), gradient 2-norm: 7.61850e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 29.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 29 | v: 4.579e+00 | ls-its:  3 | pg: 7.52e+13 | :  6.63e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.795067833 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #105: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31223e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.698745405 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #106: 1.20246e+01 (f/f0=6.625e-01), gradient 2-norm: 6.50042e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.801934141 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #107: 4.77336e+00 (f/f0=2.630e-01), gradient 2-norm: 9.49106e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.716873967 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #108: 4.56558e+00 (f/f0=2.515e-01), gradient 2-norm: 7.99270e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 30.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 30 | v: 4.566e+00 | ls-its:  4 | pg: 7.99e+13 | :  4.55e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.801774835 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #109: 6.44726e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23232e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.743121945 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #110: 1.16262e+01 (f/f0=6.406e-01), gradient 2-norm: 4.90535e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.726108148 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #111: 4.53863e+00 (f/f0=2.501e-01), gradient 2-norm: 7.56011e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 31.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 31 | v: 4.539e+00 | ls-its:  3 | pg: 7.47e+13 | :  6.65e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.719659259 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #112: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31221e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.703424297 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #113: 1.18623e+01 (f/f0=6.536e-01), gradient 2-norm: 6.56092e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.738231675 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #114: 4.70344e+00 (f/f0=2.591e-01), gradient 2-norm: 9.34183e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717948347 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #115: 4.52666e+00 (f/f0=2.494e-01), gradient 2-norm: 7.91913e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 32.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 32 | v: 4.527e+00 | ls-its:  4 | pg: 7.92e+13 | :  4.60e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.826349093 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #116: 6.44740e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23242e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.714853508 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #117: 1.16343e+01 (f/f0=6.410e-01), gradient 2-norm: 4.90968e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.812646621 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #118: 4.50271e+00 (f/f0=2.481e-01), gradient 2-norm: 7.50541e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 33.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 33 | v: 4.503e+00 | ls-its:  3 | pg: 7.43e+13 | :  6.66e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.707907282 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #119: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31219e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.781392685 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #120: 1.17059e+01 (f/f0=6.450e-01), gradient 2-norm: 6.62420e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.715771136 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #121: 4.64288e+00 (f/f0=2.558e-01), gradient 2-norm: 9.20085e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.791764487 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #122: 4.49196e+00 (f/f0=2.475e-01), gradient 2-norm: 7.84896e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 34.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 34 | v: 4.492e+00 | ls-its:  4 | pg: 7.85e+13 | :  4.64e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.728057067 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #123: 6.44729e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23235e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.713446728 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #124: 1.16417e+01 (f/f0=6.414e-01), gradient 2-norm: 4.91353e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.729320416 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #125: 4.47053e+00 (f/f0=2.463e-01), gradient 2-norm: 7.45046e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 35.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 35 | v: 4.471e+00 | ls-its:  3 | pg: 7.38e+13 | :  6.66e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.699552682 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #126: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31218e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.724598396 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #127: 1.15592e+01 (f/f0=6.369e-01), gradient 2-norm: 6.68297e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.711542073 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #128: 4.59095e+00 (f/f0=2.529e-01), gradient 2-norm: 9.06549e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.850522071 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #129: 4.46081e+00 (f/f0=2.458e-01), gradient 2-norm: 7.78244e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 36.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 36 | v: 4.461e+00 | ls-its:  4 | pg: 7.78e+13 | :  4.67e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.726690904 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #130: 6.44730e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23236e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.814037829 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #131: 1.16480e+01 (f/f0=6.418e-01), gradient 2-norm: 4.91672e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.720246172 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #132: 4.44147e+00 (f/f0=2.447e-01), gradient 2-norm: 7.40047e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 37.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 37 | v: 4.441e+00 | ls-its:  3 | pg: 7.34e+13 | :  6.68e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.785443425 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #133: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31216e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.70621264 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #134: 1.14149e+01 (f/f0=6.289e-01), gradient 2-norm: 6.73833e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.788492103 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #135: 4.54490e+00 (f/f0=2.504e-01), gradient 2-norm: 8.93425e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.720132645 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #136: 4.43265e+00 (f/f0=2.442e-01), gradient 2-norm: 7.72119e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 38.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 38 | v: 4.433e+00 | ls-its:  4 | pg: 7.72e+13 | :  4.70e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.728881341 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #137: 6.44732e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23238e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.73142652 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #138: 1.16538e+01 (f/f0=6.421e-01), gradient 2-norm: 4.91959e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.722547343 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #139: 4.41511e+00 (f/f0=2.433e-01), gradient 2-norm: 7.35067e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 39.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 39 | v: 4.415e+00 | ls-its:  3 | pg: 7.29e+13 | :  6.68e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.721023984 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #140: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31214e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.70049796 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #141: 1.12792e+01 (f/f0=6.214e-01), gradient 2-norm: 6.79141e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.818547579 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #142: 4.50478e+00 (f/f0=2.482e-01), gradient 2-norm: 8.81339e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.714477245 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #143: 4.40706e+00 (f/f0=2.428e-01), gradient 2-norm: 7.66035e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 40.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 40 | v: 4.407e+00 | ls-its:  4 | pg: 7.66e+13 | :  4.72e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.816058907 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #144: 6.44733e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23239e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.716360278 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #145: 1.16592e+01 (f/f0=6.424e-01), gradient 2-norm: 4.92214e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.802468878 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #146: 4.39107e+00 (f/f0=2.419e-01), gradient 2-norm: 7.30034e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 41.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 41 | v: 4.391e+00 | ls-its:  3 | pg: 7.25e+13 | :  6.68e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.727367459 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #147: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31213e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.787120864 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #148: 1.11496e+01 (f/f0=6.143e-01), gradient 2-norm: 6.84080e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.72627792 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #149: 4.46927e+00 (f/f0=2.462e-01), gradient 2-norm: 8.69924e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.719862966 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #150: 4.38367e+00 (f/f0=2.415e-01), gradient 2-norm: 7.60032e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 42.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 42 | v: 4.384e+00 | ls-its:  4 | pg: 7.60e+13 | :  4.75e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.729297745 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #151: 6.44734e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23240e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717514625 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #152: 1.16640e+01 (f/f0=6.426e-01), gradient 2-norm: 4.92437e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.734314655 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #153: 4.36903e+00 (f/f0=2.407e-01), gradient 2-norm: 7.25378e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 43.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 43 | v: 4.369e+00 | ls-its:  3 | pg: 7.20e+13 | :  6.69e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.700581189 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #154: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31211e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.728087205 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #155: 1.10228e+01 (f/f0=6.073e-01), gradient 2-norm: 6.89201e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.725436829 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #156: 4.43730e+00 (f/f0=2.445e-01), gradient 2-norm: 8.58692e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.818757898 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #157: 4.36223e+00 (f/f0=2.403e-01), gradient 2-norm: 7.54447e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 44.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 44 | v: 4.362e+00 | ls-its:  4 | pg: 7.54e+13 | :  4.76e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.722755536 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #158: 6.44735e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23241e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.814111858 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #159: 1.16684e+01 (f/f0=6.429e-01), gradient 2-norm: 4.92644e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.71801934 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #160: 4.34875e+00 (f/f0=2.396e-01), gradient 2-norm: 7.20904e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 45.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 45 | v: 4.349e+00 | ls-its:  3 | pg: 7.16e+13 | :  6.69e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.789934535 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #161: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31210e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.706100406 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #162: 1.09007e+01 (f/f0=6.006e-01), gradient 2-norm: 6.94315e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.791898105 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #163: 4.40864e+00 (f/f0=2.429e-01), gradient 2-norm: 8.48133e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.720029652 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #164: 4.34248e+00 (f/f0=2.393e-01), gradient 2-norm: 7.48987e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 46.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 46 | v: 4.342e+00 | ls-its:  4 | pg: 7.49e+13 | :  4.78e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.722250836 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #165: 6.44736e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23241e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.725325225 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #166: 1.16727e+01 (f/f0=6.431e-01), gradient 2-norm: 4.92831e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.715324817 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #167: 4.33005e+00 (f/f0=2.386e-01), gradient 2-norm: 7.16558e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 47.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 47 | v: 4.330e+00 | ls-its:  3 | pg: 7.12e+13 | :  6.70e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.721819427 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #168: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31209e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.702377459 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #169: 1.07818e+01 (f/f0=5.940e-01), gradient 2-norm: 6.99199e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.747868063 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #170: 4.38271e+00 (f/f0=2.415e-01), gradient 2-norm: 8.38040e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.717456852 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #171: 4.32423e+00 (f/f0=2.383e-01), gradient 2-norm: 7.44021e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 48.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 48 | v: 4.324e+00 | ls-its:  4 | pg: 7.44e+13 | :  4.81e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.821309557 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #172: 6.44737e+01 (f/f0=3.552e+00), gradient 2-norm: 6.23243e+15</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.714442196 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #173: 1.16766e+01 (f/f0=6.433e-01), gradient 2-norm: 4.93001e+14</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.806073757 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #174: 4.31272e+00 (f/f0=2.376e-01), gradient 2-norm: 7.12238e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 49.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 49 | v: 4.313e+00 | ls-its:  3 | pg: 7.08e+13 | :  6.70e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.70610649 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #175: 1.62274e+01 (f/f0=8.941e-01), gradient 2-norm: 1.31208e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.791836097 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #176: 1.06686e+01 (f/f0=5.878e-01), gradient 2-norm: 7.03663e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.718668658 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #177: 4.35932e+00 (f/f0=2.402e-01), gradient 2-norm: 8.28852e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 30 years, 11.82 weeks as 92 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Adjoint solve took 0.792801653 seconds.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Objective #178: 4.30732e+00 (f/f0=2.373e-01), gradient 2-norm: 7.38933e+13</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Hessian not updated during iteration 50.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">It: 50 | v: 4.307e+00 | ls-its:  4 | pg: 7.39e+13 | :  4.81e-01 | qp-its:  1 +  0 | n-active:   3</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Optimization: Finished in 393.77336037 seconds.</span></span></code></pre></div><h3 id="Print-the-optimization-overview" tabindex="-1">Print the optimization overview <a class="header-anchor" href="#Print-the-optimization-overview" aria-label="Permalink to &quot;Print the optimization overview {#Print-the-optimization-overview}&quot;"></a></h3><p>If we display the optimization overview, we can see that there are now additional columns indicating the optimized values. Note that while the permeability and porosities are well matched, the heat capacity of the low permeable layers are not very accurate. There is likely not enough data in the production profiles to constrain the heat capacity of the low permeable layers, as there is limited heat siphoned from these layers in the truth case.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opt</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">DictParameters with 5 parameters (3 active), and 0 multipliers:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Active optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">      Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">      Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Optimiz</span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          layer_perm  1.97e-13  0.0      3  9.87e-15  1.48e-12  1.45e-1 </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> layer_heat_capacity  400.0  0.0         3     400.0    1000.0  400.0  </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    layer_porosities  0.2  2.78e-17      3      0.05      0.35  0.0621, </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-dark:#39c5cf;">                                                               2 columns omitted</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Inactive optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                    Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value    </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          injection_rate  0.015  3.47e-18     10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> injection_temperature_C  15.0  0.0           10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No multipliers set.</span></span></code></pre></div><h3 id="Simulate-the-optimized-case" tabindex="-1">Simulate the optimized case <a class="header-anchor" href="#Simulate-the-optimized-case" aria-label="Permalink to &quot;Simulate the optimized case {#Simulate-the-optimized-case}&quot;"></a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">case_opt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_doublet_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prm_opt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws_opt, states_opt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case_opt)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 92 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (2 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Producer</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Injector</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 92 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 92</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 92 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Feb. 04 2026 10:54 after 840 milliseconds, 875 microseconds, 434 nanoseconds.</span></span></code></pre></div><h4 id="Plot-the-well-responses" tabindex="-1">Plot the well responses <a class="header-anchor" href="#Plot-the-well-responses" aria-label="Permalink to &quot;Plot the well responses {#Plot-the-well-responses}&quot;"></a></h4><p>We plot the well responses for the producer temperature, producer water rate, and injector bottom hole pressure. These values represent the data used in the objective function. We observe good match, which is consistent with the reduction in the objective function valeu during the optimization.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(w</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get_prod_temp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(w[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get_prod_rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:wrat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:liter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get_inj_bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(w[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Producer temperature&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature (C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_prod_temp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Truth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_guess), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_prod_temp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_guess), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Initial guess&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_opt), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_prod_temp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_opt), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :rc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Producer water rate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Liter / s&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_prod_rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Truth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_guess), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_prod_rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_guess), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Initial guess&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_opt), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_prod_rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_opt), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :rc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Producer bottom hole pressure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Pressure (bar)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_inj_bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Truth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_guess), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_inj_bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_guess), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Initial guess&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_wtime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_opt), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_inj_bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws_opt), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :rc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/JutulDarcy.jl/stable/assets/vachpkg.CwOLXqAu.jpeg" alt=""></p><h4 id="Plot-the-spatial-results" tabindex="-1">Plot the spatial results <a class="header-anchor" href="#Plot-the-spatial-results" aria-label="Permalink to &quot;Plot the spatial results {#Plot-the-spatial-results}&quot;"></a></h4><p>We plot the spatial results for the truth case, the initial guess, and the optimized case. The temperature is plotted in Celsius and we use the same color scale for all steps. Note that in terms of the optimizer itself, this is hidden data: The objective function only matches the well responses. Getting a good match in the spatial distribution of temperature is a side-effect of the physics and parametrization of the model, as different physics or a different parameterization could lead to good match in terms of the objective function, even without good match for the spatial distribution.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cmap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">to_colormap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:heat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Truth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, rmesh, states[step][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">elevation[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">azimuth[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidedecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Initial guess&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, rmesh, states_guess[step][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">elevation[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">azimuth[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidedecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, rmesh, states_opt[step][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">elevation[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">azimuth[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidedecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], plt, vertical </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/JutulDarcy.jl/stable/assets/ijlekme.DjGJAkkD.jpeg" alt=""></p><h2 id="Set-up-control-optimization" tabindex="-1">Set up control optimization <a class="header-anchor" href="#Set-up-control-optimization" aria-label="Permalink to &quot;Set up control optimization {#Set-up-control-optimization}&quot;"></a></h2><p>We can also use the same setup to perform control optimization, where we now can take advantage of the per-interval selection of rates and temperatures. Admittely, this problems is fairly simple, so the optimization is more conceptual than realistic: We define a new objective function that uses a fixed cost for the injected water (per degree times rate) and a similar value of produced heat. To make the optimization problem non-trivial, the cost of additional water (or higher temperature water) is significantly higher than the value of produced water with the same temperature.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temperature_injection_cost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temperature_production_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> optimization_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, dt, step_info, forces)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    T_at_prod </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_well_qoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, forces, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    T_at_inj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(forces[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Facility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">control[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temperature, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mass_rate_injector </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compute_well_qoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, forces, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mass_rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mass_rate_producer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compute_well_qoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, s, forces, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mass_rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cost_inj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mass_rate_injector) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T_at_inj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> temperature_injection_cost</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    value_prod </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mass_rate_producer) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T_at_prod </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> temperature_production_value</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (value_prod </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cost_inj) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> total_time</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opt_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup_reservoir_dict_optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prm_truth, setup_doublet_case)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">DictParameters with 5 parameters (0 active), and 0 multipliers:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No active optimization parameters.</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Inactive optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                    Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value               </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     layer_heat_capacity  500.0, 600.0, 450.0              3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          injection_rate  0.015  3.47e-18                10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> injection_temperature_C  15.0  0.0                      10    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">              layer_perm  9.87e-15, 7.9e-13, 1.97e-14      3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">        layer_porosities  0.1, 0.3, 0.1                    3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No multipliers set.</span></span></code></pre></div><h3 id="Set-optimization-to-use-injection-rate-and-temperature" tabindex="-1">Set optimization to use injection rate and temperature <a class="header-anchor" href="#Set-optimization-to-use-injection-rate-and-temperature" aria-label="Permalink to &quot;Set optimization to use injection rate and temperature {#Set-optimization-to-use-injection-rate-and-temperature}&quot;"></a></h3><p>Note that as these are represented as per-interval values, we could also have passed vectors of equal length as the number of intervals for more fine-grained control over the limits. We specify that the dependencies include the whole case instead of just state0 and parameters since the forces depend on the optimization parameters.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">free_optimization_parameter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt_ctrl, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_temperature_C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">free_optimization_parameter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt_ctrl, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_rate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, abs_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">liter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">second, abs_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">liter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">second)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">DictParameters with 5 parameters (2 active), and 0 multipliers:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Active optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                    Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value    </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">   Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">  Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> injection_temperature_C  15.0  0.0           10   10.0  80.0 </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          injection_rate  0.015  3.47e-18     10  0.001  0.03 </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Inactive optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value               </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> layer_heat_capacity  500.0, 600.0, 450.0              3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          layer_perm  9.87e-15, 7.9e-13, 1.97e-14      3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    layer_porosities  0.1, 0.3, 0.1                    3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No multipliers set.</span></span></code></pre></div><h3 id="Call-the-optimizer-2" tabindex="-1">Call the optimizer <a class="header-anchor" href="#Call-the-optimizer-2" aria-label="Permalink to &quot;Call the optimizer {#Call-the-optimizer-2}&quot;"></a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prm_opt_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">optimize_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt_ctrl, optimization_objective, maximize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, deps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, optimizer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :lbfgsb_qp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opt_ctrl</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">DictParameters with 5 parameters (2 active), and 0 multipliers:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Active optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                    Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value    </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">   Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">  Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Optimize</span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> injection_temperature_C  15.0  0.0           10   10.0  80.0  10.8  1 </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          injection_rate  0.015  3.47e-18     10  0.001  0.03  0.0157  </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-dark:#39c5cf;">                                                               2 columns omitted</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">Inactive optimization parameters</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">                Name </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Initial value               </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Count </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Min </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Max </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> layer_heat_capacity  500.0, 600.0, 450.0              3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">          layer_perm  9.87e-15, 7.9e-13, 1.97e-14      3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    layer_porosities  0.1, 0.3, 0.1                    3    -    - </span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"></span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">No multipliers set.</span></span></code></pre></div><h3 id="Plot-the-optimized-injection-rates-and-temperatures" tabindex="-1">Plot the optimized injection rates and temperatures <a class="header-anchor" href="#Plot-the-optimized-injection-rates-and-temperatures" aria-label="Permalink to &quot;Plot the optimized injection rates and temperatures {#Plot-the-optimized-injection-rates-and-temperatures}&quot;"></a></h3><p>The optimized injection rates and temperatures are plotted for each interval. The base case is shown in blue, while the optimized case is shown in orange. Note that the optimized case has reduced the injection temperature to the lower limit for all steps, and instead increase the injection rate significantly. The injection rate has a decrease part-way during the simulation, which increases the residence time of the injected water, allowing additional heat to be siphoned from the low permeable layers.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized injection temperature&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Injection temperature (C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Interval&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, prm_truth[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_temperature_C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Base case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, prm_opt_ctrl[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_temperature_C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :rc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized injection rate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Liter/second&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Interval&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, prm_truth[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_rate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(liter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">second), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Base case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scatter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, prm_opt_ctrl[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;injection_rate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(liter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">second), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :rc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/JutulDarcy.jl/stable/assets/kzjqcut.Pz28bBOv.jpeg" alt=""></p><h3 id="Simulate-the-optimized-case-2" tabindex="-1">Simulate the optimized case <a class="header-anchor" href="#Simulate-the-optimized-case-2" aria-label="Permalink to &quot;Simulate the optimized case {#Simulate-the-optimized-case-2}&quot;"></a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">case_opt_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_doublet_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prm_opt_ctrl)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws_opt_ctrl, states_opt_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case_opt_ctrl)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 92 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (2 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Producer</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Injector</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mrat =&gt; Vector{Float64} of size (92,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 92 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (1000,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 1000)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 92</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 92 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Feb. 04 2026 10:56 after 820 milliseconds, 89 microseconds, 14 nanoseconds.</span></span></code></pre></div><h3 id="Plot-the-distribution-of-temperature-with-and-without-optimization" tabindex="-1">Plot the distribution of temperature with and without optimization <a class="header-anchor" href="#Plot-the-distribution-of-temperature-with-and-without-optimization" aria-label="Permalink to &quot;Plot the distribution of temperature with and without optimization {#Plot-the-distribution-of-temperature-with-and-without-optimization}&quot;"></a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cmap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">to_colormap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:heat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Base case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, rmesh, states[step][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">elevation[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">azimuth[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidedecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, rmesh, states_opt_ctrl[step][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">elevation[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">azimuth[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidedecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], plt, vertical </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/JutulDarcy.jl/stable/assets/iaionez.Cf6sSaZt.jpeg" alt=""></p><h3 id="Plot-the-total-thermal-energy-in-the-reservoir" tabindex="-1">Plot the total thermal energy in the reservoir <a class="header-anchor" href="#Plot-the-total-thermal-energy-in-the-reservoir" aria-label="Permalink to &quot;Plot the total thermal energy in the reservoir {#Plot-the-total-thermal-energy-in-the-reservoir}&quot;"></a></h3><p>The total thermal energy in the reservoir is computed as the sum of the thermal energy in each cell, which is the result of the rock heat capacity, porosity, fluid heat capacity and the temperature in each cell. The optimized strategy significantly decreases the remaining thermal energy in the reservoir, while still producing less cost than the base case according to our objective. The 2D nature of this problem makes it easy to recover a large amount energy, as the majority of the cells are swept by the cold front.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">total_energy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:TotalThermalEnergy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), states)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">total_energy_opt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:TotalThermalEnergy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), states_opt_ctrl)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Total thermal energy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Total remaining energy (megajoules)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t, total_energy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Base case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t, total_energy_opt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Optimized case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :rc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/JutulDarcy.jl/stable/assets/kwlrffw.Cl3nJm5V.jpeg" alt=""></p><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;"></a></h2><p>If you would like to run this example yourself, it can be downloaded from the JutulDarcy.jl GitHub repository <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/main/examples/workflow/fully_differentiable_geothermal.jl" target="_blank" rel="noreferrer">as a script</a>, or as a <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/gh-pages/dev/final_site/notebooks/workflow/fully_differentiable_geothermal.ipynb" target="_blank" rel="noreferrer">Jupyter Notebook</a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">This example took 518.948296576 seconds to complete.</span></span></code></pre></div><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/sintefmath/JutulDarcy.jl/edit/main/docs/src/examples/workflow/fully_differentiable_geothermal.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/JutulDarcy.jl/stable/examples/workflow/five_spot_ensemble" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Quarter-five-spot example</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/JutulDarcy.jl/stable/examples/workflow/hybrid_simulation_relperm" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Hybrid simulation with neural network for relative permeability</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860> Copyright 2026 SINTEF Digital.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"examples_compositional_clapeyron.md\":\"C_U42NbK\",\"examples_compositional_compositional_2d_vertical.md\":\"Cel_0nRC\",\"examples_compositional_compositional_5components.md\":\"CyFUDLOS\",\"examples_data_assimilation_advanced_history_match.md\":\"CexDy7-a\",\"examples_data_assimilation_cgnet_egg.md\":\"Blp3KyWt\",\"examples_data_assimilation_optimize_simple_bl.md\":\"8278HGvK\",\"examples_data_assimilation_spe1_gradients.md\":\"B2dmAy0P\",\"examples_discretization_consistent_avgmpfa.md\":\"BZuvWzEX\",\"examples_discretization_mpfa_weno_discretizations.md\":\"KN-VVDte\",\"examples_geothermal_geothermal_doublet.md\":\"BoQZ93oQ\",\"examples_geothermal_htates_intro.md\":\"DCV1trDt\",\"examples_introduction_afi_input_file.md\":\"CvsH1VJ1\",\"examples_introduction_data_input_file.md\":\"CVN4_j6Q\",\"examples_introduction_intro_sensitivities.md\":\"BF33fpi_\",\"examples_introduction_spe10.md\":\"D7JuRI7D\",\"examples_introduction_two_phase_buckley_leverett.md\":\"gM6TVwjd\",\"examples_introduction_two_phase_gravity_segregation.md\":\"Cw9IQIm8\",\"examples_introduction_two_phase_unstable_gravity.md\":\"C6n7Ykop\",\"examples_introduction_wells_intro.md\":\"Ck3U2Y-m\",\"examples_overview_example_overview.md\":\"DFA7hpHK\",\"examples_properties_co2_props.md\":\"DTJeAzUE\",\"examples_properties_relperms.md\":\"o8_e8h-1\",\"examples_validation_validation_compositional.md\":\"xph72Uba\",\"examples_validation_validation_egg.md\":\"BF5AiYwI\",\"examples_validation_validation_mrst.md\":\"C4_XmYeK\",\"examples_validation_validation_norne_nohyst.md\":\"C7-N61XT\",\"examples_validation_validation_olympus_1.md\":\"BKE-iu_2\",\"examples_validation_validation_polymer.md\":\"BiilJpCS\",\"examples_validation_validation_spe1.md\":\"BlVjVfYs\",\"examples_validation_validation_spe9.md\":\"ByBTPhlq\",\"examples_validation_validation_thermal.md\":\"CPEwW3zA\",\"examples_workflow_adding_new_wells.md\":\"ChzqjuIG\",\"examples_workflow_co2_sloped.md\":\"BZvGdI8h\",\"examples_workflow_equilibrium_state.md\":\"DkN2Jlaz\",\"examples_workflow_five_spot_ensemble.md\":\"CHcSJdTc\",\"examples_workflow_fully_differentiable_geothermal.md\":\"Dd3CsqZ1\",\"examples_workflow_hybrid_simulation_relperm.md\":\"BEFU_Cuc\",\"examples_workflow_model_coarsening.md\":\"VGQfACOs\",\"examples_workflow_rate_optimization.md\":\"Cd2WZy4O\",\"examples_workflow_tracers_two_wells.md\":\"ee-E_myK\",\"extras_faq.md\":\"D8BF7496\",\"extras_paper_list.md\":\"BKlomguo\",\"extras_refs.md\":\"BkS7l8Ih\",\"index.md\":\"yf7cSWTR\",\"man_advanced_compiled.md\":\"BtclRtsn\",\"man_advanced_gpu.md\":\"BzulUi93\",\"man_advanced_mpi.md\":\"BT2OiSo5\",\"man_basics_forces.md\":\"B5aVZksu\",\"man_basics_input_files.md\":\"BjGu6KFM\",\"man_basics_models.md\":\"5oFjoMbR\",\"man_basics_package.md\":\"DeqOZjYm\",\"man_basics_parameters.md\":\"BpzdEjxx\",\"man_basics_plotting.md\":\"D7tPP89y\",\"man_basics_primary.md\":\"AnHNljaa\",\"man_basics_secondary.md\":\"C0SF7nI9\",\"man_basics_solution.md\":\"ZglRDa5k\",\"man_basics_systems.md\":\"BQSwftlh\",\"man_basics_utilities.md\":\"CMsFgG6w\",\"man_basics_wells.md\":\"CsJlcA_0\",\"man_first_ex.md\":\"DMyGekH5\",\"man_highlevel.md\":\"BaPTnroF\",\"man_intro.md\":\"D1hrr04g\",\"man_validation.md\":\"FnqjnL4T\",\"notebooks_empty.md\":\"Dgq2Ny00\",\"ref_jutul.md\":\"BJk41BK5\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"JutulDarcy.jl\",\"description\":\"Documentation for JutulDarcy.jl\",\"base\":\"/JutulDarcy.jl/stable/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"JutulDarcy.jl\",\"link\":\"/index\"},{\"text\":\"Getting started\",\"link\":\"/man/intro\"},{\"text\":\"Your first JutulDarcy.jl simulation\",\"link\":\"/man/first_ex\"},{\"text\":\"FAQ\",\"link\":\"/extras/faq\"}]},{\"text\":\"Fundamentals\",\"collapsed\":false,\"items\":[{\"text\":\"High-level API\",\"link\":\"/man/highlevel\"},{\"text\":\"Input formats\",\"link\":\"/man/basics/input_files\"},{\"text\":\"Supported physical systems\",\"link\":\"/man/basics/systems\"},{\"text\":\"Solving the equations\",\"link\":\"/man/basics/solution\"}]},{\"text\":\"Detailed API\",\"collapsed\":false,\"items\":[{\"text\":\"Driving forces\",\"link\":\"/man/basics/forces\"},{\"text\":\"Wells and controls\",\"link\":\"/man/basics/wells\"},{\"text\":\"Primary variables\",\"link\":\"/man/basics/primary\"},{\"text\":\"Secondary variables (properties)\",\"link\":\"/man/basics/secondary\"},{\"text\":\"Parameters\",\"link\":\"/man/basics/parameters\"},{\"text\":\"Plotting and visualization\",\"link\":\"/man/basics/plotting\"},{\"text\":\"Utilities\",\"link\":\"/man/basics/utilities\"}]},{\"text\":\"Parallelism and compilation\",\"collapsed\":false,\"items\":[{\"text\":\"Multi-threading and MPI support\",\"link\":\"/man/advanced/mpi\"},{\"text\":\"GPU support\",\"link\":\"/man/advanced/gpu\"},{\"text\":\"Standalone reservoir simulator\",\"link\":\"/man/advanced/compiled\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Package docstring\",\"link\":\"/man/basics/package\"},{\"text\":\"Publications making use of JutulDarcy.jl\",\"link\":\"/extras/paper_list\"},{\"text\":\"Jutul functions\",\"link\":\"/ref/jutul\"},{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Example overview\",\"link\":\"/examples/overview/example_overview\"},{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Set up a .AFI file for simulation\",\"link\":\"/examples/introduction/afi_input_file\"},{\"text\":\"Simulating Eclipse/DATA input files\",\"link\":\"/examples/introduction/data_input_file\"},{\"text\":\"Intro to sensitivities in JutulDarcy\",\"link\":\"/examples/introduction/intro_sensitivities\"},{\"text\":\"SPE10, model 2\",\"link\":\"/examples/introduction/spe10\"},{\"text\":\"Buckley-Leverett two-phase problem\",\"link\":\"/examples/introduction/two_phase_buckley_leverett\"},{\"text\":\"Gravity segregation example\",\"link\":\"/examples/introduction/two_phase_gravity_segregation\"},{\"text\":\"Gravity circulation with CPR preconditioner\",\"link\":\"/examples/introduction/two_phase_unstable_gravity\"},{\"text\":\"Introduction to wells\",\"link\":\"/examples/introduction/wells_intro\"}]},{\"text\":\"Workflow\",\"collapsed\":false,\"items\":[{\"text\":\"Adding new wells to an existing model\",\"link\":\"/examples/workflow/adding_new_wells\"},{\"text\":\"CO2 injection in saline aquifer with storage inventory\",\"link\":\"/examples/workflow/co2_sloped\"},{\"text\":\"Hydrostatic equilibriation of models\",\"link\":\"/examples/workflow/equilibrium_state\"},{\"text\":\"Quarter-five-spot example\",\"link\":\"/examples/workflow/five_spot_ensemble\"},{\"text\":\"A fully differentiable geothermal doublet: History matching and control optimization\",\"link\":\"/examples/workflow/fully_differentiable_geothermal\"},{\"text\":\"Hybrid simulation with neural network for relative permeability\",\"link\":\"/examples/workflow/hybrid_simulation_relperm\"},{\"text\":\"Model coarsening\",\"link\":\"/examples/workflow/model_coarsening\"},{\"text\":\"Gradient-based optimization of net present value (NPV)\",\"link\":\"/examples/workflow/rate_optimization\"},{\"text\":\"Adding tracers to a flow simulation\",\"link\":\"/examples/workflow/tracers_two_wells\"}]},{\"text\":\"Data assimilation\",\"collapsed\":false,\"items\":[{\"text\":\"Advanced history matching: Regions, blending and parametric models\",\"link\":\"/examples/data_assimilation/advanced_history_match\"},{\"text\":\"History matching a coarse model - CGNet\",\"link\":\"/examples/data_assimilation/cgnet_egg\"},{\"text\":\"Gradient-based matching of parameters against observations\",\"link\":\"/examples/data_assimilation/optimize_simple_bl\"},{\"text\":\"Adjoint gradients for the SPE1 model\",\"link\":\"/examples/data_assimilation/spe1_gradients\"}]},{\"text\":\"Geothermal\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal doublet\",\"link\":\"/examples/geothermal/geothermal_doublet\"},{\"text\":\"High-temperature Aquifer Thermal Energy Storage (HT-ATES)\",\"link\":\"/examples/geothermal/htates_intro\"}]},{\"text\":\"Compositional\",\"collapsed\":false,\"items\":[{\"text\":\"Compositional simulation with Clapeyron.jl equations of state\",\"link\":\"/examples/compositional/clapeyron\"},{\"text\":\"Intro to compositional flow\",\"link\":\"/examples/compositional/compositional_2d_vertical\"},{\"text\":\"A more complex compositional model\",\"link\":\"/examples/compositional/compositional_5components\"}]},{\"text\":\"Discretization\",\"collapsed\":false,\"items\":[{\"text\":\"Consistent discretizations: Average MPFA and nonlinear TPFA\",\"link\":\"/examples/discretization/consistent_avgmpfa\"},{\"text\":\"Consistent and high-resolution: WENO, NTPFA and AvgMPFA\",\"link\":\"/examples/discretization/mpfa_weno_discretizations\"}]},{\"text\":\"Properties\",\"collapsed\":false,\"items\":[{\"text\":\"CO2-brine correlations with salinity\",\"link\":\"/examples/properties/co2_props\"},{\"text\":\"Relative Permeabilities in JutulDarcy\",\"link\":\"/examples/properties/relperms\"}]}]},{\"text\":\"Validation\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/man/validation\"},{\"text\":\"Models\",\"collapsed\":false,\"items\":[{\"text\":\"Validation of equation-of-state compositional flow\",\"link\":\"/examples/validation/validation_compositional\"},{\"text\":\"The Egg model: Two-phase oil-water model\",\"link\":\"/examples/validation/validation_egg\"},{\"text\":\"Comparison between JutulDarcy.jl and MRST\",\"link\":\"/examples/validation/validation_mrst\"},{\"text\":\"Norne: Real field black-oil model\",\"link\":\"/examples/validation/validation_norne_nohyst\"},{\"text\":\"The OLYMPUS benchmark model: Two-phase corner-point reservoir\",\"link\":\"/examples/validation/validation_olympus_1\"},{\"text\":\"Polymer injection in a 2D black-oil reservoir model\",\"link\":\"/examples/validation/validation_polymer\"},{\"text\":\"SPE1: Small black-oil gas injection\",\"link\":\"/examples/validation/validation_spe1\"},{\"text\":\"SPE9: Black-oil depletion with dissolved gas\",\"link\":\"/examples/validation/validation_spe9\"},{\"text\":\"Aquifer thermal energy storage (ATES) validation\",\"link\":\"/examples/validation/validation_thermal\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"JutulDarcy.jl\",\"link\":\"/index\"},{\"text\":\"Getting started\",\"link\":\"/man/intro\"},{\"text\":\"Your first JutulDarcy.jl simulation\",\"link\":\"/man/first_ex\"},{\"text\":\"FAQ\",\"link\":\"/extras/faq\"}]},{\"text\":\"Fundamentals\",\"collapsed\":false,\"items\":[{\"text\":\"High-level API\",\"link\":\"/man/highlevel\"},{\"text\":\"Input formats\",\"link\":\"/man/basics/input_files\"},{\"text\":\"Supported physical systems\",\"link\":\"/man/basics/systems\"},{\"text\":\"Solving the equations\",\"link\":\"/man/basics/solution\"}]},{\"text\":\"Detailed API\",\"collapsed\":false,\"items\":[{\"text\":\"Driving forces\",\"link\":\"/man/basics/forces\"},{\"text\":\"Wells and controls\",\"link\":\"/man/basics/wells\"},{\"text\":\"Primary variables\",\"link\":\"/man/basics/primary\"},{\"text\":\"Secondary variables (properties)\",\"link\":\"/man/basics/secondary\"},{\"text\":\"Parameters\",\"link\":\"/man/basics/parameters\"},{\"text\":\"Plotting and visualization\",\"link\":\"/man/basics/plotting\"},{\"text\":\"Utilities\",\"link\":\"/man/basics/utilities\"}]},{\"text\":\"Parallelism and compilation\",\"collapsed\":false,\"items\":[{\"text\":\"Multi-threading and MPI support\",\"link\":\"/man/advanced/mpi\"},{\"text\":\"GPU support\",\"link\":\"/man/advanced/gpu\"},{\"text\":\"Standalone reservoir simulator\",\"link\":\"/man/advanced/compiled\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Package docstring\",\"link\":\"/man/basics/package\"},{\"text\":\"Publications making use of JutulDarcy.jl\",\"link\":\"/extras/paper_list\"},{\"text\":\"Jutul functions\",\"link\":\"/ref/jutul\"},{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Example overview\",\"link\":\"/examples/overview/example_overview\"},{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Set up a .AFI file for simulation\",\"link\":\"/examples/introduction/afi_input_file\"},{\"text\":\"Simulating Eclipse/DATA input files\",\"link\":\"/examples/introduction/data_input_file\"},{\"text\":\"Intro to sensitivities in JutulDarcy\",\"link\":\"/examples/introduction/intro_sensitivities\"},{\"text\":\"SPE10, model 2\",\"link\":\"/examples/introduction/spe10\"},{\"text\":\"Buckley-Leverett two-phase problem\",\"link\":\"/examples/introduction/two_phase_buckley_leverett\"},{\"text\":\"Gravity segregation example\",\"link\":\"/examples/introduction/two_phase_gravity_segregation\"},{\"text\":\"Gravity circulation with CPR preconditioner\",\"link\":\"/examples/introduction/two_phase_unstable_gravity\"},{\"text\":\"Introduction to wells\",\"link\":\"/examples/introduction/wells_intro\"}]},{\"text\":\"Workflow\",\"collapsed\":false,\"items\":[{\"text\":\"Adding new wells to an existing model\",\"link\":\"/examples/workflow/adding_new_wells\"},{\"text\":\"CO2 injection in saline aquifer with storage inventory\",\"link\":\"/examples/workflow/co2_sloped\"},{\"text\":\"Hydrostatic equilibriation of models\",\"link\":\"/examples/workflow/equilibrium_state\"},{\"text\":\"Quarter-five-spot example\",\"link\":\"/examples/workflow/five_spot_ensemble\"},{\"text\":\"A fully differentiable geothermal doublet: History matching and control optimization\",\"link\":\"/examples/workflow/fully_differentiable_geothermal\"},{\"text\":\"Hybrid simulation with neural network for relative permeability\",\"link\":\"/examples/workflow/hybrid_simulation_relperm\"},{\"text\":\"Model coarsening\",\"link\":\"/examples/workflow/model_coarsening\"},{\"text\":\"Gradient-based optimization of net present value (NPV)\",\"link\":\"/examples/workflow/rate_optimization\"},{\"text\":\"Adding tracers to a flow simulation\",\"link\":\"/examples/workflow/tracers_two_wells\"}]},{\"text\":\"Data assimilation\",\"collapsed\":false,\"items\":[{\"text\":\"Advanced history matching: Regions, blending and parametric models\",\"link\":\"/examples/data_assimilation/advanced_history_match\"},{\"text\":\"History matching a coarse model - CGNet\",\"link\":\"/examples/data_assimilation/cgnet_egg\"},{\"text\":\"Gradient-based matching of parameters against observations\",\"link\":\"/examples/data_assimilation/optimize_simple_bl\"},{\"text\":\"Adjoint gradients for the SPE1 model\",\"link\":\"/examples/data_assimilation/spe1_gradients\"}]},{\"text\":\"Geothermal\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal doublet\",\"link\":\"/examples/geothermal/geothermal_doublet\"},{\"text\":\"High-temperature Aquifer Thermal Energy Storage (HT-ATES)\",\"link\":\"/examples/geothermal/htates_intro\"}]},{\"text\":\"Compositional\",\"collapsed\":false,\"items\":[{\"text\":\"Compositional simulation with Clapeyron.jl equations of state\",\"link\":\"/examples/compositional/clapeyron\"},{\"text\":\"Intro to compositional flow\",\"link\":\"/examples/compositional/compositional_2d_vertical\"},{\"text\":\"A more complex compositional model\",\"link\":\"/examples/compositional/compositional_5components\"}]},{\"text\":\"Discretization\",\"collapsed\":false,\"items\":[{\"text\":\"Consistent discretizations: Average MPFA and nonlinear TPFA\",\"link\":\"/examples/discretization/consistent_avgmpfa\"},{\"text\":\"Consistent and high-resolution: WENO, NTPFA and AvgMPFA\",\"link\":\"/examples/discretization/mpfa_weno_discretizations\"}]},{\"text\":\"Properties\",\"collapsed\":false,\"items\":[{\"text\":\"CO2-brine correlations with salinity\",\"link\":\"/examples/properties/co2_props\"},{\"text\":\"Relative Permeabilities in JutulDarcy\",\"link\":\"/examples/properties/relperms\"}]}]},{\"text\":\"Validation\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/man/validation\"},{\"text\":\"Models\",\"collapsed\":false,\"items\":[{\"text\":\"Validation of equation-of-state compositional flow\",\"link\":\"/examples/validation/validation_compositional\"},{\"text\":\"The Egg model: Two-phase oil-water model\",\"link\":\"/examples/validation/validation_egg\"},{\"text\":\"Comparison between JutulDarcy.jl and MRST\",\"link\":\"/examples/validation/validation_mrst\"},{\"text\":\"Norne: Real field black-oil model\",\"link\":\"/examples/validation/validation_norne_nohyst\"},{\"text\":\"The OLYMPUS benchmark model: Two-phase corner-point reservoir\",\"link\":\"/examples/validation/validation_olympus_1\"},{\"text\":\"Polymer injection in a 2D black-oil reservoir model\",\"link\":\"/examples/validation/validation_polymer\"},{\"text\":\"SPE1: Small black-oil gas injection\",\"link\":\"/examples/validation/validation_spe1\"},{\"text\":\"SPE9: Black-oil depletion with dissolved gas\",\"link\":\"/examples/validation/validation_spe9\"},{\"text\":\"Aquifer thermal energy storage (ATES) validation\",\"link\":\"/examples/validation/validation_thermal\"}]}]}],\"editLink\":{\"pattern\":\"https://https://github.com/sintefmath/JutulDarcy.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/sintefmath/JutulDarcy.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\" Copyright 2026 SINTEF Digital.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>