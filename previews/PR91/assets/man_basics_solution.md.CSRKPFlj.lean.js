import{_ as o,C as d,c as a,o as e,j as t,ai as l,a as T,G as m}from"./chunks/framework.BfePisH6.js";const X1=JSON.parse('{"title":"Solving the equations","description":"","frontmatter":{},"headers":[],"relativePath":"man/basics/solution.md","filePath":"man/basics/solution.md","lastUpdated":null}'),n={name:"man/basics/solution.md"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.127ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1824 1000","aria-hidden":"true"},h={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.005ex",role:"img",focusable:"false",viewBox:"0 -444 607 444","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.218ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.394ex",height:"5.365ex",role:"img",focusable:"false",viewBox:"0 -1391 15644.3 2371.2","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.373ex",height:"1.005ex",role:"img",focusable:"false",viewBox:"0 -444 607 444","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.741ex",height:"2.61ex",role:"img",focusable:"false",viewBox:"0 -903.7 8283.5 1153.7","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.407ex",height:"1.027ex",role:"img",focusable:"false",viewBox:"0 -443 622 454","aria-hidden":"true"},k={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.218ex"},xmlns:"http://www.w3.org/2000/svg",width:"31.114ex",height:"5.365ex",role:"img",focusable:"false",viewBox:"0 -1391 13752.4 2371.2","aria-hidden":"true"},M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.361ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1043.6 833.9","aria-hidden":"true"},b={class:"jldocstring custom-block",open:""},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.921ex",height:"1.984ex",role:"img",focusable:"false",viewBox:"0 -683 3059.2 877","aria-hidden":"true"},v={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.679ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 2067.9 899","aria-hidden":"true"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.697ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1192.2 840.8","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.205ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 1416.7 636","aria-hidden":"true"},C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.16ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 3606.8 840.8","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.363ex"},xmlns:"http://www.w3.org/2000/svg",width:"42.083ex",height:"9.858ex",role:"img",focusable:"false",viewBox:"0 -2428.6 18600.8 4357.2","aria-hidden":"true"},J={class:"jldocstring custom-block",open:""},I={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.602ex"},xmlns:"http://www.w3.org/2000/svg",width:"89.244ex",height:"4.749ex",role:"img",focusable:"false",viewBox:"0 -1391 39445.9 2099","aria-hidden":"true"},X={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.602ex"},xmlns:"http://www.w3.org/2000/svg",width:"146.907ex",height:"4.749ex",role:"img",focusable:"false",viewBox:"0 -1391 64932.8 2099","aria-hidden":"true"},N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.013ex",height:"1.65ex",role:"img",focusable:"false",viewBox:"0 -442 889.7 729.2","aria-hidden":"true"},G={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453","aria-hidden":"true"},U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.663ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.656ex",height:"2.36ex",role:"img",focusable:"false",viewBox:"0 -750 5593.8 1043.1","aria-hidden":"true"},W={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.187ex",height:"2.195ex",role:"img",focusable:"false",viewBox:"0 -683 1408.7 970.2","aria-hidden":"true"},Y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.785ex",height:"2.756ex",role:"img",focusable:"false",viewBox:"0 -833.9 5651 1218.1","aria-hidden":"true"},Q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.725ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7392.6 1000","aria-hidden":"true"},a1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.699ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 751 683","aria-hidden":"true"},l1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.924ex",height:"2.072ex",role:"img",focusable:"false",viewBox:"0 -833.9 6154.4 915.9","aria-hidden":"true"},m1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.61ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 8667.6 1000","aria-hidden":"true"},d1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.149ex"},xmlns:"http://www.w3.org/2000/svg",width:"34.573ex",height:"5.43ex",role:"img",focusable:"false",viewBox:"0 -1450 15281.1 2400","aria-hidden":"true"},r1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.886ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1275.8 840.8","aria-hidden":"true"},h1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.734ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1650.6 840.8","aria-hidden":"true"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.31ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1463.2 840.8","aria-hidden":"true"},c1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.31ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1463.2 840.8","aria-hidden":"true"},w1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},x1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.25ex"},xmlns:"http://www.w3.org/2000/svg",width:"59.166ex",height:"5.631ex",role:"img",focusable:"false",viewBox:"0 -1494.4 26151.3 2488.7","aria-hidden":"true"},f1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},y1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.791ex"},xmlns:"http://www.w3.org/2000/svg",width:"37.681ex",height:"2.791ex",role:"img",focusable:"false",viewBox:"0 -883.9 16655.1 1233.4","aria-hidden":"true"},k1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.283ex",height:"1.361ex",role:"img",focusable:"false",viewBox:"0 -444 1008.9 601.8","aria-hidden":"true"},M1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.406ex",height:"1.375ex",role:"img",focusable:"false",viewBox:"0 -450 1063.3 607.8","aria-hidden":"true"},b1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.734ex",height:"2.576ex",role:"img",focusable:"false",viewBox:"0 -883.9 9606.3 1138.7","aria-hidden":"true"},Z1={class:"tip custom-block"},v1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.059ex",height:"2.463ex",role:"img",focusable:"false",viewBox:"0 -833.9 7098.2 1088.7","aria-hidden":"true"},_1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.059ex",height:"2.463ex",role:"img",focusable:"false",viewBox:"0 -833.9 7098.2 1088.7","aria-hidden":"true"},A1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.734ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1650.6 840.8","aria-hidden":"true"};function C1(S1,Q,P1,E1,J1,I1){const s=d("Badge");return e(),a("div",null,[Q[130]||(Q[130]=t("h1",{id:"Solving-the-equations",tabindex:"-1"},[T("Solving the equations "),t("a",{class:"header-anchor",href:"#Solving-the-equations","aria-label":'Permalink to "Solving the equations {#Solving-the-equations}"'},"​")],-1)),Q[131]||(Q[131]=t("p",null,"By default, Jutul solves a system as a fully-coupled implicit system of equations discretized with a two-point flux approximation with single-point upwind.",-1)),Q[132]||(Q[132]=t("h2",{id:"Newton's-method",tabindex:"-1"},[T("Newton's method "),t("a",{class:"header-anchor",href:"#Newton's-method","aria-label":`Permalink to "Newton&#39;s method {#Newton's-method}"`},"​")],-1)),t("p",null,[Q[4]||(Q[4]=T("The standard way of solving a system of non-linear equations is by Newton's method (also known as Newton-Raphson's method). A quick recap: For a vector valued residual ")),t("mjx-container",r,[(e(),a("svg",i,Q[0]||(Q[0]=[l("",1)]))),Q[1]||(Q[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mo",{stretchy:"false"},"("),t("mi",null,"x"),t("mo",{stretchy:"false"},")")])],-1))]),Q[5]||(Q[5]=T(" of the primary variable vector ")),t("mjx-container",h,[(e(),a("svg",p,Q[2]||(Q[2]=[l("",1)]))),Q[3]||(Q[3]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")])])],-1))]),Q[6]||(Q[6]=T(" we can defined a Newton update:"))]),t("mjx-container",g,[(e(),a("svg",u,Q[7]||(Q[7]=[l("",1)]))),Q[8]||(Q[8]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",null,"="),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"k")]),t("mo",null,"−"),t("msup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"k")]),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"i")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"j")])])]),t("mo",null,".")])],-1))]),t("p",null,[Q[11]||(Q[11]=T("JutulDarcy solves systems that generally have both non-smooth behavior and physical constraints on the values for ")),t("mjx-container",c,[(e(),a("svg",H,Q[9]||(Q[9]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mtext"},[t("path",{"data-c":"1D431",d:"M227 0Q212 3 121 3Q40 3 28 0H21V62H117L245 213L109 382H26V444H34Q49 441 143 441Q247 441 265 444H274V382H246L281 339Q315 297 316 297Q320 297 354 341L389 382H352V444H360Q375 441 466 441Q547 441 559 444H566V382H471L355 246L504 63L545 62H586V0H578Q563 3 469 3Q365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63L217 62H235V0H227Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[10]||(Q[10]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mtext",{mathvariant:"bold"},"x")])],-1))]),Q[12]||(Q[12]=T(". For that reason, we modify Newton's method slightly:"))]),t("mjx-container",w,[(e(),a("svg",x,Q[13]||(Q[13]=[l("",1)]))),Q[14]||(Q[14]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k"),t("mo",null,"+"),t("mn",null,"1")])]),t("mo",null,"="),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"k")]),t("mo",null,"+"),t("mi",null,"ω"),t("mo",{stretchy:"false"},"("),t("mi",{mathvariant:"normal"},"Δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")")])],-1))]),t("p",null,[Q[17]||(Q[17]=T("Here, ")),t("mjx-container",f,[(e(),a("svg",y,Q[15]||(Q[15]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D714",d:"M495 384Q495 406 514 424T555 443Q574 443 589 425T604 364Q604 334 592 278T555 155T483 38T377 -11Q297 -11 267 66Q266 68 260 61Q201 -11 125 -11Q15 -11 15 139Q15 230 56 325T123 434Q135 441 147 436Q160 429 160 418Q160 406 140 379T94 306T62 208Q61 202 61 187Q61 124 85 100T143 76Q201 76 245 129L253 137V156Q258 297 317 297Q348 297 348 261Q348 243 338 213T318 158L308 135Q309 133 310 129T318 115T334 97T358 83T393 76Q456 76 501 148T546 274Q546 305 533 325T508 357T495 384Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[16]||(Q[16]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"ω")])],-1))]),Q[18]||(Q[18]=T(" is a function that limits the variables so that they do not change too much (e.g. Appleyard chopping, limiting of pressure, saturation and composition updates) and that they are within the prescribed limits. There are also options for automated global dampening in the presence of convergence issues. The update is then defined from inverting the Jacobian:"))]),t("mjx-container",k,[(e(),a("svg",L,Q[19]||(Q[19]=[l("",1)]))),Q[20]||(Q[20]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",{mathvariant:"normal"},"Δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",null,"="),t("mo",null,"−"),t("msup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mo",{stretchy:"false"},"("),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"k")]),t("mo",{stretchy:"false"},")"),t("mo",null,","),t("mstyle",{scriptlevel:"0"},[t("mspace",{width:"1em"})]),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])]),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"i")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"j")])])]),t("mo",null,".")])],-1))]),t("p",null,[Q[23]||(Q[23]=T("Starting with ")),t("mjx-container",M,[(e(),a("svg",V,Q[21]||(Q[21]=[l("",1)]))),Q[22]||(Q[22]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mn",null,"0")])])],-1))]),Q[24]||(Q[24]=T("as some initial guess taken from the previous time-step, we can solve the system by iterating upon this loop."))]),Q[133]||(Q[133]=l("",6)),t("details",b,[t("summary",null,[Q[25]||(Q[25]=t("a",{id:"JutulDarcy.reservoir_linsolve",href:"#JutulDarcy.reservoir_linsolve"},[t("span",{class:"jlbinding"},"JutulDarcy.reservoir_linsolve")],-1)),Q[26]||(Q[26]=T()),m(s,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),Q[27]||(Q[27]=l("",6))]),Q[134]||(Q[134]=t("h4",{id:"Single-model-(only-porous-medium)",tabindex:"-1"},[T("Single model (only porous medium) "),t("a",{class:"header-anchor",href:"#Single-model-(only-porous-medium)","aria-label":'Permalink to "Single model (only porous medium) {#Single-model-(only-porous-medium)}"'},"​")],-1)),t("p",null,[Q[38]||(Q[38]=T("If the model is a single model (e.g. only a reservoir) the matrix format is a block-CSC matrix that combines Julia's builtin sparse matrix format with statically sized elements from the ")),Q[39]||(Q[39]=t("a",{href:"https://github.com/JuliaArrays/StaticArrays.jl",target:"_blank",rel:"noreferrer"},"StaticArrays.jl",-1)),Q[40]||(Q[40]=T(" package. If we consider the two-phase immiscible system from ")),Q[41]||(Q[41]=t("a",{href:"/JutulDarcy.jl/previews/PR91/man/basics/systems#Multi-phase,-immiscible-flow"},"Multi-phase, immiscible flow",-1)),Q[42]||(Q[42]=T(" we have a pair of equations ")),t("mjx-container",D,[(e(),a("svg",Z,Q[28]||(Q[28]=[l("",1)]))),Q[29]||(Q[29]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"R"),t("mi",null,"n")]),t("mo",null,","),t("msub",null,[t("mi",null,"R"),t("mi",null,"w")])])],-1))]),Q[43]||(Q[43]=T(" together with the corresponding primary variables pressure and first saturation ")),t("mjx-container",v,[(e(),a("svg",j,Q[30]||(Q[30]=[l("",1)]))),Q[31]||(Q[31]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"p"),t("mo",null,","),t("msub",null,[t("mi",null,"S"),t("mi",null,"n")])])],-1))]),Q[44]||(Q[44]=T(" defined for all ")),t("mjx-container",_,[(e(),a("svg",R,Q[32]||(Q[32]=[l("",1)]))),Q[33]||(Q[33]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"N"),t("mi",null,"c")])])],-1))]),Q[45]||(Q[45]=T(" cells. Let us simplify the notation a bit so that the subscripts of the primary variables are ")),t("mjx-container",A,[(e(),a("svg",O,Q[34]||(Q[34]=[l("",1)]))),Q[35]||(Q[35]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"p"),t("mo",null,","),t("mi",null,"s")])],-1))]),Q[46]||(Q[46]=T(" and define a ")),t("mjx-container",C,[(e(),a("svg",S,Q[36]||(Q[36]=[l("",1)]))),Q[37]||(Q[37]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"N"),t("mi",null,"c")]),t("mo",null,"×"),t("msub",null,[t("mi",null,"N"),t("mi",null,"c")])])],-1))]),Q[47]||(Q[47]=T(" block Jacobian linear system where the entires are given by:"))]),t("mjx-container",P,[(e(),a("svg",E,Q[48]||(Q[48]=[l("",1)]))),Q[49]||(Q[49]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])])]),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"p")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])]),t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])])]),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"s")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])])]),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"p")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])]),t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",null,"r"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])])]),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"s")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mo",null,"="),t("msub",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n"),t("mi",null,"p")])])]),t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n"),t("mi",null,"s")])])])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"p")])])]),t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"s")])])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])])],-1))]),Q[135]||(Q[135]=l("",4)),t("details",J,[t("summary",null,[Q[50]||(Q[50]=t("a",{id:"JutulDarcy.CPRPreconditioner",href:"#JutulDarcy.CPRPreconditioner"},[t("span",{class:"jlbinding"},"JutulDarcy.CPRPreconditioner")],-1)),Q[51]||(Q[51]=T()),m(s,{type:"info",class:"jlObjectType jlType",text:"Type"})]),Q[52]||(Q[52]=l("",4))]),Q[136]||(Q[136]=t("p",null,"The short version of the CPR preconditioner can be motivated by our test system:",-1)),t("mjx-container",I,[(e(),a("svg",B,Q[53]||(Q[53]=[l("",1)]))),Q[54]||(Q[54]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"n")]),t("mo",null,"="),t("mfrac",null,[t("mi",null,"∂"),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"S"),t("mi",null,"w")]),t("mo",{stretchy:"false"},")"),t("msub",null,[t("mi",null,"ρ"),t("mi",null,"n")]),t("mi",null,"ϕ"),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",{mathvariant:"normal"},"∇"),t("mo",null,"⋅"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"ρ"),t("mi",null,"n")]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"n")]),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("msub",null,[t("mi",null,"ρ"),t("mi",null,"n")]),t("msub",null,[t("mi",null,"q"),t("mi",null,"n")]),t("mo",null,"="),t("mn",null,"0"),t("mo",null,","),t("mspace",{linebreak:"newline"}),t("msub",null,[t("mi",null,"r"),t("mi",null,"w")]),t("mo",null,"="),t("mfrac",null,[t("mi",null,"∂"),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"S"),t("mi",null,"w")]),t("msub",null,[t("mi",null,"ρ"),t("mi",null,"w")]),t("mi",null,"ϕ"),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",{mathvariant:"normal"},"∇"),t("mo",null,"⋅"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"ρ"),t("mi",null,"w")]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"w")]),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("msub",null,[t("mi",null,"ρ"),t("mi",null,"w")]),t("msub",null,[t("mi",null,"q"),t("mi",null,"w")]),t("mo",null,"="),t("mn",null,"0.")])],-1))]),Q[137]||(Q[137]=t("p",null,"For simplicity, we assume that there is no gravity, source terms, or compressibility. Each equation can then be divided by their respective densities and summed up to produce a pressure equation:",-1)),t("mjx-container",X,[(e(),a("svg",F,Q[55]||(Q[55]=[l("",1)]))),Q[56]||(Q[56]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"p")]),t("mo",null,"="),t("mfrac",null,[t("mi",null,"∂"),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"−"),t("msub",null,[t("mi",null,"S"),t("mi",null,"w")]),t("mo",{stretchy:"false"},")"),t("mi",null,"ϕ"),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",{mathvariant:"normal"},"∇"),t("mo",null,"⋅"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"n")]),t("mo",null,"+"),t("mfrac",null,[t("mi",null,"∂"),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"S"),t("mi",null,"w")]),t("mi",null,"ϕ"),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",{mathvariant:"normal"},"∇"),t("mo",null,"⋅"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"w")]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mfrac",null,[t("mi",null,"∂"),t("mrow",null,[t("mi",null,"∂"),t("mi",null,"t")])]),t("mo",{stretchy:"false"},"("),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"S"),t("mi",null,"w")]),t("mo",null,"−"),t("msub",null,[t("mi",null,"S"),t("mi",null,"w")]),t("mo",{stretchy:"false"},")"),t("mi",null,"ϕ"),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mi",{mathvariant:"normal"},"∇"),t("mo",null,"⋅"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"n")]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"w")]),t("mo",{stretchy:"false"},")"),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mi",{mathvariant:"normal"},"∇"),t("mo",null,"⋅"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"n")]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"v"),t("mo",{stretchy:"false"},"→")])]),t("mi",null,"w")]),t("mo",{stretchy:"false"},")"),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"K")]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"k"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("msub",null,[t("mi",null,"μ"),t("mi",null,"w")]),t("mo",null,"+"),t("msub",null,[t("mi",null,"k"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"n")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("msub",null,[t("mi",null,"μ"),t("mi",null,"n")]),t("mo",{stretchy:"false"},")"),t("mi",{mathvariant:"normal"},"∇"),t("mi",null,"p"),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("mi",{mathvariant:"normal"},"∇"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"K")]),t("msub",null,[t("mi",null,"λ"),t("mi",null,"t")]),t("mi",{mathvariant:"normal"},"∇"),t("mi",null,"p"),t("mo",null,"="),t("mn",null,"0")])],-1))]),Q[138]||(Q[138]=t("p",null,"The final equation is the variable coefficient Poisson equation and is referred to as the incompressible pressure equation for a porous media. We know that algebraic multigrid preconditioners (AMG) are highly efficient for linear systems made by discretizing this equation. The idea in CPR is to exploit this by constructing an approximate pressure equation that is suited for AMG inside the preconditioner.",-1)),Q[139]||(Q[139]=t("p",null,"Constructing the preconditioner is done in two stages:",-1)),t("ol",null,[Q[64]||(Q[64]=t("li",null,[t("p",null,"First, weights for each equation is found locally in each cell that decouples the time derivative from the non-pressure variables. In the above example, this was the true IMPES weights (dividing by density). JutulDarcy supports analytical true IMPES weights for some systems, numerical true IMPES weights for all systems and quasi IMPES weights for all systems.")],-1)),t("li",null,[t("p",null,[Q[61]||(Q[61]=T("A pressure equation is formed by weighting each equation by the respective weights and summing. We then have two systems: The pressure system ")),t("mjx-container",N,[(e(),a("svg",z,Q[57]||(Q[57]=[l("",1)]))),Q[58]||(Q[58]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"p")])])],-1))]),Q[62]||(Q[62]=T(" with scalar entries and the full system ")),t("mjx-container",G,[(e(),a("svg",q,Q[59]||(Q[59]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D45F",d:"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[60]||(Q[60]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"r")])],-1))]),Q[63]||(Q[63]=T(" that has block structure."))])])]),Q[140]||(Q[140]=t("p",null,"During the linear solve, the preconditioner is then made up of two broad stages: First, a preconditioner is applied to the pressure part (typically AMG), then the full system is preconditioned (typically ILU(0)) after the residual has been corrected by the pressure estimate:",-1)),t("ol",null,[t("li",null,[t("p",null,[Q[67]||(Q[67]=T("Form weighted pressure residual ")),t("mjx-container",U,[(e(),a("svg",K,Q[65]||(Q[65]=[l("",1)]))),Q[66]||(Q[66]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"r"),t("mi",null,"p")]),t("mo",null,"="),t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mi",null,"i")]),t("msub",null,[t("mi",null,"w"),t("mi",null,"i")]),t("msub",null,[t("mi",null,"r"),t("mi",null,"i")])])],-1))]),Q[68]||(Q[68]=T("."))])]),t("li",null,[t("p",null,[Q[73]||(Q[73]=T("Apply pressure preconditioer ")),t("mjx-container",W,[(e(),a("svg",$,Q[69]||(Q[69]=[l("",1)]))),Q[70]||(Q[70]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"M"),t("mi",null,"p")])])],-1))]),Q[74]||(Q[74]=T(": ")),t("mjx-container",Y,[(e(),a("svg",t1,Q[71]||(Q[71]=[l("",1)]))),Q[72]||(Q[72]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",{mathvariant:"normal"},"Δ"),t("mi",null,"p"),t("mo",null,"="),t("msubsup",null,[t("mi",null,"M"),t("mi",null,"p"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msub",null,[t("mi",null,"r"),t("mi",null,"p")])])],-1))]),Q[75]||(Q[75]=T("."))])]),t("li",null,[t("p",null,[Q[80]||(Q[80]=T("Correct global residual ")),t("mjx-container",Q1,[(e(),a("svg",T1,Q[76]||(Q[76]=[l("",1)]))),Q[77]||(Q[77]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"r"),t("mo",null,"∗")]),t("mo",null,"="),t("mi",null,"r"),t("mo",null,"−"),t("mi",null,"J"),t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",{mathvariant:"normal"},"Δ"),t("mi",null,"p"),t("mo",{stretchy:"false"},")")])],-1))]),Q[81]||(Q[81]=T(" where ")),t("mjx-container",a1,[(e(),a("svg",e1,Q[78]||(Q[78]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D443",d:"M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z",style:{"stroke-width":"3"}})])])],-1)]))),Q[79]||(Q[79]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P")])],-1))]),Q[82]||(Q[82]=T(" expands the pressure update to the full system vector, with zero entries outside the pressure indices."))])]),t("li",null,[t("p",null,[Q[85]||(Q[85]=T("Precondition the full system ")),t("mjx-container",l1,[(e(),a("svg",s1,Q[83]||(Q[83]=[l("",1)]))),Q[84]||(Q[84]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",{mathvariant:"normal"},"Δ"),t("msup",null,[t("mi",null,"x"),t("mo",null,"∗")]),t("mo",null,"="),t("msup",null,[t("mi",null,"M"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msup",null,[t("mi",null,"r"),t("mo",null,"∗")])])],-1))])])]),t("li",null,[t("p",null,[Q[88]||(Q[88]=T("Correct the global update with the pressure to obtain the final update: ")),t("mjx-container",m1,[(e(),a("svg",o1,Q[86]||(Q[86]=[l("",1)]))),Q[87]||(Q[87]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",{mathvariant:"normal"},"Δ"),t("mi",null,"x"),t("mo",null,"="),t("mi",{mathvariant:"normal"},"Δ"),t("msup",null,[t("mi",null,"x"),t("mo",null,"∗")]),t("mo",null,"+"),t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",{mathvariant:"normal"},"Δ"),t("mi",null,"p"),t("mo",{stretchy:"false"},")")])],-1))])])])]),Q[141]||(Q[141]=t("h4",{id:"Multi-model-(porous-medium-with-wells)",tabindex:"-1"},[T("Multi model (porous medium with wells) "),t("a",{class:"header-anchor",href:"#Multi-model-(porous-medium-with-wells)","aria-label":'Permalink to "Multi model (porous medium with wells) {#Multi-model-(porous-medium-with-wells)}"'},"​")],-1)),Q[142]||(Q[142]=t("p",null,"If a model is a porous medium with wells, the same preconditioners can be used, but an additional step is required to incorporate the well system. In practical terms, this means that our linearized system is expanded to multiple linear systems:",-1)),t("mjx-container",d1,[(e(),a("svg",n1,Q[89]||(Q[89]=[l("",1)]))),Q[90]||(Q[90]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"J"),t("mi",{mathvariant:"normal"},"Δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"r")])])]),t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])])])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])])]),t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")])])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("mi",{mathvariant:"normal"},"Δ"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"r")])])]),t("mtr",null,[t("mtd",null,[t("mi",{mathvariant:"normal"},"Δ"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"w")])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"r")])])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"w")])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")])])],-1))]),t("p",null,[Q[99]||(Q[99]=T("Here, ")),t("mjx-container",r1,[(e(),a("svg",i1,Q[91]||(Q[91]=[l("",1)]))),Q[92]||(Q[92]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"r")])])])],-1))]),Q[100]||(Q[100]=T(" is the reservoir equations differentiated with respect to the reservoir primary variables, i.e. the Jacobian from the previous section. ")),t("mjx-container",h1,[(e(),a("svg",p1,Q[93]||(Q[93]=[l("",1)]))),Q[94]||(Q[94]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")])])])],-1))]),Q[101]||(Q[101]=T(" is the well system differentiated with respect to the well primary variables. The cross terms, ")),t("mjx-container",g1,[(e(),a("svg",u1,Q[95]||(Q[95]=[l("",1)]))),Q[96]||(Q[96]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])])])],-1))]),Q[102]||(Q[102]=T("and ")),t("mjx-container",c1,[(e(),a("svg",H1,Q[97]||(Q[97]=[l("",1)]))),Q[98]||(Q[98]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])])])],-1))]),Q[103]||(Q[103]=T(", are the same equations differentiated with respect to the primary variables of the other system."))]),Q[143]||(Q[143]=t("p",null,[T("The well system is generally much smaller than the reservoir system and can be solved by a direct solver. We would like to reuse the block preconditioners defined for the base system. The approach we use is a "),t("a",{href:"https://en.wikipedia.org/wiki/Schur_complement",target:"_blank",rel:"noreferrer"},"Schur complement"),T(" approach to solve the full system. If we linearly eliminate the dependence of the reservoir equations on the well primary variables, we obtain the reduced system:")],-1)),t("mjx-container",w1,[(e(),a("svg",x1,Q[104]||(Q[104]=[l("",1)]))),Q[105]||(Q[105]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"J"),t("mi",{mathvariant:"normal"},"Δ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"r")])]),t("mo",null,"−"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])]),t("msubsup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])])]),t("mtd",null,[t("mn",null,"0")])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])])]),t("mtd",null,[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")])])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("mi",{mathvariant:"normal"},"Δ"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"r")])])]),t("mtr",null,[t("mtd",null,[t("mi",{mathvariant:"normal"},"Δ"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"w")])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("mtable",{columnspacing:"1em",rowspacing:"4pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"r")]),t("mo",null,"−"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])]),t("msubsup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"w")])])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"w")])])])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")])])],-1))]),Q[144]||(Q[144]=t("p",null,"We can then solve the system in terms of the reservoir degrees of freedom where the system is a block linear system and we already have a working preconditioner:",-1)),t("mjx-container",f1,[(e(),a("svg",y1,Q[106]||(Q[106]=[l("",1)]))),Q[107]||(Q[107]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"r")])]),t("mo",null,"−"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])]),t("msubsup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"r")]),t("mo",null,"="),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"r")]),t("mo",null,"−"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])]),t("msubsup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"w")])])],-1))]),t("p",null,[Q[112]||(Q[112]=T("Once that system is solved for ")),t("mjx-container",k1,[(e(),a("svg",L1,Q[108]||(Q[108]=[l("",1)]))),Q[109]||(Q[109]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"r")])])],-1))]),Q[113]||(Q[113]=T(", we can recover the well degrees of freedom ")),t("mjx-container",M1,[(e(),a("svg",V1,Q[110]||(Q[110]=[l("",1)]))),Q[111]||(Q[111]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"w")])])],-1))]),Q[114]||(Q[114]=T(" directly:"))]),t("mjx-container",b1,[(e(),a("svg",D1,Q[115]||(Q[115]=[l("",1)]))),Q[116]||(Q[116]=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"w")]),t("mo",null,"="),t("msubsup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"r")]),t("mi",null,"w")]),t("mo",null,"−"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mi",null,"r")]),t("mo",{stretchy:"false"},")")])],-1))]),t("div",Z1,[Q[129]||(Q[129]=t("p",{class:"custom-block-title"},"Efficiency of Schur complement",-1)),t("p",null,[Q[123]||(Q[123]=T("Explicitly forming the matrix ")),t("mjx-container",v1,[(e(),a("svg",j1,Q[117]||(Q[117]=[l("",1)]))),Q[118]||(Q[118]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"r")])]),t("mo",null,"−"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])]),t("msubsup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])])])],-1))]),Q[124]||(Q[124]=T(" will generally lead to a lot of fill-in in the linear system. JutulDarcy instead uses the action of ")),t("mjx-container",_1,[(e(),a("svg",R1,Q[119]||(Q[119]=[l("",1)]))),Q[120]||(Q[120]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"r")])]),t("mo",null,"−"),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"r"),t("mi",null,"w")])]),t("msubsup",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mn",null,"1")])]),t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"r")])])])],-1))]),Q[125]||(Q[125]=T(" as a linear operator from ")),Q[126]||(Q[126]=t("a",{href:"https://github.com/JuliaSmoothOptimizers/LinearOperators.jl",target:"_blank",rel:"noreferrer"},"LinearOperators.jl",-1)),Q[127]||(Q[127]=T(". This means that we must apply the inverse of the well system every time we need to compute the residual or action of the system matrix, but fortunately performing the action of the Schur complement is inexpensive as long as ")),t("mjx-container",A1,[(e(),a("svg",O1,Q[121]||(Q[121]=[l("",1)]))),Q[122]||(Q[122]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mi",null,"w")])])])],-1))]),Q[128]||(Q[128]=T(" is small and the factorization can be stored."))])])])}const F1=o(n,[["render",C1]]);export{X1 as __pageData,F1 as default};
