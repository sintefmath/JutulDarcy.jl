<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting started | JutulDarcy.jl</title>
    <meta name="description" content="Documentation for JutulDarcy.jl">
    <meta name="generator" content="VitePress v1.3.4">
    <link rel="preload stylesheet" href="/JutulDarcy.jl/previews/PR64/assets/style.CMCsGKbu.css" as="style">
    
    <script type="module" src="/JutulDarcy.jl/previews/PR64/assets/app.B5T-MNUY.js"></script>
    <link rel="preload" href="/JutulDarcy.jl/previews/PR64/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/JutulDarcy.jl/previews/PR64/assets/chunks/theme.IRC_EF4L.js">
    <link rel="modulepreload" href="/JutulDarcy.jl/previews/PR64/assets/chunks/framework.BxD0zY3W.js">
    <link rel="modulepreload" href="/JutulDarcy.jl/previews/PR64/assets/man_intro.md.DmRn2iRt.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-28a961f9><a class="title" href="/JutulDarcy.jl/previews/PR64/" data-v-28a961f9><!--[--><!--]--><!----><span data-v-28a961f9>JutulDarcy.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Introduction</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/index" data-v-8b74d055><!--[-->JutulDarcy.jl<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link active" href="/JutulDarcy.jl/previews/PR64/man/intro" data-v-8b74d055><!--[-->Getting started<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/extras/refs" data-v-8b74d055><!--[-->References<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/extras/faq" data-v-8b74d055><!--[-->FAQ<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/ref/jutul" data-v-8b74d055><!--[-->Jutul functions<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Manual</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/highlevel" data-v-8b74d055><!--[-->High-level API<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/input_files" data-v-8b74d055><!--[-->Input formats<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/forces" data-v-8b74d055><!--[-->Driving forces<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/systems" data-v-8b74d055><!--[-->Supported physical systems<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/wells" data-v-8b74d055><!--[-->Wells and controls<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/solution" data-v-8b74d055><!--[-->Solving the equations<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/primary" data-v-8b74d055><!--[-->Primary variables<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/secondary" data-v-8b74d055><!--[-->Secondary variables (properties)<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/parameters" data-v-8b74d055><!--[-->Parameters<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/basics/plotting" data-v-8b74d055><!--[-->Plotting and visualization<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Examples: Introduction</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Examples: Usage</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Examples: Validation</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Advanced usage</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/advanced/mpi" data-v-8b74d055><!--[-->Multi-threading and MPI support<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR64/man/advanced/compiled" data-v-8b74d055><!--[-->Standalone reservoir simulator<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/JutulDarcy.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e5380155><span class="vpi-more-horizontal icon" data-v-e5380155></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/JutulDarcy.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-bc9dc845><button data-v-bc9dc845>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Introduction</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/index" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>JutulDarcy.jl</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/intro" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Getting started</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/extras/refs" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>References</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/extras/faq" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>FAQ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/ref/jutul" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Jutul functions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Manual</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/highlevel" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>High-level API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/input_files" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Input formats</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/forces" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Driving forces</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/systems" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Supported physical systems</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/wells" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Wells and controls</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/solution" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Solving the equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/primary" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Primary variables</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/secondary" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Secondary variables (properties)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/parameters" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Parameters</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/basics/plotting" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Plotting and visualization</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><div class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><p class="text" data-v-196b2e5f>Examples: Introduction</p><!----></div><!----></div></div><div class="no-transition group" data-v-9e426adc><div class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><p class="text" data-v-196b2e5f>Examples: Usage</p><!----></div><!----></div></div><div class="no-transition group" data-v-9e426adc><div class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><p class="text" data-v-196b2e5f>Examples: Validation</p><!----></div><!----></div></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Advanced usage</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/advanced/mpi" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Multi-threading and MPI support</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR64/man/advanced/compiled" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Standalone reservoir simulator</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _JutulDarcy_jl_previews_PR64_man_intro" data-v-83890dd9><div><h1 id="Getting-started" tabindex="-1">Getting started <a class="header-anchor" href="#Getting-started" aria-label="Permalink to &quot;Getting started {#Getting-started}&quot;">​</a></h1><h2 id="Installing-JutulDarcy" tabindex="-1">Installing JutulDarcy <a class="header-anchor" href="#Installing-JutulDarcy" aria-label="Permalink to &quot;Installing JutulDarcy {#Installing-JutulDarcy}&quot;">​</a></h2><p>To get started with JutulDarcy, you must install <a href="https://julialang.org/" target="_blank" rel="noreferrer">the Julia programming language</a>. We recommend the latest stable release, but at least version 1.9 is required. Julia uses environments to manage packages. If you are not familiar with this concept, we recommend the <a href="https://pkgdocs.julialang.org/v1/environments/" target="_blank" rel="noreferrer">Pkg documentation</a>.</p><h3 id="Setting-up-an-environment" tabindex="-1">Setting up an environment <a class="header-anchor" href="#Setting-up-an-environment" aria-label="Permalink to &quot;Setting up an environment {#Setting-up-an-environment}&quot;">​</a></h3><p>To set up an environment you can create a folder and open Julia with that project as a runtime argument. The environment is persistent: If you start Julia in the same folder with the same project argument, the same packages will be installed. For this reason, it is sufficient to do this process once.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jutuldarcy_env</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jutuldarcy_env</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">julia</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project=.</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Pkg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;JutulDarcy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>You can then run any of the examples in the <a href="https://github.com/sintefmath/JutulDarcy.jl/tree/main/examples" target="_blank" rel="noreferrer"><code>examples</code></a> directory by including them. The examples are sorted by complexity. We suggest you start with <a href="Intro:%20Gravity%20segregation%20example" target="_blank" rel="noreferrer">Gravity segregation example</a>.</p><p>To generate a folder that contains the examples locally, you can run the following code to create a folder <code>jutuldarcy_examples</code> in your current working directory:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">generate_jutuldarcy_examples</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>Alternatively, a folder can be specified if you want the examples to be placed outside your present working directory:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">generate_jutuldarcy_examples</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/home/username/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="Adding-additional-packages" tabindex="-1">Adding additional packages <a class="header-anchor" href="#Adding-additional-packages" aria-label="Permalink to &quot;Adding additional packages {#Adding-additional-packages}&quot;">​</a></h3><p>We also rely heavily on the Jutul base package for some functionality, so we recommend that you also install it together with JutulDarcy:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Jutul&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>If you want the plotting used in the examples, you need this:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GLMakie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3D and interactive visualization</span></span></code></pre></div><p>Some examples and functionaltiy also make use of additional packages:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Optim&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optimization library</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HYPRE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Better linear solver</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GeoEnergyIO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Parsing input files</span></span></code></pre></div><h2 id="A-short-motivational-example-with-two-wells" tabindex="-1">A short motivational example with two wells <a class="header-anchor" href="#A-short-motivational-example-with-two-wells" aria-label="Permalink to &quot;A short motivational example with two wells {#A-short-motivational-example-with-two-wells}&quot;">​</a></h2><p>After a bit of time has passed compiling the packages, you are now ready to use JutulDarcy. There are a number of examples included in this manual, but we include a brief example here that briefly demonstrates the key concepts.</p><h3 id="Setting-up-the-domain" tabindex="-1">Setting up the domain <a class="header-anchor" href="#Setting-up-the-domain" aria-label="Permalink to &quot;Setting up the domain {#Setting-up-the-domain}&quot;">​</a></h3><p>We set up a simple Cartesian Mesh that is converted into a reservoir domain with permeability and porosity values. We then use this domain to set up two wells: One vertical well for injection and a single perforation producer:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy, Jutul</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Darcy, bar, kg, meter, day </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_units</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:darcy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:kilogram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:meter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ny </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cart_dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">physical_dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CartesianMesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cart_dims, physical_dims)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(g, permeability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Darcy, porosity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Injector </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_vertical_well</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Producer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_well</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, (nx, ny, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Show the properties in the domain</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domain</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DataDomain wrapping CartesianMesh (3D) with 25x25x10=6250 cells with 17 data fields added:</span></span>
<span class="line"><span>  6250 Cells</span></span>
<span class="line"><span>    :permeability =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :porosity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :fluid_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_density =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :cell_centroids =&gt; 3×6250 Matrix{Float64}</span></span>
<span class="line"><span>    :volumes =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>  17625 Faces</span></span>
<span class="line"><span>    :neighbors =&gt; 2×17625 Matrix{Int64}</span></span>
<span class="line"><span>    :areas =&gt; 17625 Vector{Float64}</span></span>
<span class="line"><span>    :normals =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>    :face_centroids =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>  35250 HalfFaces</span></span>
<span class="line"><span>    :half_face_cells =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>    :half_face_faces =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>  2250 BoundaryFaces</span></span>
<span class="line"><span>    :boundary_areas =&gt; 2250 Vector{Float64}</span></span>
<span class="line"><span>    :boundary_centroids =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_normals =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_neighbors =&gt; 2250 Vector{Int64}</span></span></code></pre></div><h3 id="Setting-up-a-fluid-system" tabindex="-1">Setting up a fluid system <a class="header-anchor" href="#Setting-up-a-fluid-system" aria-label="Permalink to &quot;Setting up a fluid system {#Setting-up-a-fluid-system}&quot;">​</a></h3><p>We select a two-phase immicible system by declaring that the liquid and vapor phases are present in the model. These are assumed to have fixed densitys of 1000 and 100 kilograms per meters cubed at some reference pressure and temperature conditions.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phases </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LiquidPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VaporPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoLS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoGS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">reference_densities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [rhoLS, rhoGS]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ImmiscibleSystem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phases, reference_densities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reference_densities)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ImmiscibleSystem with LiquidPhase, VaporPhase</span></span></code></pre></div><h3 id="Setting-up-the-model" tabindex="-1">Setting up the model <a class="header-anchor" href="#Setting-up-the-model" aria-label="Permalink to &quot;Setting up the model {#Setting-up-the-model}&quot;">​</a></h3><p>We now have everything we need to set up a model. We call the setup function and get out the model together with the parameters - numerical input values that are static throughout the simulation. These are automatically computed from the domain&#39;s geometry, permeability and porosity.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, sys, wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Injector, Producer])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MultiModel with 4 models and 6 cross-terms. 12539 equations, 12539 degrees of freedom and 54061 parameters.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  models:</span></span>
<span class="line"><span>    1) Reservoir (12500x12500)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MinimalTPFATopology (6250 cells, 17625 faces)</span></span>
<span class="line"><span>    2) Injector (32x32)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MultiSegmentWell [Injector] (11 nodes, 10 segments, 10 perforations)</span></span>
<span class="line"><span>    3) Producer (5x5)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MultiSegmentWell [Producer] (2 nodes, 1 segments, 1 perforations)</span></span>
<span class="line"><span>    4) Facility (2x2)</span></span>
<span class="line"><span>       JutulDarcy.PredictionMode()</span></span>
<span class="line"><span>       ∈ WellGroup([:Injector, :Producer], true, true)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  cross_terms:</span></span>
<span class="line"><span>    1) Injector &lt;-&gt; Reservoir (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span>    2) Producer &lt;-&gt; Reservoir (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span>    3) Injector  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span>       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span>    4) Facility  -&gt; Injector (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span>    5) Producer  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span>       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span>    6) Facility  -&gt; Producer (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Model storage will be optimized for runtime performance.</span></span></code></pre></div><p>The model has a set of default secondary variables (properties) that are used to compute the flow equations. We can have a look at the reservoir model to see what the defaults are for the Darcy flow part of the domain:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SimulationModel:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Model with 12500 degrees of freedom, 12500 equations and 54000 parameters</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  domain:</span></span>
<span class="line"><span>    DiscretizedDomain with MinimalTPFATopology (6250 cells, 17625 faces) and discretizations for mass_flow, heat_flow</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  system:</span></span>
<span class="line"><span>    ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  context:</span></span>
<span class="line"><span>    DefaultContext(BlockMajorLayout(false), 1000, 1)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  formulation:</span></span>
<span class="line"><span>    FullyImplicitFormulation()</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  data_domain:</span></span>
<span class="line"><span>    DataDomain wrapping CartesianMesh (3D) with 25x25x10=6250 cells with 17 data fields added:</span></span>
<span class="line"><span>  6250 Cells</span></span>
<span class="line"><span>    :permeability =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :porosity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :fluid_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_density =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :cell_centroids =&gt; 3×6250 Matrix{Float64}</span></span>
<span class="line"><span>    :volumes =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>  17625 Faces</span></span>
<span class="line"><span>    :neighbors =&gt; 2×17625 Matrix{Int64}</span></span>
<span class="line"><span>    :areas =&gt; 17625 Vector{Float64}</span></span>
<span class="line"><span>    :normals =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>    :face_centroids =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>  35250 HalfFaces</span></span>
<span class="line"><span>    :half_face_cells =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>    :half_face_faces =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>  2250 BoundaryFaces</span></span>
<span class="line"><span>    :boundary_areas =&gt; 2250 Vector{Float64}</span></span>
<span class="line"><span>    :boundary_centroids =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_normals =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_neighbors =&gt; 2250 Vector{Int64}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  primary_variables:</span></span>
<span class="line"><span>   1) Pressure    ∈ 6250 Cells: 1 dof each</span></span>
<span class="line"><span>   2) Saturations ∈ 6250 Cells: 1 dof, 2 values each</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  secondary_variables:</span></span>
<span class="line"><span>   1) PhaseMassDensities     ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; ConstantCompressibilityDensities as evaluator</span></span>
<span class="line"><span>   2) TotalMasses            ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; TotalMasses as evaluator</span></span>
<span class="line"><span>   3) RelativePermeabilities ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; BrooksCoreyRelativePermeabilities as evaluator</span></span>
<span class="line"><span>   4) PhaseMobilities        ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; JutulDarcy.PhaseMobilities as evaluator</span></span>
<span class="line"><span>   5) PhaseMassMobilities    ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; JutulDarcy.PhaseMassMobilities as evaluator</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  parameters:</span></span>
<span class="line"><span>   1) Transmissibilities        ∈ 17625 Faces: Scalar</span></span>
<span class="line"><span>   2) TwoPointGravityDifference ∈ 17625 Faces: Scalar</span></span>
<span class="line"><span>   3) PhaseViscosities          ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>   4) FluidVolume               ∈ 6250 Cells: Scalar</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  equations:</span></span>
<span class="line"><span>   1) mass_conservation ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; ConservationLaw{:TotalMasses, TwoPointPotentialFlowHardCoded{Vector{Int64}, Vector{@NamedTuple{self::Int64, other::Int64, face::Int64, face_sign::Int64}}}, Jutul.DefaultFlux, 2}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  output_variables:</span></span>
<span class="line"><span>    Pressure, Saturations, TotalMasses</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  extra:</span></span>
<span class="line"><span>    OrderedCollections.OrderedDict{Symbol, Any} with keys: Symbol[]</span></span></code></pre></div><p>The secondary variables can be swapped out, replaced and new variables can be added with arbitrary functional dependencies thanks to Jutul&#39;s flexible setup for automatic differentiation. Let us adjust the defaults by replacing the relative permeabilities with Brooks-Corey functions and the phase density functions by constant compressibilities:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ConstantCompressibilityDensities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    p_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    density_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reference_densities,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compressibility </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BrooksCoreyRelativePermeabilities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sys, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">replace_variables!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, PhaseMassDensities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> density, PhaseRelativePermeability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kr)</span></span></code></pre></div><h3 id="Initial-state" tabindex="-1">Initial state <a class="header-anchor" href="#Initial-state" aria-label="Permalink to &quot;Initial state {#Initial-state}&quot;">​</a></h3><p>Now that we are happy with our model setup, we can designate an initial state. For simplicity, we set up a constant pressure reservoir filled with the liquid phase.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Pressure </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Saturations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Dict{Any, Any} with 4 entries:</span></span>
<span class="line"><span>  :Producer  =&gt; Dict{Symbol, Any}(:TotalMassFlux=&gt;[0.0], :PhaseMassDensities=&gt;[…</span></span>
<span class="line"><span>  :Injector  =&gt; Dict{Symbol, Any}(:TotalMassFlux=&gt;[0.0, 0.0, 0.0, 0.0, 0.0, 0.0…</span></span>
<span class="line"><span>  :Reservoir =&gt; Dict{Symbol, Any}(:PhaseMassMobilities=&gt;[0.0 0.0 … 0.0 0.0; 0.0…</span></span>
<span class="line"><span>  :Facility  =&gt; Dict{Symbol, Any}(:TotalSurfaceMassRate=&gt;[0.0, 0.0], :WellGroup…</span></span></code></pre></div><h3 id="Setting-up-timesteps-and-well-controls" tabindex="-1">Setting up timesteps and well controls <a class="header-anchor" href="#Setting-up-timesteps-and-well-controls" aria-label="Permalink to &quot;Setting up timesteps and well controls {#Setting-up-timesteps-and-well-controls}&quot;">​</a></h3><p>We set up reporting timesteps. These are the intervals that the simulator gives out outputs. The simulator may use shorter steps internally, but will always hit these points in the output.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nstep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">365.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, nstep)</span></span></code></pre></div><p>We next set up a rate target with a high amount of gas injected into the model. This is not fully realistic, but will give some nice and dramatic plots for our example later on.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pore_volume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, parameters)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inj_rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pv)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rate_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TotalRateTarget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(inj_rate)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>TotalRateTarget with value 0.0380517503805175 [m^3/s]</span></span></code></pre></div><p>The producer is set to operate at a fixed pressure:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bhp_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BottomHolePressureTarget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BottomHolePressureTarget with value 100.0 [bar]</span></span></code></pre></div><p>We can finally set up forces for the model. Note that while JutulDarcy supports time-dependent forces and limits for the wells, we keep this example as simple as possible.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> InjectorControl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rate_target, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rhoGS)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ProducerControl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bhp_target)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">controls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> I_ctrl, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> P_ctrl)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_forces</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, control </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> controls)</span></span></code></pre></div><h3 id="Simulate-and-analyze-results" tabindex="-1">Simulate and analyze results <a class="header-anchor" href="#Simulate-and-analyze-results" aria-label="Permalink to &quot;Simulate and analyze results {#Simulate-and-analyze-results}&quot;">​</a></h3><p>We call the simulation with our initial state, our model, the timesteps, the forces and the parameters:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wd, states, t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state0, model, dt, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters, forces </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> forces)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ReservoirSimResult with 25 entries:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  wells (2 present):</span></span>
<span class="line"><span>    :Producer</span></span>
<span class="line"><span>    :Injector</span></span>
<span class="line"><span>    Results per well:</span></span>
<span class="line"><span>       :Vapor_mass_rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :lrat =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :orat =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :control =&gt; Vector{Symbol} of size (25,)</span></span>
<span class="line"><span>       :bhp =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :Liquid_mass_rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :mass_rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :grat =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  states (Vector with 25 entries, reservoir variables for each state)</span></span>
<span class="line"><span>    :Saturations =&gt; Matrix{Float64} of size (2, 6250)</span></span>
<span class="line"><span>    :Pressure =&gt; Vector{Float64} of size (6250,)</span></span>
<span class="line"><span>    :TotalMasses =&gt; Matrix{Float64} of size (2, 6250)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  time (report time for each state)</span></span>
<span class="line"><span>     Vector{Float64} of length 25</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  result (extended states, reports)</span></span>
<span class="line"><span>     SimResult with 25 entries</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  extra</span></span>
<span class="line"><span>     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Completed at Sep. 27 2024 13:09 after 4 seconds, 981 milliseconds, 732.5 microseconds.</span></span></code></pre></div><p>We can interactively look at the well results in the command line:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Legend</span></span>
<span class="line"><span>┌──────────────────┬──────────────────────────────────────────┬──────┬─────────────────────────┐</span></span>
<span class="line"><span>│ Label            │ Description                              │ Unit │ Type of quantity        │</span></span>
<span class="line"><span>├──────────────────┼──────────────────────────────────────────┼──────┼─────────────────────────┤</span></span>
<span class="line"><span>│ Liquid_mass_rate │ Component mass rate for Liquid component │ kg/s │ mass                    │</span></span>
<span class="line"><span>│ Vapor_mass_rate  │ Component mass rate for Vapor component  │ kg/s │ mass                    │</span></span>
<span class="line"><span>│ bhp              │ Bottom hole pressure                     │ Pa   │ pressure                │</span></span>
<span class="line"><span>│ control          │ Control                                  │ -    │ none                    │</span></span>
<span class="line"><span>│ grat             │ Surface gas rate                         │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>│ lrat             │ Surface water rate                       │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>│ mass_rate        │ Total mass rate                          │ kg/s │ mass                    │</span></span>
<span class="line"><span>│ orat             │ Surface oil rate                         │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>│ rate             │ Surface total rate                       │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>└──────────────────┴──────────────────────────────────────────┴──────┴─────────────────────────┘</span></span>
<span class="line"><span>Producer result</span></span>
<span class="line"><span>┌────────┬──────────────────┬─────────────────┬───────┬─────────┬──────────────┬─────────────┬───────────┬─────────────┬────────────┐</span></span>
<span class="line"><span>│   time │ Liquid_mass_rate │ Vapor_mass_rate │   bhp │ control │         grat │        lrat │ mass_rate │        orat │       rate │</span></span>
<span class="line"><span>│   days │             kg/s │            kg/s │    Pa │       - │         m³/s │        m³/s │      kg/s │        m³/s │       m³/s │</span></span>
<span class="line"><span>├────────┼──────────────────┼─────────────────┼───────┼─────────┼──────────────┼─────────────┼───────────┼─────────────┼────────────┤</span></span>
<span class="line"><span>│  365.0 │         -37.5298 │    -6.15983e-11 │ 1.0e7 │     bhp │ -6.15983e-13 │  -0.0375298 │  -37.5298 │  -0.0375298 │ -0.0375298 │</span></span>
<span class="line"><span>│  730.0 │           -37.54 │     -1.70126e-7 │ 1.0e7 │     bhp │  -1.70126e-9 │    -0.03754 │    -37.54 │    -0.03754 │   -0.03754 │</span></span>
<span class="line"><span>│ 1095.0 │          -37.546 │     -1.57709e-5 │ 1.0e7 │     bhp │  -1.57709e-7 │   -0.037546 │   -37.546 │   -0.037546 │ -0.0375461 │</span></span>
<span class="line"><span>│ 1460.0 │         -37.5462 │    -0.000447478 │ 1.0e7 │     bhp │  -4.47478e-6 │  -0.0375462 │  -37.5467 │  -0.0375462 │ -0.0375507 │</span></span>
<span class="line"><span>│ 1825.0 │         -37.4968 │     -0.00584677 │ 1.0e7 │     bhp │  -5.84677e-5 │  -0.0374968 │  -37.5027 │  -0.0374968 │ -0.0375553 │</span></span>
<span class="line"><span>│ 2190.0 │         -37.1362 │      -0.0427133 │ 1.0e7 │     bhp │ -0.000427133 │  -0.0371362 │  -37.1789 │  -0.0371362 │ -0.0375633 │</span></span>
<span class="line"><span>│ 2555.0 │         -35.7874 │       -0.179585 │ 1.0e7 │     bhp │  -0.00179585 │  -0.0357874 │   -35.967 │  -0.0357874 │ -0.0375832 │</span></span>
<span class="line"><span>│ 2920.0 │         -33.6322 │       -0.397921 │ 1.0e7 │     bhp │  -0.00397921 │  -0.0336322 │  -34.0302 │  -0.0336322 │ -0.0376115 │</span></span>
<span class="line"><span>│ 3285.0 │         -31.3147 │       -0.632755 │ 1.0e7 │     bhp │  -0.00632755 │  -0.0313147 │  -31.9475 │  -0.0313147 │ -0.0376423 │</span></span>
<span class="line"><span>│ 3650.0 │          -28.671 │       -0.900604 │ 1.0e7 │     bhp │  -0.00900604 │   -0.028671 │  -29.5716 │   -0.028671 │  -0.037677 │</span></span>
<span class="line"><span>│ 4015.0 │         -26.1742 │        -1.15363 │ 1.0e7 │     bhp │   -0.0115363 │  -0.0261742 │  -27.3278 │  -0.0261742 │ -0.0377105 │</span></span>
<span class="line"><span>│ 4380.0 │         -23.9533 │        -1.37871 │ 1.0e7 │     bhp │   -0.0137871 │  -0.0239533 │   -25.332 │  -0.0239533 │ -0.0377404 │</span></span>
<span class="line"><span>│ 4745.0 │         -21.7195 │        -1.60523 │ 1.0e7 │     bhp │   -0.0160523 │  -0.0217195 │  -23.3248 │  -0.0217195 │ -0.0377719 │</span></span>
<span class="line"><span>│ 5110.0 │         -19.8918 │        -1.79041 │ 1.0e7 │     bhp │   -0.0179041 │  -0.0198918 │  -21.6822 │  -0.0198918 │ -0.0377959 │</span></span>
<span class="line"><span>│ 5475.0 │         -18.0078 │        -1.98147 │ 1.0e7 │     bhp │   -0.0198147 │  -0.0180078 │  -19.9892 │  -0.0180078 │ -0.0378224 │</span></span>
<span class="line"><span>│ 5840.0 │         -16.5058 │        -2.13347 │ 1.0e7 │     bhp │   -0.0213347 │  -0.0165058 │  -18.6393 │  -0.0165058 │ -0.0378405 │</span></span>
<span class="line"><span>│ 6205.0 │         -14.9698 │        -2.28936 │ 1.0e7 │     bhp │   -0.0228936 │  -0.0149698 │  -17.2591 │  -0.0149698 │ -0.0378634 │</span></span>
<span class="line"><span>│ 6570.0 │         -13.5928 │        -2.42889 │ 1.0e7 │     bhp │   -0.0242889 │  -0.0135928 │  -16.0217 │  -0.0135928 │ -0.0378817 │</span></span>
<span class="line"><span>│ 6935.0 │         -12.5212 │        -2.53735 │ 1.0e7 │     bhp │   -0.0253735 │  -0.0125212 │  -15.0585 │  -0.0125212 │ -0.0378947 │</span></span>
<span class="line"><span>│ 7300.0 │         -11.2552 │         -2.6659 │ 1.0e7 │     bhp │    -0.026659 │  -0.0112552 │  -13.9211 │  -0.0112552 │ -0.0379142 │</span></span>
<span class="line"><span>│ 7665.0 │         -10.1449 │        -2.77831 │ 1.0e7 │     bhp │   -0.0277831 │  -0.0101449 │  -12.9232 │  -0.0101449 │  -0.037928 │</span></span>
<span class="line"><span>│ 8030.0 │         -9.35084 │        -2.85862 │ 1.0e7 │     bhp │   -0.0285862 │ -0.00935084 │  -12.2095 │ -0.00935084 │  -0.037937 │</span></span>
<span class="line"><span>│ 8395.0 │         -8.50823 │         -2.9441 │ 1.0e7 │     bhp │    -0.029441 │ -0.00850823 │  -11.4523 │ -0.00850823 │ -0.0379492 │</span></span>
<span class="line"><span>│ 8760.0 │         -7.49082 │         -3.0474 │ 1.0e7 │     bhp │    -0.030474 │ -0.00749082 │  -10.5382 │ -0.00749082 │ -0.0379649 │</span></span>
<span class="line"><span>│ 9125.0 │         -6.67556 │        -3.12984 │ 1.0e7 │     bhp │   -0.0312984 │ -0.00667556 │   -9.8054 │ -0.00667556 │  -0.037974 │</span></span>
<span class="line"><span>└────────┴──────────────────┴─────────────────┴───────┴─────────┴──────────────┴─────────────┴───────────┴─────────────┴────────────┘</span></span></code></pre></div><p>Let us look at the pressure evolution in the injector:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Legend</span></span>
<span class="line"><span>┌───────┬──────────────────────┬──────┬──────────────────┐</span></span>
<span class="line"><span>│ Label │ Description          │ Unit │ Type of quantity │</span></span>
<span class="line"><span>├───────┼──────────────────────┼──────┼──────────────────┤</span></span>
<span class="line"><span>│ bhp   │ Bottom hole pressure │ Pa   │ pressure         │</span></span>
<span class="line"><span>└───────┴──────────────────────┴──────┴──────────────────┘</span></span>
<span class="line"><span>Injector result</span></span>
<span class="line"><span>┌────────┬───────────┐</span></span>
<span class="line"><span>│   time │       bhp │</span></span>
<span class="line"><span>│   days │        Pa │</span></span>
<span class="line"><span>├────────┼───────────┤</span></span>
<span class="line"><span>│  365.0 │ 2.67555e7 │</span></span>
<span class="line"><span>│  730.0 │ 2.67591e7 │</span></span>
<span class="line"><span>│ 1095.0 │ 2.67613e7 │</span></span>
<span class="line"><span>│ 1460.0 │ 2.67628e7 │</span></span>
<span class="line"><span>│ 1825.0 │ 2.67642e7 │</span></span>
<span class="line"><span>│ 2190.0 │ 2.67657e7 │</span></span>
<span class="line"><span>│ 2555.0 │ 2.67681e7 │</span></span>
<span class="line"><span>│ 2920.0 │ 2.67703e7 │</span></span>
<span class="line"><span>│ 3285.0 │ 2.67708e7 │</span></span>
<span class="line"><span>│ 3650.0 │ 2.67677e7 │</span></span>
<span class="line"><span>│ 4015.0 │ 2.67636e7 │</span></span>
<span class="line"><span>│ 4380.0 │ 2.67565e7 │</span></span>
<span class="line"><span>│ 4745.0 │ 2.67457e7 │</span></span>
<span class="line"><span>│ 5110.0 │ 2.67345e7 │</span></span>
<span class="line"><span>│ 5475.0 │ 2.67214e7 │</span></span>
<span class="line"><span>│ 5840.0 │ 2.67096e7 │</span></span>
<span class="line"><span>│ 6205.0 │ 2.66965e7 │</span></span>
<span class="line"><span>│ 6570.0 │ 2.66825e7 │</span></span>
<span class="line"><span>│ 6935.0 │ 2.66701e7 │</span></span>
<span class="line"><span>│ 7300.0 │ 2.66552e7 │</span></span>
<span class="line"><span>│ 7665.0 │ 2.66406e7 │</span></span>
<span class="line"><span>│ 8030.0 │ 2.66293e7 │</span></span>
<span class="line"><span>│ 8395.0 │ 2.66164e7 │</span></span>
<span class="line"><span>│ 8760.0 │ 2.66007e7 │</span></span>
<span class="line"><span>│ 9125.0 │ 2.65863e7 │</span></span>
<span class="line"><span>└────────┴───────────┘</span></span></code></pre></div><p>If we have a plotting package available, we can visualize the results too:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:grat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lrat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:lrat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Injector&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time / days&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Bottom hole pressure / bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, bhp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Producer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time / days&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Production rate / m³/day&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(grat)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(lrat)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/JutulDarcy.jl/previews/PR64/assets/apbbmyq.Dl26K-DN.jpeg" alt=""></p><p>Interactive visualization of the 3D results is also possible if GLMakie is loaded:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, states, key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/JutulDarcy.jl/previews/PR64/assets/hobqghn.BYylZwtS.jpeg" alt=""></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/sintefmath/JutulDarcy.jl/edit/main/docs/src/man/intro.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/JutulDarcy.jl/previews/PR64/index" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>JutulDarcy.jl</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/JutulDarcy.jl/previews/PR64/extras/refs" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>References</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2024.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"extras_faq.md\":\"CzFqDwXD\",\"extras_refs.md\":\"bgA5GfaQ\",\"index.md\":\"CBnODGv-\",\"man_advanced_compiled.md\":\"BuDb0C4M\",\"man_advanced_mpi.md\":\"CvL6p8uf\",\"man_basics_forces.md\":\"DrSaQlUh\",\"man_basics_input_files.md\":\"BO2dxAAo\",\"man_basics_models.md\":\"BA0H4Rc8\",\"man_basics_parameters.md\":\"6ozlNEwk\",\"man_basics_plotting.md\":\"DcxyM8-o\",\"man_basics_primary.md\":\"XZROiNwv\",\"man_basics_secondary.md\":\"Cgp89t5S\",\"man_basics_solution.md\":\"C2s3VCqE\",\"man_basics_systems.md\":\"D5dAJR-1\",\"man_basics_wells.md\":\"BhIm78mY\",\"man_highlevel.md\":\"Bcbphfwn\",\"man_intro.md\":\"DmRn2iRt\",\"notebooks_empty.md\":\"C0Qm3TSv\",\"ref_jutul.md\":\"D7IXKzCE\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"JutulDarcy.jl\",\"description\":\"Documentation for JutulDarcy.jl\",\"base\":\"/JutulDarcy.jl/previews/PR64/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"JutulDarcy.jl\",\"link\":\"/index\"},{\"text\":\"Getting started\",\"link\":\"/man/intro\"},{\"text\":\"References\",\"link\":\"/extras/refs\"},{\"text\":\"FAQ\",\"link\":\"/extras/faq\"},{\"text\":\"Jutul functions\",\"link\":\"/ref/jutul\"}]},{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"High-level API\",\"link\":\"/man/highlevel\"},{\"text\":\"Input formats\",\"link\":\"/man/basics/input_files\"},{\"text\":\"Driving forces\",\"link\":\"/man/basics/forces\"},{\"text\":\"Supported physical systems\",\"link\":\"/man/basics/systems\"},{\"text\":\"Wells and controls\",\"link\":\"/man/basics/wells\"},{\"text\":\"Solving the equations\",\"link\":\"/man/basics/solution\"},{\"text\":\"Primary variables\",\"link\":\"/man/basics/primary\"},{\"text\":\"Secondary variables (properties)\",\"link\":\"/man/basics/secondary\"},{\"text\":\"Parameters\",\"link\":\"/man/basics/parameters\"},{\"text\":\"Plotting and visualization\",\"link\":\"/man/basics/plotting\"}]},{\"text\":\"Examples: Introduction\",\"collapsed\":false,\"items\":[]},{\"text\":\"Examples: Usage\",\"collapsed\":false,\"items\":[]},{\"text\":\"Examples: Validation\",\"collapsed\":false,\"items\":[]},{\"text\":\"Advanced usage\",\"collapsed\":false,\"items\":[{\"text\":\"Multi-threading and MPI support\",\"link\":\"/man/advanced/mpi\"},{\"text\":\"Standalone reservoir simulator\",\"link\":\"/man/advanced/compiled\"}]}],\"sidebar\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"JutulDarcy.jl\",\"link\":\"/index\"},{\"text\":\"Getting started\",\"link\":\"/man/intro\"},{\"text\":\"References\",\"link\":\"/extras/refs\"},{\"text\":\"FAQ\",\"link\":\"/extras/faq\"},{\"text\":\"Jutul functions\",\"link\":\"/ref/jutul\"}]},{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"High-level API\",\"link\":\"/man/highlevel\"},{\"text\":\"Input formats\",\"link\":\"/man/basics/input_files\"},{\"text\":\"Driving forces\",\"link\":\"/man/basics/forces\"},{\"text\":\"Supported physical systems\",\"link\":\"/man/basics/systems\"},{\"text\":\"Wells and controls\",\"link\":\"/man/basics/wells\"},{\"text\":\"Solving the equations\",\"link\":\"/man/basics/solution\"},{\"text\":\"Primary variables\",\"link\":\"/man/basics/primary\"},{\"text\":\"Secondary variables (properties)\",\"link\":\"/man/basics/secondary\"},{\"text\":\"Parameters\",\"link\":\"/man/basics/parameters\"},{\"text\":\"Plotting and visualization\",\"link\":\"/man/basics/plotting\"}]},{\"text\":\"Examples: Introduction\",\"collapsed\":false,\"items\":[]},{\"text\":\"Examples: Usage\",\"collapsed\":false,\"items\":[]},{\"text\":\"Examples: Validation\",\"collapsed\":false,\"items\":[]},{\"text\":\"Advanced usage\",\"collapsed\":false,\"items\":[{\"text\":\"Multi-threading and MPI support\",\"link\":\"/man/advanced/mpi\"},{\"text\":\"Standalone reservoir simulator\",\"link\":\"/man/advanced/compiled\"}]}],\"editLink\":{\"pattern\":\"https://https://github.com/sintefmath/JutulDarcy.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/sintefmath/JutulDarcy.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2024.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>