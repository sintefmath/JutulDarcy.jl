import{_ as a,c as i,a5 as n,o as e}from"./chunks/framework.BXe-E8nS.js";const p="/JutulDarcy.jl/previews/PR59/assets/ywszrqq.B6EjWPp1.jpeg",t="/JutulDarcy.jl/previews/PR59/assets/uqaqxjn.DznocIxM.jpeg",E=JSON.parse('{"title":"Getting started","description":"","frontmatter":{},"headers":[],"relativePath":"man/intro.md","filePath":"man/intro.md","lastUpdated":null}'),l={name:"man/intro.md"};function h(k,s,r,d,o,c){return e(),i("div",null,s[0]||(s[0]=[n(`<h1 id="Getting-started" tabindex="-1">Getting started <a class="header-anchor" href="#Getting-started" aria-label="Permalink to &quot;Getting started {#Getting-started}&quot;">​</a></h1><h2 id="Installing-JutulDarcy" tabindex="-1">Installing JutulDarcy <a class="header-anchor" href="#Installing-JutulDarcy" aria-label="Permalink to &quot;Installing JutulDarcy {#Installing-JutulDarcy}&quot;">​</a></h2><p>To get started with JutulDarcy, you must install <a href="https://julialang.org/" target="_blank" rel="noreferrer">the Julia programming language</a>. We recommend the latest stable release, but at least version 1.9 is required. Julia uses environments to manage packages. If you are not familiar with this concept, we recommend the <a href="https://pkgdocs.julialang.org/v1/environments/" target="_blank" rel="noreferrer">Pkg documentation</a>.</p><h3 id="Setting-up-an-environment" tabindex="-1">Setting up an environment <a class="header-anchor" href="#Setting-up-an-environment" aria-label="Permalink to &quot;Setting up an environment {#Setting-up-an-environment}&quot;">​</a></h3><p>To set up an environment you can create a folder and open Julia with that project as a runtime argument. The environment is persistent: If you start Julia in the same folder with the same project argument, the same packages will be installed. For this reason, it is sufficient to do this process once.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jutuldarcy_env</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jutuldarcy_env</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">julia</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project=.</span></span></code></pre></div><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Pkg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;JutulDarcy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>You can then run any of the examples in the <a href="https://github.com/sintefmath/JutulDarcy.jl/tree/main/examples" target="_blank" rel="noreferrer"><code>examples</code></a> directory by including them. The examples are sorted by complexity. We suggest you start with <a href="Intro:%20Gravity%20segregation%20example" target="_blank" rel="noreferrer">Gravity segregation example</a>.</p><p>To generate a folder that contains the examples locally, you can run the following code to create a folder <code>jutuldarcy_examples</code> in your current working directory:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">generate_jutuldarcy_examples</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>Alternatively, a folder can be specified if you want the examples to be placed outside your present working directory:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">generate_jutuldarcy_examples</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/home/username/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="Adding-additional-packages" tabindex="-1">Adding additional packages <a class="header-anchor" href="#Adding-additional-packages" aria-label="Permalink to &quot;Adding additional packages {#Adding-additional-packages}&quot;">​</a></h3><p>We also rely heavily on the Jutul base package for some functionality, so we recommend that you also install it together with JutulDarcy:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Jutul&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>If you want the plotting used in the examples, you need this:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GLMakie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3D and interactive visualization</span></span></code></pre></div><p>Some examples and functionaltiy also make use of additional packages:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Optim&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optimization library</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HYPRE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Better linear solver</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GeoEnergyIO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Parsing input files</span></span></code></pre></div><h2 id="A-short-motivational-example-with-two-wells" tabindex="-1">A short motivational example with two wells <a class="header-anchor" href="#A-short-motivational-example-with-two-wells" aria-label="Permalink to &quot;A short motivational example with two wells {#A-short-motivational-example-with-two-wells}&quot;">​</a></h2><p>After a bit of time has passed compiling the packages, you are now ready to use JutulDarcy. There are a number of examples included in this manual, but we include a brief example here that briefly demonstrates the key concepts.</p><h3 id="Setting-up-the-domain" tabindex="-1">Setting up the domain <a class="header-anchor" href="#Setting-up-the-domain" aria-label="Permalink to &quot;Setting up the domain {#Setting-up-the-domain}&quot;">​</a></h3><p>We set up a simple Cartesian Mesh that is converted into a reservoir domain with permeability and porosity values. We then use this domain to set up two wells: One vertical well for injection and a single perforation producer:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy, Jutul</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Darcy, bar, kg, meter, day </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_units</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:darcy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:kilogram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:meter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ny </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cart_dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">physical_dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CartesianMesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cart_dims, physical_dims)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(g, permeability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Darcy, porosity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Injector </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_vertical_well</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Producer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_well</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, (nx, ny, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Show the properties in the domain</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domain</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DataDomain wrapping CartesianMesh (3D) with 25x25x10=6250 cells with 17 data fields added:</span></span>
<span class="line"><span>  6250 Cells</span></span>
<span class="line"><span>    :permeability =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :porosity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :fluid_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_density =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :cell_centroids =&gt; 3×6250 Matrix{Float64}</span></span>
<span class="line"><span>    :volumes =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>  17625 Faces</span></span>
<span class="line"><span>    :neighbors =&gt; 2×17625 Matrix{Int64}</span></span>
<span class="line"><span>    :areas =&gt; 17625 Vector{Float64}</span></span>
<span class="line"><span>    :normals =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>    :face_centroids =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>  35250 HalfFaces</span></span>
<span class="line"><span>    :half_face_cells =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>    :half_face_faces =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>  2250 BoundaryFaces</span></span>
<span class="line"><span>    :boundary_areas =&gt; 2250 Vector{Float64}</span></span>
<span class="line"><span>    :boundary_centroids =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_normals =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_neighbors =&gt; 2250 Vector{Int64}</span></span></code></pre></div><h3 id="Setting-up-a-fluid-system" tabindex="-1">Setting up a fluid system <a class="header-anchor" href="#Setting-up-a-fluid-system" aria-label="Permalink to &quot;Setting up a fluid system {#Setting-up-a-fluid-system}&quot;">​</a></h3><p>We select a two-phase immicible system by declaring that the liquid and vapor phases are present in the model. These are assumed to have fixed densitys of 1000 and 100 kilograms per meters cubed at some reference pressure and temperature conditions.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phases </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LiquidPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VaporPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoLS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoGS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">reference_densities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [rhoLS, rhoGS]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ImmiscibleSystem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phases, reference_densities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reference_densities)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ImmiscibleSystem with LiquidPhase, VaporPhase</span></span></code></pre></div><h3 id="Setting-up-the-model" tabindex="-1">Setting up the model <a class="header-anchor" href="#Setting-up-the-model" aria-label="Permalink to &quot;Setting up the model {#Setting-up-the-model}&quot;">​</a></h3><p>We now have everything we need to set up a model. We call the setup function and get out the model together with the parameters - numerical input values that are static throughout the simulation. These are automatically computed from the domain&#39;s geometry, permeability and porosity.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, sys, wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Injector, Producer])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MultiModel with 4 models and 6 cross-terms. 12539 equations, 12539 degrees of freedom and 54061 parameters.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  models:</span></span>
<span class="line"><span>    1) Reservoir (12500x12500)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MinimalTPFATopology (6250 cells, 17625 faces)</span></span>
<span class="line"><span>    2) Injector (32x32)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MultiSegmentWell [Injector] (11 nodes, 10 segments, 10 perforations)</span></span>
<span class="line"><span>    3) Producer (5x5)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MultiSegmentWell [Producer] (2 nodes, 1 segments, 1 perforations)</span></span>
<span class="line"><span>    4) Facility (2x2)</span></span>
<span class="line"><span>       JutulDarcy.PredictionMode()</span></span>
<span class="line"><span>       ∈ WellGroup([:Injector, :Producer], true, true)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  cross_terms:</span></span>
<span class="line"><span>    1) Injector &lt;-&gt; Reservoir (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span>    2) Producer &lt;-&gt; Reservoir (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span>    3) Injector  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span>       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span>    4) Facility  -&gt; Injector (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span>    5) Producer  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span>       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span>    6) Facility  -&gt; Producer (Eq: mass_conservation)</span></span>
<span class="line"><span>       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Model storage will be optimized for runtime performance.</span></span></code></pre></div><p>The model has a set of default secondary variables (properties) that are used to compute the flow equations. We can have a look at the reservoir model to see what the defaults are for the Darcy flow part of the domain:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SimulationModel:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Model with 12500 degrees of freedom, 12500 equations and 54000 parameters</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  domain:</span></span>
<span class="line"><span>    DiscretizedDomain with MinimalTPFATopology (6250 cells, 17625 faces) and discretizations for mass_flow, heat_flow</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  system:</span></span>
<span class="line"><span>    ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  context:</span></span>
<span class="line"><span>    DefaultContext(BlockMajorLayout(false), 1000, 1)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  formulation:</span></span>
<span class="line"><span>    FullyImplicitFormulation()</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  data_domain:</span></span>
<span class="line"><span>    DataDomain wrapping CartesianMesh (3D) with 25x25x10=6250 cells with 17 data fields added:</span></span>
<span class="line"><span>  6250 Cells</span></span>
<span class="line"><span>    :permeability =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :porosity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :fluid_thermal_conductivity =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :rock_density =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>    :cell_centroids =&gt; 3×6250 Matrix{Float64}</span></span>
<span class="line"><span>    :volumes =&gt; 6250 Vector{Float64}</span></span>
<span class="line"><span>  17625 Faces</span></span>
<span class="line"><span>    :neighbors =&gt; 2×17625 Matrix{Int64}</span></span>
<span class="line"><span>    :areas =&gt; 17625 Vector{Float64}</span></span>
<span class="line"><span>    :normals =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>    :face_centroids =&gt; 3×17625 Matrix{Float64}</span></span>
<span class="line"><span>  35250 HalfFaces</span></span>
<span class="line"><span>    :half_face_cells =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>    :half_face_faces =&gt; 35250 Vector{Int64}</span></span>
<span class="line"><span>  2250 BoundaryFaces</span></span>
<span class="line"><span>    :boundary_areas =&gt; 2250 Vector{Float64}</span></span>
<span class="line"><span>    :boundary_centroids =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_normals =&gt; 3×2250 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_neighbors =&gt; 2250 Vector{Int64}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  primary_variables:</span></span>
<span class="line"><span>   1) Pressure    ∈ 6250 Cells: 1 dof each</span></span>
<span class="line"><span>   2) Saturations ∈ 6250 Cells: 1 dof, 2 values each</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  secondary_variables:</span></span>
<span class="line"><span>   1) PhaseMassDensities     ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; ConstantCompressibilityDensities as evaluator</span></span>
<span class="line"><span>   2) TotalMasses            ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; TotalMasses as evaluator</span></span>
<span class="line"><span>   3) RelativePermeabilities ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; BrooksCoreyRelativePermeabilities as evaluator</span></span>
<span class="line"><span>   4) PhaseMobilities        ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; JutulDarcy.PhaseMobilities as evaluator</span></span>
<span class="line"><span>   5) PhaseMassMobilities    ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; JutulDarcy.PhaseMassMobilities as evaluator</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  parameters:</span></span>
<span class="line"><span>   1) Transmissibilities        ∈ 17625 Faces: Scalar</span></span>
<span class="line"><span>   2) TwoPointGravityDifference ∈ 17625 Faces: Scalar</span></span>
<span class="line"><span>   3) PhaseViscosities          ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>   4) FluidVolume               ∈ 6250 Cells: Scalar</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  equations:</span></span>
<span class="line"><span>   1) mass_conservation ∈ 6250 Cells: 2 values each</span></span>
<span class="line"><span>      -&gt; ConservationLaw{:TotalMasses, TwoPointPotentialFlowHardCoded{Vector{Int64}, Vector{@NamedTuple{self::Int64, other::Int64, face::Int64, face_sign::Int64}}}, Jutul.DefaultFlux, 2}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  output_variables:</span></span>
<span class="line"><span>    Pressure, Saturations, TotalMasses</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  extra:</span></span>
<span class="line"><span>    OrderedCollections.OrderedDict{Symbol, Any} with keys: Symbol[]</span></span></code></pre></div><p>The secondary variables can be swapped out, replaced and new variables can be added with arbitrary functional dependencies thanks to Jutul&#39;s flexible setup for automatic differentiation. Let us adjust the defaults by replacing the relative permeabilities with Brooks-Corey functions and the phase density functions by constant compressibilities:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ConstantCompressibilityDensities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    p_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    density_ref </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reference_densities,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compressibility </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BrooksCoreyRelativePermeabilities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sys, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">replace_variables!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, PhaseMassDensities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> density, PhaseRelativePermeability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kr)</span></span></code></pre></div><h3 id="Initial-state" tabindex="-1">Initial state <a class="header-anchor" href="#Initial-state" aria-label="Permalink to &quot;Initial state {#Initial-state}&quot;">​</a></h3><p>Now that we are happy with our model setup, we can designate an initial state. For simplicity, we set up a constant pressure reservoir filled with the liquid phase.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Pressure </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Saturations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Dict{Any, Any} with 4 entries:</span></span>
<span class="line"><span>  :Producer  =&gt; Dict{Symbol, Any}(:TotalMassFlux=&gt;[0.0], :PhaseMassDensities=&gt;[…</span></span>
<span class="line"><span>  :Injector  =&gt; Dict{Symbol, Any}(:TotalMassFlux=&gt;[0.0, 0.0, 0.0, 0.0, 0.0, 0.0…</span></span>
<span class="line"><span>  :Reservoir =&gt; Dict{Symbol, Any}(:PhaseMassMobilities=&gt;[0.0 0.0 … 0.0 0.0; 0.0…</span></span>
<span class="line"><span>  :Facility  =&gt; Dict{Symbol, Any}(:TotalSurfaceMassRate=&gt;[0.0, 0.0], :WellGroup…</span></span></code></pre></div><h3 id="Setting-up-timesteps-and-well-controls" tabindex="-1">Setting up timesteps and well controls <a class="header-anchor" href="#Setting-up-timesteps-and-well-controls" aria-label="Permalink to &quot;Setting up timesteps and well controls {#Setting-up-timesteps-and-well-controls}&quot;">​</a></h3><p>We set up reporting timesteps. These are the intervals that the simulator gives out outputs. The simulator may use shorter steps internally, but will always hit these points in the output.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nstep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">365.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, nstep)</span></span></code></pre></div><p>We next set up a rate target with a high amount of gas injected into the model. This is not fully realistic, but will give some nice and dramatic plots for our example later on.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pore_volume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, parameters)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inj_rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pv)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rate_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TotalRateTarget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(inj_rate)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>TotalRateTarget with value 0.0380517503805175 [m^3/s]</span></span></code></pre></div><p>The producer is set to operate at a fixed pressure:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bhp_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BottomHolePressureTarget</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BottomHolePressureTarget with value 100.0 [bar]</span></span></code></pre></div><p>We can finally set up forces for the model. Note that while JutulDarcy supports time-dependent forces and limits for the wells, we keep this example as simple as possible.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> InjectorControl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rate_target, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rhoGS)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P_ctrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ProducerControl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bhp_target)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">controls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> I_ctrl, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> P_ctrl)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_forces</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, control </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> controls)</span></span></code></pre></div><h3 id="Simulate-and-analyze-results" tabindex="-1">Simulate and analyze results <a class="header-anchor" href="#Simulate-and-analyze-results" aria-label="Permalink to &quot;Simulate and analyze results {#Simulate-and-analyze-results}&quot;">​</a></h3><p>We call the simulation with our initial state, our model, the timesteps, the forces and the parameters:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wd, states, t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state0, model, dt, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters, forces </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> forces)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ReservoirSimResult with 25 entries:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  wells (2 present):</span></span>
<span class="line"><span>    :Producer</span></span>
<span class="line"><span>    :Injector</span></span>
<span class="line"><span>    Results per well:</span></span>
<span class="line"><span>       :Vapor_mass_rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :lrat =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :orat =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :control =&gt; Vector{Symbol} of size (25,)</span></span>
<span class="line"><span>       :bhp =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :Liquid_mass_rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :mass_rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :rate =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span>       :grat =&gt; Vector{Float64} of size (25,)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  states (Vector with 25 entries, reservoir variables for each state)</span></span>
<span class="line"><span>    :Saturations =&gt; Matrix{Float64} of size (2, 6250)</span></span>
<span class="line"><span>    :Pressure =&gt; Vector{Float64} of size (6250,)</span></span>
<span class="line"><span>    :TotalMasses =&gt; Matrix{Float64} of size (2, 6250)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  time (report time for each state)</span></span>
<span class="line"><span>     Vector{Float64} of length 25</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  result (extended states, reports)</span></span>
<span class="line"><span>     SimResult with 25 entries</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  extra</span></span>
<span class="line"><span>     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Completed at Sep. 23 2024 21:09 after 4 seconds, 846 milliseconds, 515.3 microseconds.</span></span></code></pre></div><p>We can interactively look at the well results in the command line:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Legend</span></span>
<span class="line"><span>┌──────────────────┬──────────────────────────────────────────┬──────┬─────────────────────────┐</span></span>
<span class="line"><span>│ Label            │ Description                              │ Unit │ Type of quantity        │</span></span>
<span class="line"><span>├──────────────────┼──────────────────────────────────────────┼──────┼─────────────────────────┤</span></span>
<span class="line"><span>│ Liquid_mass_rate │ Component mass rate for Liquid component │ kg/s │ mass                    │</span></span>
<span class="line"><span>│ Vapor_mass_rate  │ Component mass rate for Vapor component  │ kg/s │ mass                    │</span></span>
<span class="line"><span>│ bhp              │ Bottom hole pressure                     │ Pa   │ pressure                │</span></span>
<span class="line"><span>│ control          │ Control                                  │ -    │ none                    │</span></span>
<span class="line"><span>│ grat             │ Surface gas rate                         │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>│ lrat             │ Surface water rate                       │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>│ mass_rate        │ Total mass rate                          │ kg/s │ mass                    │</span></span>
<span class="line"><span>│ orat             │ Surface oil rate                         │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>│ rate             │ Surface total rate                       │ m³/s │ surface_volume_per_time │</span></span>
<span class="line"><span>└──────────────────┴──────────────────────────────────────────┴──────┴─────────────────────────┘</span></span>
<span class="line"><span>Producer result</span></span>
<span class="line"><span>┌────────┬──────────────────┬─────────────────┬───────┬─────────┬──────────────┬─────────────┬───────────┬─────────────┬────────────┐</span></span>
<span class="line"><span>│   time │ Liquid_mass_rate │ Vapor_mass_rate │   bhp │ control │         grat │        lrat │ mass_rate │        orat │       rate │</span></span>
<span class="line"><span>│   days │             kg/s │            kg/s │    Pa │       - │         m³/s │        m³/s │      kg/s │        m³/s │       m³/s │</span></span>
<span class="line"><span>├────────┼──────────────────┼─────────────────┼───────┼─────────┼──────────────┼─────────────┼───────────┼─────────────┼────────────┤</span></span>
<span class="line"><span>│  365.0 │         -37.5295 │    -5.31934e-12 │ 1.0e7 │     bhp │ -5.31934e-14 │  -0.0375295 │  -37.5295 │  -0.0375295 │ -0.0375295 │</span></span>
<span class="line"><span>│  730.0 │         -37.5398 │      -1.8011e-8 │ 1.0e7 │     bhp │  -1.8011e-10 │  -0.0375398 │  -37.5398 │  -0.0375398 │ -0.0375398 │</span></span>
<span class="line"><span>│ 1095.0 │         -37.5463 │     -8.74826e-6 │ 1.0e7 │     bhp │  -8.74826e-8 │  -0.0375463 │  -37.5463 │  -0.0375463 │ -0.0375464 │</span></span>
<span class="line"><span>│ 1460.0 │         -37.5472 │    -0.000357476 │ 1.0e7 │     bhp │  -3.57476e-6 │  -0.0375472 │  -37.5475 │  -0.0375472 │ -0.0375508 │</span></span>
<span class="line"><span>│ 1825.0 │         -37.5023 │     -0.00529783 │ 1.0e7 │     bhp │  -5.29783e-5 │  -0.0375023 │  -37.5076 │  -0.0375023 │ -0.0375553 │</span></span>
<span class="line"><span>│ 2190.0 │          -37.084 │      -0.0480336 │ 1.0e7 │     bhp │ -0.000480336 │   -0.037084 │   -37.132 │   -0.037084 │ -0.0375643 │</span></span>
<span class="line"><span>│ 2555.0 │         -35.7654 │       -0.181791 │ 1.0e7 │     bhp │  -0.00181791 │  -0.0357654 │  -35.9472 │  -0.0357654 │ -0.0375833 │</span></span>
<span class="line"><span>│ 2920.0 │         -33.6296 │       -0.398191 │ 1.0e7 │     bhp │  -0.00398191 │  -0.0336296 │  -34.0278 │  -0.0336296 │ -0.0376115 │</span></span>
<span class="line"><span>│ 3285.0 │         -31.3232 │       -0.631901 │ 1.0e7 │     bhp │  -0.00631901 │  -0.0313232 │  -31.9551 │  -0.0313232 │ -0.0376422 │</span></span>
<span class="line"><span>│ 3650.0 │         -28.6794 │       -0.899759 │ 1.0e7 │     bhp │  -0.00899759 │  -0.0286794 │  -29.5791 │  -0.0286794 │  -0.037677 │</span></span>
<span class="line"><span>│ 4015.0 │         -26.1839 │        -1.15264 │ 1.0e7 │     bhp │   -0.0115264 │  -0.0261839 │  -27.3365 │  -0.0261839 │ -0.0377103 │</span></span>
<span class="line"><span>│ 4380.0 │         -23.9605 │        -1.37797 │ 1.0e7 │     bhp │   -0.0137797 │  -0.0239605 │  -25.3385 │  -0.0239605 │ -0.0377403 │</span></span>
<span class="line"><span>│ 4745.0 │         -21.7266 │        -1.60451 │ 1.0e7 │     bhp │   -0.0160451 │  -0.0217266 │  -23.3312 │  -0.0217266 │ -0.0377718 │</span></span>
<span class="line"><span>│ 5110.0 │         -19.8976 │        -1.78983 │ 1.0e7 │     bhp │   -0.0178983 │  -0.0198976 │  -21.6874 │  -0.0198976 │ -0.0377958 │</span></span>
<span class="line"><span>│ 5475.0 │         -18.0132 │        -1.98091 │ 1.0e7 │     bhp │   -0.0198091 │  -0.0180132 │  -19.9941 │  -0.0180132 │ -0.0378223 │</span></span>
<span class="line"><span>│ 5840.0 │           -16.51 │        -2.13304 │ 1.0e7 │     bhp │   -0.0213304 │    -0.01651 │  -18.6431 │    -0.01651 │ -0.0378404 │</span></span>
<span class="line"><span>│ 6205.0 │         -14.9744 │         -2.2889 │ 1.0e7 │     bhp │    -0.022889 │  -0.0149744 │  -17.2633 │  -0.0149744 │ -0.0378633 │</span></span>
<span class="line"><span>│ 6570.0 │          -13.596 │        -2.42856 │ 1.0e7 │     bhp │   -0.0242856 │   -0.013596 │  -16.0246 │   -0.013596 │ -0.0378816 │</span></span>
<span class="line"><span>│ 6935.0 │         -12.5244 │        -2.53702 │ 1.0e7 │     bhp │   -0.0253702 │  -0.0125244 │  -15.0614 │  -0.0125244 │ -0.0378946 │</span></span>
<span class="line"><span>│ 7300.0 │         -11.2587 │        -2.66554 │ 1.0e7 │     bhp │   -0.0266554 │  -0.0112587 │  -13.9243 │  -0.0112587 │ -0.0379142 │</span></span>
<span class="line"><span>│ 7665.0 │         -10.1473 │        -2.77806 │ 1.0e7 │     bhp │   -0.0277806 │  -0.0101473 │  -12.9254 │  -0.0101473 │  -0.037928 │</span></span>
<span class="line"><span>│ 8030.0 │         -9.35292 │        -2.85841 │ 1.0e7 │     bhp │   -0.0285841 │ -0.00935292 │  -12.2113 │ -0.00935292 │  -0.037937 │</span></span>
<span class="line"><span>│ 8395.0 │         -8.51068 │        -2.94384 │ 1.0e7 │     bhp │   -0.0294384 │ -0.00851068 │  -11.4545 │ -0.00851068 │ -0.0379491 │</span></span>
<span class="line"><span>│ 8760.0 │         -7.49353 │        -3.04713 │ 1.0e7 │     bhp │   -0.0304713 │ -0.00749353 │  -10.5407 │ -0.00749353 │ -0.0379648 │</span></span>
<span class="line"><span>│ 9125.0 │         -6.67723 │        -3.12968 │ 1.0e7 │     bhp │   -0.0312968 │ -0.00667723 │   -9.8069 │ -0.00667723 │  -0.037974 │</span></span>
<span class="line"><span>└────────┴──────────────────┴─────────────────┴───────┴─────────┴──────────────┴─────────────┴───────────┴─────────────┴────────────┘</span></span></code></pre></div><p>Let us look at the pressure evolution in the injector:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Legend</span></span>
<span class="line"><span>┌───────┬──────────────────────┬──────┬──────────────────┐</span></span>
<span class="line"><span>│ Label │ Description          │ Unit │ Type of quantity │</span></span>
<span class="line"><span>├───────┼──────────────────────┼──────┼──────────────────┤</span></span>
<span class="line"><span>│ bhp   │ Bottom hole pressure │ Pa   │ pressure         │</span></span>
<span class="line"><span>└───────┴──────────────────────┴──────┴──────────────────┘</span></span>
<span class="line"><span>Injector result</span></span>
<span class="line"><span>┌────────┬───────────┐</span></span>
<span class="line"><span>│   time │       bhp │</span></span>
<span class="line"><span>│   days │        Pa │</span></span>
<span class="line"><span>├────────┼───────────┤</span></span>
<span class="line"><span>│  365.0 │ 2.67554e7 │</span></span>
<span class="line"><span>│  730.0 │ 2.67591e7 │</span></span>
<span class="line"><span>│ 1095.0 │ 2.67613e7 │</span></span>
<span class="line"><span>│ 1460.0 │ 2.67628e7 │</span></span>
<span class="line"><span>│ 1825.0 │ 2.67642e7 │</span></span>
<span class="line"><span>│ 2190.0 │ 2.67659e7 │</span></span>
<span class="line"><span>│ 2555.0 │  2.6768e7 │</span></span>
<span class="line"><span>│ 2920.0 │ 2.67703e7 │</span></span>
<span class="line"><span>│ 3285.0 │ 2.67708e7 │</span></span>
<span class="line"><span>│ 3650.0 │ 2.67677e7 │</span></span>
<span class="line"><span>│ 4015.0 │ 2.67636e7 │</span></span>
<span class="line"><span>│ 4380.0 │ 2.67565e7 │</span></span>
<span class="line"><span>│ 4745.0 │ 2.67457e7 │</span></span>
<span class="line"><span>│ 5110.0 │ 2.67346e7 │</span></span>
<span class="line"><span>│ 5475.0 │ 2.67214e7 │</span></span>
<span class="line"><span>│ 5840.0 │ 2.67096e7 │</span></span>
<span class="line"><span>│ 6205.0 │ 2.66966e7 │</span></span>
<span class="line"><span>│ 6570.0 │ 2.66825e7 │</span></span>
<span class="line"><span>│ 6935.0 │ 2.66701e7 │</span></span>
<span class="line"><span>│ 7300.0 │ 2.66552e7 │</span></span>
<span class="line"><span>│ 7665.0 │ 2.66406e7 │</span></span>
<span class="line"><span>│ 8030.0 │ 2.66293e7 │</span></span>
<span class="line"><span>│ 8395.0 │ 2.66164e7 │</span></span>
<span class="line"><span>│ 8760.0 │ 2.66008e7 │</span></span>
<span class="line"><span>│ 9125.0 │ 2.65864e7 │</span></span>
<span class="line"><span>└────────┴───────────┘</span></span></code></pre></div><p>If we have a plotting package available, we can visualize the results too:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:grat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lrat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Producer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:lrat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Injector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bhp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Injector&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time / days&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Bottom hole pressure / bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, bhp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Producer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time / days&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Production rate / m³/day&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(grat)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(lrat)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+p+'" alt=""></p><p>Interactive visualization of the 3D results is also possible if GLMakie is loaded:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, states, key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="'+t+'" alt=""></p>',69)]))}const y=a(l,[["render",h]]);export{E as __pageData,y as default};
