import{_ as i,c as a,o as n,az as e}from"./chunks/framework.BEOxRSoE.js";const l="/JutulDarcy.jl/previews/PR98/assets/xfztgjm.CNkHmvwy.jpeg",t="/JutulDarcy.jl/previews/PR98/assets/lxqwyzd.Chx3SU9j.jpeg",p="/JutulDarcy.jl/previews/PR98/assets/ilskogg.BPHvhOpt.jpeg",h="/JutulDarcy.jl/previews/PR98/assets/qyqffbg.Bwu95sxL.jpeg",k="/JutulDarcy.jl/previews/PR98/assets/atykzhc.De57Wqf3.jpeg",r="/JutulDarcy.jl/previews/PR98/assets/wxdkmne.DtlrFMwI.jpeg",d="/JutulDarcy.jl/previews/PR98/assets/imhrlyo.B7kwbupt.jpeg",E="/JutulDarcy.jl/previews/PR98/assets/kvubwbl.9sGoH3Lf.jpeg",y="/JutulDarcy.jl/previews/PR98/assets/eyujfmn.5gilqrt7.jpeg",w=JSON.parse('{"title":"Aquifer thermal energy storage (ATES) validation","description":"","frontmatter":{},"headers":[],"relativePath":"examples/validation/validation_thermal.md","filePath":"examples/validation/validation_thermal.md","lastUpdated":null}'),g={name:"examples/validation/validation_thermal.md"};function o(F,s,u,c,m,C){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="Aquifer-thermal-energy-storage-(ATES)-validation" tabindex="-1">Aquifer thermal energy storage (ATES) validation <a class="header-anchor" href="#Aquifer-thermal-energy-storage-(ATES)-validation" aria-label="Permalink to &quot;Aquifer thermal energy storage (ATES) validation {#Aquifer-thermal-energy-storage-(ATES)-validation}&quot;">​</a></h1><p>This example validates JutulDarcy&#39;s thermal solver against results from a commercial simulator. The test case is a simple ATES model with a single pair of wells (hot / cold) where the cold well is used for pressure support with a mirrored injection rate. Towards the later part of the schedule, the cold well reinjects water that is a higher temperature than the background.</p><p>This case is completely specified in the <code>ATES_TEST.DATA</code> file which was provided by TNO. The model is a structured mesh with 472 500 active cells.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul, JutulDarcy, GeoEnergyIO, DelimitedFiles, HYPRE, GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">basepth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GeoEnergyIO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">test_input_file_path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ATES_TEST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parse_data_file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">joinpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(basepth, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ATES_TEST.DATA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wdata, wheader </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> readdlm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">joinpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(basepth, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wells.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;,&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, header </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cdata, cheader </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> readdlm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">joinpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(basepth, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cells.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;,&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, header </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">case </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_case_from_data_file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws, states, t_seconds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case, info_level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> Downloading artifact: ATES_TEST</span></span>
<span class="line"><span>\x1B[33;1mParser:\x1B[0m PROPS/VISCREF - Parser has only partial support. VISCREF may have missing or wrong entries.</span></span>
<span class="line"><span>┌ Warning: Did not find supported time kw in step 126: Keys were [&quot;WELOPEN&quot;].</span></span>
<span class="line"><span>└ @ JutulDarcy ~/work/JutulDarcy.jl/JutulDarcy.jl/src/input_simulation/data_input.jl:1674</span></span>
<span class="line"><span>\x1B[94;1msetup_reservoir_state:\x1B[0m Recieved primary variable Saturations, but this is not known to reservoir model.</span></span>
<span class="line"><span>\x1B[92;1mJutul:\x1B[0m Simulating 41 weeks, 5 days as 124 report steps</span></span>
<span class="line"><span>\x1B[34;1mStep   1/124:\x1B[0m Solving start to 2 days, Δt = 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep   2/124:\x1B[0m Solving 2 days to 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   3/124:\x1B[0m Solving 3 days to 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   4/124:\x1B[0m Solving 4 days to 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   5/124:\x1B[0m Solving 5 days to 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   6/124:\x1B[0m Solving 6 days to 1 week, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   7/124:\x1B[0m Solving 1 week to 1 week, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   8/124:\x1B[0m Solving 1 week, 1 day to 1 week, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   9/124:\x1B[0m Solving 1 week, 2 days to 1 week, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  10/124:\x1B[0m Solving 1 week, 3 days to 1 week, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  11/124:\x1B[0m Solving 1 week, 4 days to 1 week, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  12/124:\x1B[0m Solving 1 week, 5 days to 1 week, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  13/124:\x1B[0m Solving 1 week, 6 days to 2 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  14/124:\x1B[0m Solving 2 weeks to 2 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  15/124:\x1B[0m Solving 2 weeks, 1 day to 2 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  16/124:\x1B[0m Solving 2 weeks, 2 days to 2 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  17/124:\x1B[0m Solving 2 weeks, 3 days to 2 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  18/124:\x1B[0m Solving 2 weeks, 4 days to 2 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  19/124:\x1B[0m Solving 2 weeks, 5 days to 2 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  20/124:\x1B[0m Solving 2 weeks, 6 days to 3 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  21/124:\x1B[0m Solving 3 weeks to 3 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  22/124:\x1B[0m Solving 3 weeks, 1 day to 3 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  23/124:\x1B[0m Solving 3 weeks, 2 days to 3 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  24/124:\x1B[0m Solving 3 weeks, 3 days to 3 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  25/124:\x1B[0m Solving 3 weeks, 4 days to 3 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  26/124:\x1B[0m Solving 3 weeks, 5 days to 4 weeks, 3 days, Δt = 5 days</span></span>
<span class="line"><span>\x1B[34;1mStep  27/124:\x1B[0m Solving 4 weeks, 3 days to 4 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  28/124:\x1B[0m Solving 4 weeks, 4 days to 4 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  29/124:\x1B[0m Solving 4 weeks, 5 days to 5 weeks, 3 days, Δt = 5 days</span></span>
<span class="line"><span>\x1B[34;1mStep  30/124:\x1B[0m Solving 5 weeks, 3 days to 5 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  31/124:\x1B[0m Solving 5 weeks, 4 days to 5 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  32/124:\x1B[0m Solving 5 weeks, 5 days to 5 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  33/124:\x1B[0m Solving 5 weeks, 6 days to 6 weeks, 3 days, Δt = 4 days</span></span>
<span class="line"><span>\x1B[34;1mStep  34/124:\x1B[0m Solving 6 weeks, 3 days to 6 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  35/124:\x1B[0m Solving 6 weeks, 4 days to 6 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  36/124:\x1B[0m Solving 6 weeks, 5 days to 6 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  37/124:\x1B[0m Solving 6 weeks, 6 days to 7 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  38/124:\x1B[0m Solving 7 weeks to 7 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  39/124:\x1B[0m Solving 7 weeks, 1 day to 7 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  40/124:\x1B[0m Solving 7 weeks, 2 days to 7 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  41/124:\x1B[0m Solving 7 weeks, 3 days to 7 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  42/124:\x1B[0m Solving 7 weeks, 4 days to 7 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  43/124:\x1B[0m Solving 7 weeks, 5 days to 7 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  44/124:\x1B[0m Solving 7 weeks, 6 days to 8 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  45/124:\x1B[0m Solving 8 weeks to 8 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  46/124:\x1B[0m Solving 8 weeks, 1 day to 8 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  47/124:\x1B[0m Solving 8 weeks, 2 days to 8 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  48/124:\x1B[0m Solving 8 weeks, 3 days to 8 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  49/124:\x1B[0m Solving 8 weeks, 4 days to 8 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  50/124:\x1B[0m Solving 8 weeks, 5 days to 8 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  51/124:\x1B[0m Solving 8 weeks, 6 days to 9 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  52/124:\x1B[0m Solving 9 weeks to 9 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  53/124:\x1B[0m Solving 9 weeks, 1 day to 9 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  54/124:\x1B[0m Solving 9 weeks, 2 days to 9 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  55/124:\x1B[0m Solving 9 weeks, 3 days to 9 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  56/124:\x1B[0m Solving 9 weeks, 4 days to 9 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  57/124:\x1B[0m Solving 9 weeks, 5 days to 9 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  58/124:\x1B[0m Solving 9 weeks, 6 days to 10 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  59/124:\x1B[0m Solving 10 weeks to 10 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  60/124:\x1B[0m Solving 10 weeks, 1 day to 10 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  61/124:\x1B[0m Solving 10 weeks, 2 days to 10 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  62/124:\x1B[0m Solving 10 weeks, 3 days to 10 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  63/124:\x1B[0m Solving 10 weeks, 4 days to 10 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  64/124:\x1B[0m Solving 10 weeks, 5 days to 10 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  65/124:\x1B[0m Solving 10 weeks, 6 days to 11 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  66/124:\x1B[0m Solving 11 weeks to 11 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  67/124:\x1B[0m Solving 11 weeks, 1 day to 11 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  68/124:\x1B[0m Solving 11 weeks, 2 days to 11 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  69/124:\x1B[0m Solving 11 weeks, 3 days to 11 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  70/124:\x1B[0m Solving 11 weeks, 4 days to 33 weeks, 2 days, Δt = 21 weeks, 5 days</span></span>
<span class="line"><span>\x1B[34;1mStep  71/124:\x1B[0m Solving 33 weeks, 2 days to 33 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  72/124:\x1B[0m Solving 33 weeks, 3 days to 33 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  73/124:\x1B[0m Solving 33 weeks, 4 days to 33 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  74/124:\x1B[0m Solving 33 weeks, 5 days to 33 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  75/124:\x1B[0m Solving 33 weeks, 6 days to 34 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  76/124:\x1B[0m Solving 34 weeks to 34 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  77/124:\x1B[0m Solving 34 weeks, 1 day to 34 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  78/124:\x1B[0m Solving 34 weeks, 2 days to 34 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  79/124:\x1B[0m Solving 34 weeks, 3 days to 34 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  80/124:\x1B[0m Solving 34 weeks, 4 days to 34 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  81/124:\x1B[0m Solving 34 weeks, 5 days to 34 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  82/124:\x1B[0m Solving 34 weeks, 6 days to 35 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  83/124:\x1B[0m Solving 35 weeks to 35 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  84/124:\x1B[0m Solving 35 weeks, 1 day to 35 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  85/124:\x1B[0m Solving 35 weeks, 2 days to 35 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  86/124:\x1B[0m Solving 35 weeks, 3 days to 35 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  87/124:\x1B[0m Solving 35 weeks, 4 days to 35 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  88/124:\x1B[0m Solving 35 weeks, 5 days to 35 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  89/124:\x1B[0m Solving 35 weeks, 6 days to 36 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  90/124:\x1B[0m Solving 36 weeks to 36 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  91/124:\x1B[0m Solving 36 weeks, 1 day to 36 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  92/124:\x1B[0m Solving 36 weeks, 2 days to 36 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  93/124:\x1B[0m Solving 36 weeks, 3 days to 36 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  94/124:\x1B[0m Solving 36 weeks, 4 days to 36 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  95/124:\x1B[0m Solving 36 weeks, 5 days to 36 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  96/124:\x1B[0m Solving 36 weeks, 6 days to 37 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  97/124:\x1B[0m Solving 37 weeks to 37 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  98/124:\x1B[0m Solving 37 weeks, 1 day to 37 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  99/124:\x1B[0m Solving 37 weeks, 2 days to 37 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 100/124:\x1B[0m Solving 37 weeks, 3 days to 37 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 101/124:\x1B[0m Solving 37 weeks, 4 days to 37 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 102/124:\x1B[0m Solving 37 weeks, 5 days to 37 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 103/124:\x1B[0m Solving 37 weeks, 6 days to 38 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 104/124:\x1B[0m Solving 38 weeks to 38 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 105/124:\x1B[0m Solving 38 weeks, 1 day to 38 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 106/124:\x1B[0m Solving 38 weeks, 2 days to 38 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 107/124:\x1B[0m Solving 38 weeks, 3 days to 38 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 108/124:\x1B[0m Solving 38 weeks, 4 days to 38 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 109/124:\x1B[0m Solving 38 weeks, 5 days to 38 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 110/124:\x1B[0m Solving 38 weeks, 6 days to 39 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 111/124:\x1B[0m Solving 39 weeks to 39 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 112/124:\x1B[0m Solving 39 weeks, 1 day to 39 weeks, 2 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 113/124:\x1B[0m Solving 39 weeks, 2 days to 39 weeks, 3 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 114/124:\x1B[0m Solving 39 weeks, 3 days to 39 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 115/124:\x1B[0m Solving 39 weeks, 4 days to 39 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 116/124:\x1B[0m Solving 39 weeks, 5 days to 39 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 117/124:\x1B[0m Solving 39 weeks, 6 days to 40 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 118/124:\x1B[0m Solving 40 weeks to 40 weeks, 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 119/124:\x1B[0m Solving 40 weeks, 1 day to 40 weeks, 3 days, Δt = 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 120/124:\x1B[0m Solving 40 weeks, 3 days to 40 weeks, 4 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 121/124:\x1B[0m Solving 40 weeks, 4 days to 40 weeks, 5 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 122/124:\x1B[0m Solving 40 weeks, 5 days to 40 weeks, 6 days, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 123/124:\x1B[0m Solving 40 weeks, 6 days to 41 weeks, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep 124/124:\x1B[0m Solving 41 weeks to 41 weeks, 5 days, Δt = 5 days</span></span>
<span class="line"><span>\x1B[92;1;4mSimulation complete:\x1B[0m Completed 124 report steps in 7 minutes, 3 seconds, 290.7 milliseconds and 350 iterations.</span></span>
<span class="line"><span>╭────────────────┬───────────┬───────────────┬──────────╮</span></span>
<span class="line"><span>│ Iteration type │  Avg/step │  Avg/ministep │    Total │</span></span>
<span class="line"><span>│                │ 124 steps │ 133 ministeps │ (wasted) │</span></span>
<span class="line"><span>├────────────────┼───────────┼───────────────┼──────────┤</span></span>
<span class="line"><span>│ Newton         │   2.82258 │       2.63158 │  350 (0) │</span></span>
<span class="line"><span>│ Linearization  │   3.89516 │       3.63158 │  483 (0) │</span></span>
<span class="line"><span>│ Linear solver  │   11.3952 │       10.6241 │ 1413 (0) │</span></span>
<span class="line"><span>│ Precond apply  │   22.7903 │       21.2481 │ 2826 (0) │</span></span>
<span class="line"><span>╰────────────────┴───────────┴───────────────┴──────────╯</span></span>
<span class="line"><span>╭───────────────┬────────┬────────────┬──────────╮</span></span>
<span class="line"><span>│ Timing type   │   Each │   Relative │    Total │</span></span>
<span class="line"><span>│               │      s │ Percentage │        s │</span></span>
<span class="line"><span>├───────────────┼────────┼────────────┼──────────┤</span></span>
<span class="line"><span>│ Properties    │ 0.0447 │     3.70 % │  15.6520 │</span></span>
<span class="line"><span>│ Equations     │ 0.1559 │    17.79 % │  75.3228 │</span></span>
<span class="line"><span>│ Assembly      │ 0.0354 │     4.04 % │  17.1216 │</span></span>
<span class="line"><span>│ Linear solve  │ 0.0837 │     6.92 % │  29.3036 │</span></span>
<span class="line"><span>│ Linear setup  │ 0.4213 │    34.84 % │ 147.4640 │</span></span>
<span class="line"><span>│ Precond apply │ 0.0455 │    30.38 % │ 128.5795 │</span></span>
<span class="line"><span>│ Update        │ 0.0086 │     0.71 % │   3.0197 │</span></span>
<span class="line"><span>│ Convergence   │ 0.0037 │     0.43 % │   1.8048 │</span></span>
<span class="line"><span>│ Input/Output  │ 0.0043 │     0.13 % │   0.5696 │</span></span>
<span class="line"><span>│ Other         │ 0.0127 │     1.05 % │   4.4531 │</span></span>
<span class="line"><span>├───────────────┼────────┼────────────┼──────────┤</span></span>
<span class="line"><span>│ Total         │ 1.2094 │   100.00 % │ 423.2907 │</span></span>
<span class="line"><span>╰───────────────┴────────┴────────────┴──────────╯</span></span></code></pre></div><h2 id="Plot-the-reservoir-and-monitor-points" tabindex="-1">Plot the reservoir and monitor points <a class="header-anchor" href="#Plot-the-reservoir-and-monitor-points" aria-label="Permalink to &quot;Plot the reservoir and monitor points {#Plot-the-reservoir-and-monitor-points}&quot;">​</a></h2><p>We will monitor points close to the warm and cold wells for comparsion with a commercial simulator. These can be identified by their IJK triplets, and we plot these in orange and blue.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">reservoir </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">G </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> physical_representation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reservoir)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_warm1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cell_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(G, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">105</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">75</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_warm2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cell_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(G, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">106</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">75</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_cold1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cell_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(G, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">75</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_cold2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cell_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(G, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">51</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">75</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, azimuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4.55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, elevation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (wname, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_model_wells</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, w)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Jutul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_mesh_edges!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, alpha </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_mesh!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [cell_warm1, cell_warm2])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_mesh!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [cell_cold1, cell_cold2])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+l+`" alt=""></p><h2 id="Plot-the-permeability" tabindex="-1">Plot the permeability <a class="header-anchor" href="#Plot-the-permeability" aria-label="Permalink to &quot;Plot the permeability {#Plot-the-permeability}&quot;">​</a></h2><p>The model contains a high permeable aquifer layer in the middle of the model. The high permeable layer conducts the flow between the wells, and the low permeable layers above and below the aquifer layer conduct heat.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, azimuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4.55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, elevation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (wname, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_model_wells</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, w)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, reservoir[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:permeability</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:darcy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    shading </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NoShading,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :thermal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], plt, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Horizontal permeability (darcy)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, vertical </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+t+`" alt=""></p><h2 id="Plot-the-water-rate-in-the-wells" tabindex="-1">Plot the water rate in the wells <a class="header-anchor" href="#Plot-the-water-rate-in-the-wells" aria-label="Permalink to &quot;Plot the water rate in the wells {#Plot-the-water-rate-in-the-wells}&quot;">​</a></h2><p>The water rate in the wells is shown below. The well rates are mirrored in that the cold well injects the same amount of water as the warm well produces and vice versa. Initially, the warm well injects water and the cold well produces to maintain aquifer pressure. Later on, the warm well produces warm water and the cold well injects utilized cold water at a slightly higher temperature than that of the reservoir to balance the pressure.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t_jutul </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_seconds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wrat_cold </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:COLD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:wrat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wrat_warm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WARM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:wrat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">day</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time elapsed (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Water rate (m³/day)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Water rate in wells (positive = injection)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, wrat_cold, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;COLD well&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, wrat_warm, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;WARM well&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :ct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+p+`" alt=""></p><h2 id="Plot-the-final-temperature-in-the-reservoir" tabindex="-1">Plot the final temperature in the reservoir <a class="header-anchor" href="#Plot-the-final-temperature-in-the-reservoir" aria-label="Permalink to &quot;Plot the final temperature in the reservoir {#Plot-the-final-temperature-in-the-reservoir}&quot;">​</a></h2><p>We see the final temperature distribution in the reservoir. The regions near both wells are warmer than the rest of the reservoir, with the hot well being the warmest.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, azimuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4.55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, elevation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (wname, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_model_wells</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, w)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Jutul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_mesh_edges!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, alpha </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, G, temp,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :thermal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> findall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, temp),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    transparency </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    shading </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NoShading</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], plt, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature (°C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, vertical </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+h+`" alt=""></p><h2 id="Plot-the-temperature-near-the-warm-well-and-compare-to-E300" tabindex="-1">Plot the temperature near the warm well and compare to E300 <a class="header-anchor" href="#Plot-the-temperature-near-the-warm-well-and-compare-to-E300" aria-label="Permalink to &quot;Plot the temperature near the warm well and compare to E300 {#Plot-the-temperature-near-the-warm-well-and-compare-to-E300}&quot;">​</a></h2><p>We compare the temperature in cells close to the warm well in JutulDarcy and the same case simulated in E300, demonstrating excellent agreement.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">warm1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][cell_warm1] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, states)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">warm2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][cell_warm2] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, states)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">warm1_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">warm2_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time elapsed (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature in cells close to warm well&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, warm1, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;JutulDarcy, cell (105,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_e300, warm1_e300, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;E300, cell (105,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linestyle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :dash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, warm2, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;JutulDarcy, cell (106,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_e300, warm2_e300, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;E300, cell (106,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linestyle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :dash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+k+`" alt=""></p><h2 id="Plot-the-temperature-near-the-cold-well-and-compare" tabindex="-1">Plot the temperature near the cold well and compare <a class="header-anchor" href="#Plot-the-temperature-near-the-cold-well-and-compare" aria-label="Permalink to &quot;Plot the temperature near the cold well and compare {#Plot-the-temperature-near-the-cold-well-and-compare}&quot;">​</a></h2><p>We note a similar match between the solvers near the cold well.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cold1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][cell_cold1] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, states)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cold2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][cell_cold2] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, states)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cold1_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cold2_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time elapsed (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature in cells close to warm well&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, cold1, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;JutulDarcy, cell (50,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_e300, cold1_e300, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;E300, cell (50,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linestyle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :dash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, cold2, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;JutulDarcy, cell (51,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_e300, cold2_e300, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;E300, cell (51,75,6)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linestyle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :dash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :ct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+r+`" alt=""></p><h2 id="Plot-the-well-temperatures" tabindex="-1">Plot the well temperatures <a class="header-anchor" href="#Plot-the-well-temperatures" aria-label="Permalink to &quot;Plot the well temperatures {#Plot-the-well-temperatures}&quot;">​</a></h2><p>Finally, we compare the reported temperatures in the wells between JutulDarcy and E300. These values are a mix of prescribed conditions (during injection) and the solution values (during production).</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t_well_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">warm_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">warm_jutul </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WARM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cold_e300 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wdata[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cold_jutul </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:COLD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 273.15</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time elapsed (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature (°C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Well temperatures&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, warm_jutul, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;JutulDarcy, WARM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_well_e300, warm_e300, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;E300, WARM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linestyle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :dash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_jutul, cold_jutul, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;JutulDarcy, COLD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, t_well_e300, cold_e300, label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;E300, COLD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linestyle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :dash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(position </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+d+`" alt=""></p><h2 id="Plot-the-total-energy-in-the-reservoir" tabindex="-1">Plot the total energy in the reservoir <a class="header-anchor" href="#Plot-the-total-energy-in-the-reservoir" aria-label="Permalink to &quot;Plot the total energy in the reservoir {#Plot-the-total-energy-in-the-reservoir}&quot;">​</a></h2><p>We plot the total energy in the reservoir relative to the initial condition by summing up the thermal energy in all cells at the initial state and using this as the baseline. The total energy in the reservoir matches the injected and produced energy, as there are no open boundary conditions.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">E0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:TotalThermalEnergy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">energy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:TotalThermalEnergy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> E0, states)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t_jutul, energy, axis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time elapsed (days)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Total energy (J)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Total energy in reservoir relative to initial condition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p><img src="`+E+'" alt=""></p><h2 id="Plot-the-reservoir-in-the-interactive-viewer" tabindex="-1">Plot the reservoir in the interactive viewer <a class="header-anchor" href="#Plot-the-reservoir-in-the-interactive-viewer" aria-label="Permalink to &quot;Plot the reservoir in the interactive viewer {#Plot-the-reservoir-in-the-interactive-viewer}&quot;">​</a></h2><p>If you are running this example yourself, you can launch an interactive viewer and explore the evolution of the model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case, states, key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Pressure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="'+y+'" alt=""></p><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the JutulDarcy.jl GitHub repository <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/main/examples/validation/validation_thermal.jl" target="_blank" rel="noreferrer">as a script</a>, or as a <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/gh-pages/dev/final_site/notebooks/validation/validation_thermal.ipynb" target="_blank" rel="noreferrer">Jupyter Notebook</a></p><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p>',45)]))}const v=i(g,[["render",o]]);export{w as __pageData,v as default};
