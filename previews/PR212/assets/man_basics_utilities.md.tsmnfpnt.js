import{_ as o,C as r,o as p,c as d,az as l,j as i,a,E as e,w as n}from"./chunks/framework.v5KlnX5E.js";const G=JSON.parse('{"title":"Utilities","description":"","frontmatter":{},"headers":[],"relativePath":"man/basics/utilities.md","filePath":"man/basics/utilities.md","lastUpdated":null}'),h={name:"man/basics/utilities.md"},u={class:"jldocstring custom-block",open:""},c={class:"jldocstring custom-block",open:""},k={class:"jldocstring custom-block",open:""},g={class:"jldocstring custom-block",open:""},y={class:"jldocstring custom-block",open:""},b={class:"jldocstring custom-block",open:""},m={class:"jldocstring custom-block",open:""},f={class:"jldocstring custom-block",open:""},E={class:"jldocstring custom-block",open:""},_={class:"jldocstring custom-block",open:""},v={class:"jldocstring custom-block",open:""},C={class:"jldocstring custom-block",open:""},F={class:"jldocstring custom-block",open:""},j={class:"jldocstring custom-block",open:""},T={class:"jldocstring custom-block",open:""},D={class:"jldocstring custom-block",open:""},A={class:"jldocstring custom-block",open:""},x={class:"jldocstring custom-block",open:""},S={class:"jldocstring custom-block",open:""},P={class:"jldocstring custom-block",open:""},w={class:"jldocstring custom-block",open:""},J={class:"jldocstring custom-block",open:""},B={class:"jldocstring custom-block",open:""},O={class:"jldocstring custom-block",open:""},I={class:"jldocstring custom-block",open:""};function V(L,s,R,N,M,z){const t=r("Badge");return p(),d("div",null,[s[102]||(s[102]=l('<h1 id="Utilities" tabindex="-1">Utilities <a class="header-anchor" href="#Utilities" aria-label="Permalink to &quot;Utilities {#Utilities}&quot;">​</a></h1><p>This section describes various utilities that do not fit in other sections.</p><h2 id="CO2-and-brine-correlations" tabindex="-1">CO2 and brine correlations <a class="header-anchor" href="#CO2-and-brine-correlations" aria-label="Permalink to &quot;CO2 and brine correlations {#CO2-and-brine-correlations}&quot;">​</a></h2><p>These functions are not exported, but can be found inside the <code>CO2Properties</code> submodule. The functions described here are a Julia port of the MRST module described in [<a href="/JutulDarcy.jl/previews/PR212/extras/refs#salo_co2">6</a>] They can be accessed by explicit import:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CO2Properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name_of_function</span></span></code></pre></div>',5)),i("details",u,[i("summary",null,[s[0]||(s[0]=i("a",{id:"JutulDarcy.CO2Properties.compute_co2_brine_props",href:"#JutulDarcy.CO2Properties.compute_co2_brine_props"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.compute_co2_brine_props")],-1)),s[1]||(s[1]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[3]||(s[3]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">props </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compute_co2_brine_props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(p_pascal, T_K, salt_mole_fractions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Float64[], salt_names </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String[];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    check</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iterate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    maxits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ionized</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">props </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compute_co2_brine_props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200e5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">273.15</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Get pure phase properties (density, viscosity) and equilibrium constants for brine and water. This functions and the functions used in this function are heavily based on comparable code in the co2lab-mit MRST module developed by Lluis Salo.</p><p>The salt mole fractions are of the total brine (i.e. including H2O in the calculation) and can any subset of the following names provided:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NaCl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;KCl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CaSO4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CaCl2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MgSO4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MgCl2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,4)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L528-L547",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",c,[i("summary",null,[s[4]||(s[4]=i("a",{id:"JutulDarcy.CO2Properties.pvt_brine_RoweChou1970",href:"#JutulDarcy.CO2Properties.pvt_brine_RoweChou1970"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.pvt_brine_RoweChou1970")],-1)),s[5]||(s[5]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[7]||(s[7]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[rho_brine, c_brine] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pvt_brine_RoweChou1970</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, P, S)</span></span></code></pre></div><p>Calculate brine density and/or compressibility using Rowe and Chou&quot;s (1970) correlation.</p><p><strong>Parameter range for correlation:</strong></p><p>P &lt;= 35 MPa 293.15 &lt;= T &lt;= 423.15 K</p><p><strong>Arguments:</strong></p><ul><li><p>T: Scalar with temperature value in Kelvin</p></li><li><p>P: Scalar with pressure value in bar</p></li><li><p>S: Salt mass fraction</p></li></ul><p><strong>Outputs</strong></p><ul><li><p>rho_brine: Scalar with density value in kg/m3</p></li><li><p>c_brine: Scalar with compressibility value in 1/kPa</p></li></ul>',8)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[6]||(s[6]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L1-L23",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",k,[i("summary",null,[s[8]||(s[8]=i("a",{id:"JutulDarcy.CO2Properties.activity_co2_DS2003",href:"#JutulDarcy.CO2Properties.activity_co2_DS2003"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.activity_co2_DS2003")],-1)),s[9]||(s[9]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[11]||(s[11]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gamma_co2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> activity_co2_DS2003</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, P, m_io)</span></span></code></pre></div><p>Calculate a CO2 pseudo activity coefficient based on a virial expansion of excess Gibbs energy.</p><p><strong>Arguments</strong></p><ul><li><p>T: Scalar with temperature value in Kelvin</p></li><li><p>P: Scalar with pressure value in bar</p></li><li><p>m_io: Vector where each entry corresponds to the molality of a particular ion in the initial brine solution. The order is as follows: [ Na(+), K(+), Ca(2+), Mg(2+), Cl(-), SO4(2-)]</p></li></ul><p><strong>Outputs</strong></p><ul><li><p>V_m: Scalar with molar volume in [cm^3/mol]</p></li><li><p>rhox: Scalar with density in [mol/m^3]</p></li><li><p>rho: Scalar with density in [kg/m^3]</p></li></ul>',6)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[10]||(s[10]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L263-L281",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",g,[i("summary",null,[s[12]||(s[12]=i("a",{id:"JutulDarcy.CO2Properties.viscosity_brine_co2_mixture_IC2012",href:"#JutulDarcy.CO2Properties.viscosity_brine_co2_mixture_IC2012"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.viscosity_brine_co2_mixture_IC2012")],-1)),s[13]||(s[13]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[15]||(s[15]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mu_co2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> viscosity_brine_co2_mixture_IC2012</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, P, m_nacl, w_co2)</span></span></code></pre></div><p>Calculate the dynamic viscosity of a solution of H2O + NaCl (brine) with dissolved CO2.</p><p><strong>Parameter range for correlation:</strong></p><p>For pure water + CO2, the model is based on experimental data by Kumagai et al. (1998), which is for p up to 400 bar and T up to 50 C, and Bando et al. (2004), which is valid in 30-60C and 10-20MPa. The model of Mao &amp; Duan (2009) for brine viscosity reaches 623K, 1000 bar and high ionic strength. However, the model used to determine the viscosity when co2 dissolves in the brine (Islam &amp; Carlson, 2012) is based on experimental data by Bando et al. (2004) and Fleury and Deschamps (2008), who provided experimental data up to P = 200 bar, T extrapolated to 100 C, and maximum salinity of 2.7M.</p><p><strong>Arguments</strong></p><ul><li><p>T: Scalar with temperature value in Kelvin</p></li><li><p>P: Scalar with pressure value in bar</p></li><li><p>m_nacl: Salt molality (NaCl) in mol/kg solvent</p></li><li><p>w_co2: Mass fraction of CO2 in the aqueous solution (i.e. brine)</p></li></ul><p><strong>Outputs</strong></p><ul><li>mu_b_co2: Scalar with dynamic viscosity in Pa*s</li></ul>',8)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[14]||(s[14]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L365-L394",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",y,[i("summary",null,[s[16]||(s[16]=i("a",{id:"JutulDarcy.CO2Properties.pvt_brine_BatzleWang1992",href:"#JutulDarcy.CO2Properties.pvt_brine_BatzleWang1992"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.pvt_brine_BatzleWang1992")],-1)),s[17]||(s[17]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[19]||(s[19]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rho_b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pvt_brine_BatzleWang1992</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, P, w_nacl)</span></span></code></pre></div><p>Calculate the brine (H2O + NaCl) density based on Batzle &amp; Wang (1992). These authors used the data of Rowe and Chou (1970), Zarembo &amp; Fedorov (1975) and Potter &amp; Brown (1977) to expand the P, T validity range.</p><p><strong>Parameter range for correlation:</strong></p><p>P valid from 5 to 100 MPa, T from 20 to 350 C (Adams &amp; Bachu, 2002)</p><p><strong>Arguments</strong></p><ul><li><p>T: Temperature value in Kelvin</p></li><li><p>P: Pressure value in bar</p></li><li><p>w_nacl: Salt (NaCl) mass fraction</p></li></ul><p><strong>Outputs</strong></p><ul><li>rho_b: Scalar with brine density in kg/m3</li></ul>',8)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[18]||(s[18]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L110-L129",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",b,[i("summary",null,[s[20]||(s[20]=i("a",{id:"JutulDarcy.CO2Properties.viscosity_co2_Fenghour1998",href:"#JutulDarcy.CO2Properties.viscosity_co2_Fenghour1998"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.viscosity_co2_Fenghour1998")],-1)),s[21]||(s[21]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[23]||(s[23]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mu </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> viscosity_co2_Fenghour1998</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, rho)</span></span></code></pre></div><p>Calculate CO2 viscosity from Vesovic et al., J Phys Chem Ref Data (1990) and Fenghour et al., J Phys Chem Ref Data (1998), as described in Hassanzadeh et al., IJGGC (2008).</p><p><strong>Arguments:</strong></p><ul><li><p>T: Scalar of temperature value in Kelvin</p></li><li><p>rho: Scalar of density value in kg/m^3</p></li></ul><p><strong>Outputs</strong></p><ul><li>mu: Dynamic viscosity in Pa*s</li></ul>',6)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[22]||(s[22]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L60-L76",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",m,[i("summary",null,[s[24]||(s[24]=i("a",{id:"JutulDarcy.CO2Properties.pvt_co2_RedlichKwong1949",href:"#JutulDarcy.CO2Properties.pvt_co2_RedlichKwong1949"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.pvt_co2_RedlichKwong1949")],-1)),s[25]||(s[25]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[27]||(s[27]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[V_m, rhox, rho] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pvt_co2_RedlichKwong1949</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, P)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[V_m, rhox, rho] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pvt_co2_RedlichKwong1949</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, P, a_m, b_m)</span></span></code></pre></div><p>Calculate CO2 molar volume and density using Redlich and Kwong (1949) EoS (= RK EoS).</p><p><strong>Parameter range for correlation:</strong></p><p>Tested by Spycher et al. (2003) with constant intermolecular attraction parameters to yield accurate results in the T range ~10 to ~100C and P range up to 600 bar, for (1) CO2 compressibility factor, (2) CO2 fugacity coefficient and (3) mutual solubilities of H2O and CO2 in the gas and aqueous phase (respectively).</p><p><strong>Arguments</strong></p><ul><li><p>T: Scalar with temperature value in Kelvin</p></li><li><p>P: Scalar with pressure value in bar</p></li></ul><p><strong>Optional arguments:</strong></p><ul><li><p>a_m: Intermolecular attraction constant (of the mixture) in bar_cm^6_K^0.5/mol^2</p></li><li><p>b_m: Intermolecular repulsion constant (of the mixture) in cm^3/mol</p></li></ul><p><strong>Outputs</strong></p><ul><li><p>V_m: Scalar with molar volume in [cm^3/mol]</p></li><li><p>rhox: Scalar with density in [mol/m^3]</p></li><li><p>rho: Scalar with density in [kg/m^3]</p></li></ul>`,10)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[26]||(s[26]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L162-L192",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",f,[i("summary",null,[s[28]||(s[28]=i("a",{id:"JutulDarcy.CO2Properties.viscosity_gas_mixture_Davidson1993",href:"#JutulDarcy.CO2Properties.viscosity_gas_mixture_Davidson1993"},[i("span",{class:"jlbinding"},"JutulDarcy.CO2Properties.viscosity_gas_mixture_Davidson1993")],-1)),s[29]||(s[29]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[31]||(s[31]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">viscMixture </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> viscosity_gas_mixture_Davidson1993</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, M, mu)</span></span></code></pre></div><p>Calculate the viscosity of a gas mixture following Davidson (1993). In principle, valid for any range within which the individual components&#39; viscosities are valid.</p><p>Arguments:</p><ul><li><p>x: Mole fraction of each component</p></li><li><p>M: Molar mass of each component</p></li><li><p>mu: Viscosity of each component in user chosen units</p></li></ul><p>Each input should be a Float64 Vector of length n where n is the total number of components</p><p><strong>Outputs</strong></p><ul><li>viscMixture: Scalar viscosity of the mixture in same units as mu</li></ul>',7)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[30]||(s[30]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/CO2Properties/generation.jl#L469-L488",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[103]||(s[103]=i("h2",{id:"Relative-permeability-functions",tabindex:"-1"},[a("Relative permeability functions "),i("a",{class:"header-anchor",href:"#Relative-permeability-functions","aria-label":'Permalink to "Relative permeability functions {#Relative-permeability-functions}"'},"​")],-1)),i("details",E,[i("summary",null,[s[32]||(s[32]=i("a",{id:"JutulDarcy.brooks_corey_relperm",href:"#JutulDarcy.brooks_corey_relperm"},[i("span",{class:"jlbinding"},"JutulDarcy.brooks_corey_relperm")],-1)),s[33]||(s[33]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[35]||(s[35]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">brooks_corey_relperm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s; n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, residual </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kr_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, residual_total </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> residual)</span></span></code></pre></div><p>Evaluate Brooks-Corey relative permeability function at saturation <code>s</code> for exponent <code>n</code> and a given residual and maximum relative permeability value. If considering a two-phase system, the total residual value over both phases should also be passed if the other phase has a non-zero residual value.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[34]||(s[34]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/variables/relperm/simple.jl#L176-L183",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[104]||(s[104]=i("h2",{id:"CO2-inventory",tabindex:"-1"},[a("CO2 inventory "),i("a",{class:"header-anchor",href:"#CO2-inventory","aria-label":'Permalink to "CO2 inventory {#CO2-inventory}"'},"​")],-1)),i("details",_,[i("summary",null,[s[36]||(s[36]=i("a",{id:"JutulDarcy.co2_inventory",href:"#JutulDarcy.co2_inventory"},[i("span",{class:"jlbinding"},"JutulDarcy.co2_inventory")],-1)),s[37]||(s[37]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[39]||(s[39]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inventory </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> co2_inventory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, ws, states, t; cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> missing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, co2_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CO2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inventory </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> co2_inventory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReservoirSimResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> missing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute CO2 inventory for each step for a given <code>model</code>, well results <code>ws</code> and reporting times t. If provided, the keyword argument <code>cells</code> will compute inventory inside the region defined by the cells, and let any additional CO2 be categorized as &quot;outside region&quot;.</p><p>The inventory will be a Vector of Dicts where each entry contains a breakdown of the status of the CO2 at that time, including residual and dissolution trapping.</p>`,3)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[38]||(s[38]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/utils.jl#L2196-L2207",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",v,[i("summary",null,[s[40]||(s[40]=i("a",{id:"JutulDarcy.plot_co2_inventory",href:"#JutulDarcy.plot_co2_inventory"},[i("span",{class:"jlbinding"},"JutulDarcy.plot_co2_inventory")],-1)),s[41]||(s[41]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[43]||(s[43]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_co2_inventory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t, inventory, plot_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :stack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Plots the CO2 inventory over time or steps, with options for stacked or line plots. <code>inventory</code> is the output from <code>co2_inventory</code> while <code>t</code> can either be omitted, be a list of reporting time in seconds or a index list of steps where the solution is given.</p><p><strong>Arguments</strong></p><ul><li><p><code>t</code>: A vector representing time or steps. If <code>t</code> is of type <code>Float64</code>, it is assumed to represent time in seconds and will be converted to years.</p></li><li><p><code>inventory</code>: A vector of dictionaries, where each dictionary contains CO2 mass data for different categories (e.g., <code>:dissolved</code>, <code>:mobile</code>, <code>:residual</code>, etc.).</p></li><li><p><code>plot_type</code>: (Optional) A symbol specifying the type of plot. Can be <code>:stack</code> for stacked plots or <code>:lines</code> for line plots. Default is <code>:stack</code>.</p></li></ul><p><strong>Notes</strong></p><p>This function is only available if Makie is loaded (through for example GLMakie or CairoMakie)</p>',6)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[42]||(s[42]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/ext/ext_makie.jl#L234-L255",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[105]||(s[105]=i("h2",{id:"API-utilities",tabindex:"-1"},[a("API utilities "),i("a",{class:"header-anchor",href:"#API-utilities","aria-label":'Permalink to "API utilities {#API-utilities}"'},"​")],-1)),i("details",C,[i("summary",null,[s[44]||(s[44]=i("a",{id:"JutulDarcy.reservoir_model",href:"#JutulDarcy.reservoir_model"},[i("span",{class:"jlbinding"},"JutulDarcy.reservoir_model")],-1)),s[45]||(s[45]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[47]||(s[47]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model)</span></span></code></pre></div><p>Get the reservoir model from a <code>MultiModel</code> or return the model itself if it is not a <code>MultiModel</code>.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[46]||(s[46]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/utils.jl#L1-L6",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",F,[i("summary",null,[s[48]||(s[48]=i("a",{id:"JutulDarcy.reservoir_storage",href:"#JutulDarcy.reservoir_storage"},[i("span",{class:"jlbinding"},"JutulDarcy.reservoir_storage")],-1)),s[49]||(s[49]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[51]||(s[51]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rstorage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, storage)</span></span></code></pre></div><p>Get the reservoir storage for a simulator storage. If the model is a reservoir model, this will return <code>storage</code> directly, otherwise (in the case of a <code>MultiModel</code> with wells and reservoir) it will return the subfield <code>storage.Reservoir</code>.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[50]||(s[50]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/utils.jl#L31-L38",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",j,[i("summary",null,[s[52]||(s[52]=i("a",{id:"JutulDarcy.well_symbols",href:"#JutulDarcy.well_symbols"},[i("span",{class:"jlbinding"},"JutulDarcy.well_symbols")],-1)),s[53]||(s[53]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[55]||(s[55]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">well_symbols</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MultiModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Get the keys of a <code>MultiModel</code> models that correspond to well models.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[54]||(s[54]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/utils.jl#L1625-L1629",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[106]||(s[106]=i("h2",{id:"Model-reduction",tabindex:"-1"},[a("Model reduction "),i("a",{class:"header-anchor",href:"#Model-reduction","aria-label":'Permalink to "Model reduction {#Model-reduction}"'},"​")],-1)),i("details",T,[i("summary",null,[s[56]||(s[56]=i("a",{id:"JutulDarcy.coarsen_reservoir_case",href:"#JutulDarcy.coarsen_reservoir_case"},[i("span",{class:"jlbinding"},"JutulDarcy.coarsen_reservoir_case")],-1)),s[57]||(s[57]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[59]||(s[59]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coarsen_reservoir_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case, coarsedim; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Coarsens the given reservoir case to the specified dimensions.</p><p><strong>Arguments</strong></p><ul><li><p><code>case</code>: The reservoir case to be coarsened.</p></li><li><p><code>coarsedim</code>: The target dimensions for the coarsened reservoir. Can be one of the following:</p><ul><li><p>A tuple (nx, ny, nz) specifying the number of coarse blocks in each dimension.</p></li><li><p>An integer specifying the total number of desired coarse blocks.</p></li><li><p>Or a vector specifying the partition directly.</p></li></ul></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>method</code>: The method to use for partitioning. Defaults to <code>missing</code>.</p></li><li><p><code>partitioner_arg</code>: A named tuple of arguments to be passed to the partitioner.</p></li><li><p><code>setup_arg</code>: A named tuple of arguments to be passed to <code>coarsen_reservoir_model</code>.</p></li><li><p><code>state_arg</code>: A named tuple of arguments to be passed to the state coarsening function.</p></li></ul><p><strong>Returns</strong></p><ul><li>A coarsened version of the reservoir case.</li></ul>',8)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[58]||(s[58]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/coarsening/coarsening.jl#L275-L296",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[107]||(s[107]=i("h2",{id:"Adjoints-and-gradients",tabindex:"-1"},[a("Adjoints and gradients "),i("a",{class:"header-anchor",href:"#Adjoints-and-gradients","aria-label":'Permalink to "Adjoints and gradients {#Adjoints-and-gradients}"'},"​")],-1)),i("details",D,[i("summary",null,[s[60]||(s[60]=i("a",{id:"JutulDarcy.optimize_reservoir",href:"#JutulDarcy.optimize_reservoir"},[i("span",{class:"jlbinding"},"JutulDarcy.optimize_reservoir")],-1)),s[61]||(s[61]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[63]||(s[63]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">optimize_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dopt, objective, setup_fn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dopt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">setup_function)</span></span></code></pre></div><p>Perform optimization for reservoir models using the given <code>DictParameters</code> struct <code>dopt</code>, objective function <code>objective</code>, and setup function <code>setup_fn</code>.</p><p>Additional keyword arguments can be provided to customize the simulator setup and optimization process:</p><ul><li><p><code>simulator_arg</code>: Arguments for the simulator setup (default: <code>(output_substates = true,)</code>).</p></li><li><p><code>simulator</code>: Custom simulator instance (default: <code>missing</code>).</p></li><li><p><code>config</code>: Configuration for the simulator (default: <code>missing</code>).</p></li><li><p><code>deps</code>: Dependencies for the optimization (default: <code>:parameters_and_state0</code>).</p></li></ul><p><strong>Notes</strong></p><p>If you are optimizing forces (i.e. well constraints or boundary conditions), you need to set <code>deps = :case</code> to ensure that gradients are correctly computed. The same applies if you change the model itself in the setup function. The defaults of <code>:parameters_and_state0</code> provide significant performance improvements in most cases where only parameters and initial state are changed.</p>',6)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[62]||(s[62]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/gradients/reservoir.jl#L319-L338",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",A,[i("summary",null,[s[64]||(s[64]=i("a",{id:"JutulDarcy.reservoir_sensitivities",href:"#JutulDarcy.reservoir_sensitivities"},[i("span",{class:"jlbinding"},"JutulDarcy.reservoir_sensitivities")],-1)),s[65]||(s[65]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[68]||(s[68]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result, sens </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_sensitivities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, objective</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; sim_arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), kwarg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Simulate a case and calculate parameter sensitivities with respect to an objective function on the form:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, state, dt_n, n, forces_for_step_n)</span></span></code></pre></div><p>The objective is summed up for all steps.</p>',4)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[66]||(s[66]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/gradients/gradients.jl#L4-L14",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[69]||(s[69]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_sensitivities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rsr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReservoirSimResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, objective</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwarg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Calculate parameter sensitivities with respect to an objective function on the form for a case and a simulation result from that case. The objective function is on the form:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, state, dt_n, n, forces_for_step_n)</span></span></code></pre></div><p>The objective is summed up for all steps.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_sensitivities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case, rsr, objective; kwarg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>',5)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[67]||(s[67]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/gradients/gradients.jl#L20-L32",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",x,[i("summary",null,[s[70]||(s[70]=i("a",{id:"JutulDarcy.well_mismatch",href:"#JutulDarcy.well_mismatch"},[i("span",{class:"jlbinding"},"JutulDarcy.well_mismatch")],-1)),s[71]||(s[71]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[73]||(s[73]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">well_mismatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(qoi, wells, model_f, states_f, model_c, state_c, dt, step_info, forces; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">keyword arguments</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute well mismatch for a set of qoi&#39;s (well targets) and a set of well symbols.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[72]||(s[72]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/gradients/objectives.jl#L104-L108",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",S,[i("summary",null,[s[74]||(s[74]=i("a",{id:"Jutul.LBFGS.unit_box_bfgs",href:"#Jutul.LBFGS.unit_box_bfgs"},[i("span",{class:"jlbinding"},"Jutul.LBFGS.unit_box_bfgs")],-1)),s[75]||(s[75]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[77]||(s[77]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">unit_box_bfgs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0, f; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Iterative line search optimization using BFGS intended for scaled problems where 0 ≤ u ≤ 1 and f ~ O(1).</p><p>This is a port of the MRST function <code>unitBoxBFGS</code>, relicensed under MIT.</p><p><strong>Arguments</strong></p><ul><li><p><code>u0</code>: Initial guess vector of length n with 0 ≤ u0 ≤ 1, must be feasible with respect to additional constraints</p></li><li><p><code>f</code>: Function handle that returns tuple <code>(v, g)</code> where:</p><ul><li><p><code>v</code>: objective value</p></li><li><p><code>g</code>: objective gradient vector of length n</p></li></ul></li></ul><p><strong>Keywords</strong></p><ul><li><p><code>maximize::Bool=false</code>: Set to true to maximize objective</p></li><li><p><code>step_init::Float64=NaN</code>: Initial step (gradient scaling). If NaN, uses <code>max_initial_update/max(|initial gradient|)</code></p></li><li><p><code>time_limit::Float64=Inf</code>: Time limit for optimizer.</p></li><li><p><code>max_initial_update::Float64=0.05</code>: Maximum initial update step</p></li><li><p><code>history::Any=nothing</code>: For warm starting based on previous optimization (requires <code>output_hessian=true</code>)</p></li></ul><p><strong>Stopping Criteria</strong></p><ul><li><p><code>grad_tol::Float64=1e-3</code>: Absolute tolerance of inf-norm of projected gradient</p></li><li><p><code>obj_change_tol::Float64=5e-4</code>: Absolute objective update tolerance</p></li><li><p><code>max_it::Int=25</code>: Maximum number of iterations</p></li></ul><p><strong>Line Search Options</strong></p><ul><li><p><code>line_searchmax_it::Int=5</code>: Maximum number of line-search iterations</p></li><li><p><code>stepIncreaseTol::Float64=10</code>: Maximum step increase factor between line search iterations</p></li><li><p><code>wolfe1::Float64=1e-4</code>: Objective improvement condition</p></li><li><p><code>wolfe2::Float64=0.9</code>: Gradient reduction condition</p></li></ul><p><strong>Hessian Approximation</strong></p><ul><li><p><code>use_bfgs::Bool=true</code>: Use BFGS (false for pure gradient search)</p></li><li><p><code>limited_memory::Bool=true</code>: Use L-BFGS instead of full Hessian approximations</p></li><li><p><code>lbfgs_num::Int=5</code>: Number of vector-pairs stored for L-BFGS</p></li><li><p><code>lbfgs_strategy::Symbol=:dynamic</code>: Strategy for L-BFGS (:static or :dynamic)</p></li></ul><p><strong>Linear Constraints</strong></p><ul><li><p><code>lin_eq::NamedTuple{(:A,:b)}</code>: Linear equality constraints A*u=b</p></li><li><p><code>lin_ineq::NamedTuple{(:A,:b)}</code>: Additional linear inequality constraints A*u≤b</p></li><li><p><code>enforce_feasible::Bool=false</code>: Attempt to repair constraint violations by projection</p></li></ul><p><strong>Display Options</strong></p><ul><li><p><code>plotEvolution::Bool=true</code>: Plot optimization progress</p></li><li><p><code>logPlot::Bool=false</code>: Use logarithmic y-axis for objective plotting</p></li><li><p><code>output_hessian::Bool=false</code>: Include Hessian approximation in history output</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>v</code>: Optimal or best objective value</p></li><li><p><code>u</code>: Control/parameter vector corresponding to v</p></li><li><p><code>history</code>: Named tuple containing iteration history with fields:</p><ul><li><p><code>val</code>: objective values</p></li><li><p><code>u</code>: control/parameter vectors</p></li><li><p><code>pg</code>: projected gradient norms</p></li><li><p><code>alpha</code>: line-search step lengths</p></li><li><p><code>lsit</code>: number of line-search iterations</p></li><li><p><code>lsfl</code>: line-search flags</p></li><li><p><code>hess</code>: Hessian inverse approximations (if requested)</p></li></ul></li></ul>',19)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[76]||(s[76]=[i("a",{href:"https://github.com/sintefmath/Jutul.jl/blob/v0.4.16/src/LBFGS/constrained_optimizer.jl#L3-L61",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",P,[i("summary",null,[s[78]||(s[78]=i("a",{id:"JutulDarcy.setup_reservoir_dict_optimization",href:"#JutulDarcy.setup_reservoir_dict_optimization"},[i("span",{class:"jlbinding"},"JutulDarcy.setup_reservoir_dict_optimization")],-1)),s[79]||(s[79]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[81]||(s[81]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup_reservoir_dict_optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup_reservoir_dict_optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_trans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_pore_volume </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_multipliers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    strict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    verbose </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    do_copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Symbol[],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    kwarg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Set up a <code>DictParameters</code> struct for reservoir model optimization with a setup function. The function extracts relevant model and parameter data from the provided <code>JutulCase</code> instance, puts them in a dict for use in optimization, and defines a setup function to reconstruct the <code>JutulCase</code> from modified parameters.</p><p>Options:</p><ul><li><p><code>use_trans</code>: If <code>true</code>, include transmissibilities as optimization parameters instead of permeability.</p></li><li><p><code>use_pore_volume</code>: If <code>true</code>, include pore volumes as optimization parameters instead of porosity.</p></li><li><p><code>use_multipliers</code>: If <code>true</code>, use multipliers for permeability/transmissibility, well indices and pore volume instead of absolute values.</p></li></ul>`,4)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[80]||(s[80]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/gradients/reservoir.jl#L5-L32",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",w,[i("summary",null,[s[82]||(s[82]=i("a",{id:"JutulDarcy.HistoryMatching.history_match_objective",href:"#JutulDarcy.HistoryMatching.history_match_objective"},[i("span",{class:"jlbinding"},"JutulDarcy.HistoryMatching.history_match_objective")],-1)),s[83]||(s[83]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[85]||(s[85]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">history_match_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">history_match_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReservoirSimResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">history_match_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, states, summary)</span></span></code></pre></div><p>Set up a history match objective.</p>`,2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[84]||(s[84]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/HistoryMatching/api.jl#L5-L11",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[108]||(s[108]=i("h2",{id:"Well-outputs",tabindex:"-1"},[a("Well outputs "),i("a",{class:"header-anchor",href:"#Well-outputs","aria-label":'Permalink to "Well outputs {#Well-outputs}"'},"​")],-1)),i("details",J,[i("summary",null,[s[86]||(s[86]=i("a",{id:"JutulDarcy.get_model_wells",href:"#JutulDarcy.get_model_wells"},[i("span",{class:"jlbinding"},"JutulDarcy.get_model_wells")],-1)),s[87]||(s[87]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[89]||(s[89]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_model_wells</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model_or_case)</span></span></code></pre></div><p>Get a <code>OrderedDict</code> containing all wells in the model or simulation case.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[88]||(s[88]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/utils.jl#L214-L218",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",B,[i("summary",null,[s[90]||(s[90]=i("a",{id:"JutulDarcy.well_output",href:"#JutulDarcy.well_output"},[i("span",{class:"jlbinding"},"JutulDarcy.well_output")],-1)),s[91]||(s[91]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[93]||(s[93]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">well_output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, states, well_symbol, forces, target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BottomHolePressureTarget)</span></span></code></pre></div><p>Get a specific well output from a valid operational target once a simulation is completed an <code>states</code> are available.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[92]||(s[92]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/utils.jl#L1521-L1525",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",O,[i("summary",null,[s[94]||(s[94]=i("a",{id:"JutulDarcy.full_well_outputs",href:"#JutulDarcy.full_well_outputs"},[i("span",{class:"jlbinding"},"JutulDarcy.full_well_outputs")],-1)),s[95]||(s[95]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[97]||(s[97]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">full_well_outputs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, states, forces; targets </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> available_well_targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">models</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reservoir))</span></span></code></pre></div><p>Get the full set of well outputs after a simulation has occurred, for plotting or other post-processing.</p>',2)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[96]||(s[96]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/utils.jl#L1483-L1487",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[109]||(s[109]=i("h2",{id:"Non-neighboring-connections",tabindex:"-1"},[a("Non-neighboring connections "),i("a",{class:"header-anchor",href:"#Non-neighboring-connections","aria-label":'Permalink to "Non-neighboring connections {#Non-neighboring-connections}"'},"​")],-1)),i("details",I,[i("summary",null,[s[98]||(s[98]=i("a",{id:"JutulDarcy.setup_nnc_connections",href:"#JutulDarcy.setup_nnc_connections"},[i("span",{class:"jlbinding"},"JutulDarcy.setup_nnc_connections")],-1)),s[99]||(s[99]=a()),e(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[101]||(s[101]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup_nnc_connections</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mesh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JutulMesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, neighbors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{Tuple{Int, Int}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, trans</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, trans_thermal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> missing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup_nnc_connections</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, left</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{Int}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, right</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{Int}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, trans, trans_thermal)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setup_nnc_connections</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, neighbors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Matrix{Int}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, trans, trans_thermal)</span></span></code></pre></div><p>Set up a NNC connection structure for the given <code>mesh</code>, list of <code>neighbors</code> (as tuples of left and right cell indices or a matrix with one column per connection), flow transmissibilities <code>trans</code> and thermal transmissibilities <code>trans_thermal</code>. If <code>trans_thermal</code> is not provided, it will be defaulted to zeros (no heat conduction).</p><p>This object can then be passed to <a href="/JutulDarcy.jl/previews/PR212/man/highlevel#JutulDarcy.reservoir_domain"><code>reservoir_domain</code></a> to include NNCs in the simulation.</p>`,3)),e(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[100]||(s[100]=[i("a",{href:"https://github.com/sintefmath/JutulDarcy.jl/blob/181f662b76e1f363abd8ef7ab0976fdfcef99221/src/types.jl#L744-L757",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const K=o(h,[["render",V]]);export{G as __pageData,K as default};
