<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gravity circulation with CPR preconditioner | JutulDarcy.jl</title>
    <meta name="description" content="Documentation for JutulDarcy.jl">
    <meta name="generator" content="VitePress v1.3.4">
    <link rel="preload stylesheet" href="/JutulDarcy.jl/previews/PR65/assets/style.CFfD9YGK.css" as="style">
    
    <script type="module" src="/JutulDarcy.jl/previews/PR65/assets/app.Cr8VPvZN.js"></script>
    <link rel="preload" href="/JutulDarcy.jl/previews/PR65/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/JutulDarcy.jl/previews/PR65/assets/chunks/theme.BETFbr-t.js">
    <link rel="modulepreload" href="/JutulDarcy.jl/previews/PR65/assets/chunks/framework.BnJvuozR.js">
    <link rel="modulepreload" href="/JutulDarcy.jl/previews/PR65/assets/examples_two_phase_unstable_gravity.md.0k54vR3X.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-28a961f9><a class="title" href="/JutulDarcy.jl/previews/PR65/" data-v-28a961f9><!--[--><!--]--><!----><span data-v-28a961f9>JutulDarcy.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Introduction</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/index" data-v-8b74d055><!--[-->JutulDarcy.jl<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/intro" data-v-8b74d055><!--[-->Getting started<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/first_ex" data-v-8b74d055><!--[-->Your first JutulDarcy.jl simulation<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/extras/faq" data-v-8b74d055><!--[-->FAQ<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Manual</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/highlevel" data-v-8b74d055><!--[-->High-level API<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/input_files" data-v-8b74d055><!--[-->Input formats<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/forces" data-v-8b74d055><!--[-->Driving forces<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/systems" data-v-8b74d055><!--[-->Supported physical systems<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/wells" data-v-8b74d055><!--[-->Wells and controls<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/solution" data-v-8b74d055><!--[-->Solving the equations<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/primary" data-v-8b74d055><!--[-->Primary variables<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/secondary" data-v-8b74d055><!--[-->Secondary variables (properties)<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/parameters" data-v-8b74d055><!--[-->Parameters<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/plotting" data-v-8b74d055><!--[-->Plotting and visualization<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/basics/utilities" data-v-8b74d055><!--[-->Utilities<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Further reading</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/advanced/mpi" data-v-8b74d055><!--[-->Multi-threading and MPI support<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/man/advanced/compiled" data-v-8b74d055><!--[-->Standalone reservoir simulator<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/ref/jutul" data-v-8b74d055><!--[-->Jutul functions<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/extras/refs" data-v-8b74d055><!--[-->Bibliography<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Examples: Introduction</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/two_phase_gravity_segregation" data-v-8b74d055><!--[-->Intro: Gravity segregation<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/two_phase_buckley_leverett" data-v-8b74d055><!--[-->Intro: Two-phase Buckley-Leverett<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/wells_intro" data-v-8b74d055><!--[-->Intro: Wells<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/data_input_file" data-v-8b74d055><!--[-->Intro: Simulating Eclipse/DATA input files<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/intro_sensitivities" data-v-8b74d055><!--[-->Intro: Sensitivities in JutulDarcy<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/co2_brine_2d_vertical" data-v-8b74d055><!--[-->Intro: Compositional flow<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Examples: Usage</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/five_spot_ensemble" data-v-8b74d055><!--[-->Quarter-five-spot with variation<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link active" href="/JutulDarcy.jl/previews/PR65/examples/two_phase_unstable_gravity" data-v-8b74d055><!--[-->Gravity circulation with CPR preconditioner<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/co2_props" data-v-8b74d055><!--[-->CO2 property calculations<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/co2_sloped" data-v-8b74d055><!--[-->CO2 injection in saline aquifer<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/compositional_5components" data-v-8b74d055><!--[-->Compositional with five components<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/optimize_simple_bl" data-v-8b74d055><!--[-->Parameter matching of Buckley-Leverett<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Examples: Validation</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/validation_spe1" data-v-8b74d055><!--[-->Validation: SPE1<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/validation_spe9" data-v-8b74d055><!--[-->Validation: SPE9<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/validation_compositional" data-v-8b74d055><!--[-->Validation: Compositional<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/validation_egg" data-v-8b74d055><!--[-->Validation: Egg<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/validation_olympus_1" data-v-8b74d055><!--[-->Validation: OLYMPUS 1<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/validation_norne_nohyst" data-v-8b74d055><!--[-->Validation: Norne<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-8b74d055><a class="VPLink link" href="/JutulDarcy.jl/previews/PR65/examples/validation_mrst" data-v-8b74d055><!--[-->Validation: MRST input files<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/JutulDarcy.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e5380155><span class="vpi-more-horizontal icon" data-v-e5380155></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/JutulDarcy.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-bc9dc845><button data-v-bc9dc845>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Introduction</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/index" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>JutulDarcy.jl</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/intro" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Getting started</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/first_ex" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Your first JutulDarcy.jl simulation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/extras/faq" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>FAQ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Manual</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/highlevel" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>High-level API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/input_files" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Input formats</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/forces" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Driving forces</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/systems" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Supported physical systems</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/wells" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Wells and controls</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/solution" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Solving the equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/primary" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Primary variables</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/secondary" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Secondary variables (properties)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/parameters" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Parameters</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/plotting" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Plotting and visualization</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/basics/utilities" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Further reading</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/advanced/mpi" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Multi-threading and MPI support</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/man/advanced/compiled" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Standalone reservoir simulator</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/ref/jutul" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Jutul functions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/extras/refs" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Examples: Introduction</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/two_phase_gravity_segregation" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Intro: Gravity segregation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/two_phase_buckley_leverett" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Intro: Two-phase Buckley-Leverett</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/wells_intro" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Intro: Wells</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/data_input_file" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Intro: Simulating Eclipse/DATA input files</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/intro_sensitivities" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Intro: Sensitivities in JutulDarcy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/co2_brine_2d_vertical" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Intro: Compositional flow</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Examples: Usage</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/five_spot_ensemble" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Quarter-five-spot with variation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/two_phase_unstable_gravity" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Gravity circulation with CPR preconditioner</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/co2_props" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>CO2 property calculations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/co2_sloped" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>CO2 injection in saline aquifer</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/compositional_5components" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Compositional with five components</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/optimize_simple_bl" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Parameter matching of Buckley-Leverett</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-196b2e5f><div class="item" role="button" tabindex="0" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><h2 class="text" data-v-196b2e5f>Examples: Validation</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-196b2e5f><span class="vpi-chevron-right caret-icon" data-v-196b2e5f></span></div></div><div class="items" data-v-196b2e5f><!--[--><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/validation_spe1" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Validation: SPE1</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/validation_spe9" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Validation: SPE9</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/validation_compositional" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Validation: Compositional</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/validation_egg" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Validation: Egg</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/validation_olympus_1" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Validation: OLYMPUS 1</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/validation_norne_nohyst" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Validation: Norne</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-196b2e5f data-v-196b2e5f><div class="item" data-v-196b2e5f><div class="indicator" data-v-196b2e5f></div><a class="VPLink link link" href="/JutulDarcy.jl/previews/PR65/examples/validation_mrst" data-v-196b2e5f><!--[--><p class="text" data-v-196b2e5f>Validation: MRST input files</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _JutulDarcy_jl_previews_PR65_examples_two_phase_unstable_gravity" data-v-83890dd9><div><h1 id="Gravity-circulation-with-CPR-preconditioner" tabindex="-1">Gravity circulation with CPR preconditioner <a class="header-anchor" href="#Gravity-circulation-with-CPR-preconditioner" aria-label="Permalink to &quot;Gravity circulation with CPR preconditioner {#Gravity-circulation-with-CPR-preconditioner}&quot;">​</a></h1><p>This example demonstrates a more complex gravity driven instability. The problem is a bit larger than the <a href="/JutulDarcy.jl/previews/PR65/examples/two_phase_gravity_segregation#Gravity-segregation-example">Gravity segregation example</a>, and is therefore set up using the high level API that automatically sets up an iterative linear solver with a constrained pressure residual (CPR) preconditioner and automatic timestepping.</p><p>The high level API uses the more low level <code>Jutul</code> API seen in the other examples under the hood and makes more complex problems easy to set up. The same data structures and functions are used, allowing for deep customization if the defaults are not appropriate.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cmap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seismic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="Define-the-domain" tabindex="-1">Define the domain <a class="header-anchor" href="#Define-the-domain" aria-label="Permalink to &quot;Define the domain {#Define-the-domain}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CartesianMesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((nx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nz), (D, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, D))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(g)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DataDomain wrapping CartesianMesh (3D) with 100x1x100=10000 cells with 17 data fields added:</span></span>
<span class="line"><span>  10000 Cells</span></span>
<span class="line"><span>    :permeability =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :porosity =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :rock_thermal_conductivity =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :fluid_thermal_conductivity =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :rock_density =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :cell_centroids =&gt; 3×10000 Matrix{Float64}</span></span>
<span class="line"><span>    :volumes =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>  19800 Faces</span></span>
<span class="line"><span>    :neighbors =&gt; 2×19800 Matrix{Int64}</span></span>
<span class="line"><span>    :areas =&gt; 19800 Vector{Float64}</span></span>
<span class="line"><span>    :normals =&gt; 3×19800 Matrix{Float64}</span></span>
<span class="line"><span>    :face_centroids =&gt; 3×19800 Matrix{Float64}</span></span>
<span class="line"><span>  39600 HalfFaces</span></span>
<span class="line"><span>    :half_face_cells =&gt; 39600 Vector{Int64}</span></span>
<span class="line"><span>    :half_face_faces =&gt; 39600 Vector{Int64}</span></span>
<span class="line"><span>  20400 BoundaryFaces</span></span>
<span class="line"><span>    :boundary_areas =&gt; 20400 Vector{Float64}</span></span>
<span class="line"><span>    :boundary_centroids =&gt; 3×20400 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_normals =&gt; 3×20400 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_neighbors =&gt; 20400 Vector{Int64}</span></span></code></pre></div><h2 id="Set-up-model-and-properties" tabindex="-1">Set up model and properties <a class="header-anchor" href="#Set-up-model-and-properties" aria-label="Permalink to &quot;Set up model and properties {#Set-up-model-and-properties}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Darcy, bar, kg, meter, day </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_units</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:darcy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:kilogram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:meter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoLS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Definition of fluid phases</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoVS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 500.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cl, cv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L, V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LiquidPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VaporPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ImmiscibleSystem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([L, V])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, sys)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ConstantCompressibilityDensities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sys, p0, [rhoLS, rhoVS], [cl, cv]) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Replace density with a lighter pair</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">replace_variables!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, PhaseMassDensities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> density);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BrooksCoreyRelativePermeabilities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sys, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">replace_variables!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, RelativePermeabilities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kr)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MultiModel with 1 models and 0 cross-terms. 20000 equations, 20000 degrees of freedom and 69600 parameters.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  models:</span></span>
<span class="line"><span>    1) Reservoir (20000x20000)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MinimalTPFATopology (10000 cells, 19800 faces)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Model storage will be optimized for runtime performance.</span></span></code></pre></div><h3 id="Define-initial-saturation" tabindex="-1">Define initial saturation <a class="header-anchor" href="#Define-initial-saturation" aria-label="Permalink to &quot;Define initial saturation {#Define-initial-saturation}&quot;">​</a></h3><p>Set the left part of the domain to be filled by the vapor phase and the heavy liquid phase in the remainder. To do this, we grab the cell centroids in the x direction from the domain, reshape them to the structured mesh we are working on and define the liquid saturation from there.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> domain[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:cell_centroids</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(c[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plane </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x[i, j]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sL[i, j] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> clamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plane), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatmap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sL, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap, axis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Initial saturation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span></code></pre></div><p><img src="/JutulDarcy.jl/previews/PR65/assets/otkcdqg.BZSLuU-H.jpeg" alt=""></p><h3 id="Set-up-initial-state" tabindex="-1">Set up initial state <a class="header-anchor" href="#Set-up-initial-state" aria-label="Permalink to &quot;Set up initial state {#Set-up-initial-state}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sL)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sV </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> .-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sV, sL)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, Pressure </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p0, Saturations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> s0)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Dict{Any, Any} with 1 entry:</span></span>
<span class="line"><span>  :Reservoir =&gt; Dict{Symbol, Any}(:PhaseMassMobilities=&gt;[0.0 0.0 … 0.0 0.0; 0.0…</span></span></code></pre></div><h3 id="Set-the-viscosity-of-the-phases" tabindex="-1">Set the viscosity of the phases <a class="header-anchor" href="#Set-the-viscosity-of-the-phases" aria-label="Permalink to &quot;Set the viscosity of the phases {#Set-the-viscosity-of-the-phases}&quot;">​</a></h3><p>By default, viscosity is a parameter and can be set per-phase and per cell.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:PhaseViscosities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> μ[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> μ[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5e-3</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>10000-element view(::Matrix{Float64}, 2, :) with eltype Float64:</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> ⋮</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span></code></pre></div><p>Convert time-steps from days to seconds</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timesteps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> repeat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3600</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_, states, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state0, model, timesteps, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters, info_level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[92;1mJutul:[0m Simulating 28 weeks, 4 days as 20 report steps</span></span>
<span class="line"><span>[34;1mStep  1/20:[0m Solving start to 1 week, 3 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>┌ Warning: Exception occured in solve: ErrorException(&quot;Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.6779569363968585, rel. value 699.6097521990633. rtol = 0.005, atol = 1.0e-12, max_it = 50&quot;). Attempting to cut time-step since failure_cuts_timestep = true.</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/QPPEs/src/simulator/simulator.jl:457</span></span>
<span class="line"><span>┌ Warning: Exception occurred in perform_step!</span></span>
<span class="line"><span>│   inner_exception = Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.6779569363968585, rel. value 699.6097521990633. rtol = 0.005, atol = 1.0e-12, max_it = 50</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/QPPEs/src/simulator/simulator.jl:529</span></span>
<span class="line"><span>[33;1mConvergence:[0m Report step 1, mini-step #1 (1 day) failed to converge. Reducing mini-step.</span></span>
<span class="line"><span>┌ Warning: Exception occured in solve: ErrorException(&quot;Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.4073443575463845, rel. value 420.35425812929736. rtol = 0.005, atol = 1.0e-12, max_it = 50&quot;). Attempting to cut time-step since failure_cuts_timestep = true.</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/QPPEs/src/simulator/simulator.jl:457</span></span>
<span class="line"><span>┌ Warning: Exception occurred in perform_step!</span></span>
<span class="line"><span>│   inner_exception = Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.4073443575463845, rel. value 420.35425812929736. rtol = 0.005, atol = 1.0e-12, max_it = 50</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/QPPEs/src/simulator/simulator.jl:529</span></span>
<span class="line"><span>[33;1mConvergence:[0m Report step 1, mini-step #2 (12 hours) failed to converge. Reducing mini-step.</span></span>
<span class="line"><span>[34;1mStep  2/20:[0m Solving 1 week, 3 days to 2 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep  3/20:[0m Solving 2 weeks, 6 days to 4 weeks, 2 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep  4/20:[0m Solving 4 weeks, 2 days to 5 weeks, 5 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep  5/20:[0m Solving 5 weeks, 5 days to 7 weeks, 1 day, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep  6/20:[0m Solving 7 weeks, 1 day to 8 weeks, 4 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep  7/20:[0m Solving 8 weeks, 4 days to 10 weeks, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep  8/20:[0m Solving 10 weeks to 11 weeks, 3 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep  9/20:[0m Solving 11 weeks, 3 days to 12 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 10/20:[0m Solving 12 weeks, 6 days to 14 weeks, 2 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 11/20:[0m Solving 14 weeks, 2 days to 15 weeks, 5 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 12/20:[0m Solving 15 weeks, 5 days to 17 weeks, 1 day, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 13/20:[0m Solving 17 weeks, 1 day to 18 weeks, 4 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 14/20:[0m Solving 18 weeks, 4 days to 20 weeks, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 15/20:[0m Solving 20 weeks to 21 weeks, 3 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 16/20:[0m Solving 21 weeks, 3 days to 22 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 17/20:[0m Solving 22 weeks, 6 days to 24 weeks, 2 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 18/20:[0m Solving 24 weeks, 2 days to 25 weeks, 5 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 19/20:[0m Solving 25 weeks, 5 days to 27 weeks, 1 day, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[34;1mStep 20/20:[0m Solving 27 weeks, 1 day to 28 weeks, 4 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>[92;1;4mSimulation complete:[0m Completed 20 report steps in 8 seconds, 829 milliseconds, 453.9 microseconds and 409 iterations.</span></span>
<span class="line"><span>╭────────────────┬──────────┬──────────────┬──────────╮</span></span>
<span class="line"><span>│ Iteration type │ Avg/step │ Avg/ministep │    Total │</span></span>
<span class="line"><span>│                │ 20 steps │ 65 ministeps │ (wasted) │</span></span>
<span class="line"><span>├────────────────┼──────────┼──────────────┼──────────┤</span></span>
<span class="line"><span>│ Newton         │    20.45 │      6.29231 │  409 (2) │</span></span>
<span class="line"><span>│ Linearization  │     23.6 │      7.26154 │  472 (2) │</span></span>
<span class="line"><span>│ Linear solver  │    46.95 │      14.4462 │  939 (0) │</span></span>
<span class="line"><span>│ Precond apply  │     93.9 │      28.8923 │ 1878 (0) │</span></span>
<span class="line"><span>╰────────────────┴──────────┴──────────────┴──────────╯</span></span>
<span class="line"><span>╭───────────────┬─────────┬────────────┬────────╮</span></span>
<span class="line"><span>│ Timing type   │    Each │   Relative │  Total │</span></span>
<span class="line"><span>│               │      ms │ Percentage │      s │</span></span>
<span class="line"><span>├───────────────┼─────────┼────────────┼────────┤</span></span>
<span class="line"><span>│ Properties    │  0.6955 │     3.22 % │ 0.2845 │</span></span>
<span class="line"><span>│ Equations     │  0.7911 │     4.23 % │ 0.3734 │</span></span>
<span class="line"><span>│ Assembly      │  1.0726 │     5.73 % │ 0.5063 │</span></span>
<span class="line"><span>│ Linear solve  │  1.8056 │     8.36 % │ 0.7385 │</span></span>
<span class="line"><span>│ Linear setup  │  7.7774 │    36.03 % │ 3.1810 │</span></span>
<span class="line"><span>│ Precond apply │  0.8930 │    18.99 % │ 1.6770 │</span></span>
<span class="line"><span>│ Update        │  0.2143 │     0.99 % │ 0.0876 │</span></span>
<span class="line"><span>│ Convergence   │  0.2041 │     1.09 % │ 0.0963 │</span></span>
<span class="line"><span>│ Input/Output  │  0.1967 │     0.14 % │ 0.0128 │</span></span>
<span class="line"><span>│ Other         │  4.5774 │    21.20 % │ 1.8721 │</span></span>
<span class="line"><span>├───────────────┼─────────┼────────────┼────────┤</span></span>
<span class="line"><span>│ Total         │ 21.5879 │   100.00 % │ 8.8295 │</span></span>
<span class="line"><span>╰───────────────┴─────────┴────────────┴────────╯</span></span></code></pre></div><h2 id="Plot-results" tabindex="-1">Plot results <a class="header-anchor" href="#Plot-results" aria-label="Permalink to &quot;Plot results {#Plot-results}&quot;">​</a></h2><p>Plot initial saturation</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state0[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Before&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatmap!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, tmp, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MakieCore.Heatmap{Tuple{MakieCore.EndPoints{Float32}, MakieCore.EndPoints{Float32}, Matrix{Float32}}}</span></span></code></pre></div><p>Plot intermediate saturation</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">÷</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Half way&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> heatmap!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, tmp, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MakieCore.Heatmap{Tuple{MakieCore.EndPoints{Float32}, MakieCore.EndPoints{Float32}, Matrix{Float32}}}</span></span></code></pre></div><p>Plot final saturation</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;After&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> heatmap!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, tmp, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], hm)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f</span></span></code></pre></div><p><img src="/JutulDarcy.jl/previews/PR65/assets/taoyubn.DimKk99R.jpeg" alt=""></p><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the JutulDarcy.jl GitHub repository <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/main/examples/two_phase_unstable_gravity.jl" target="_blank" rel="noreferrer">as a script</a>, or as a <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/gh-pages/dev/final_site/notebooks/two_phase_unstable_gravity.ipynb" target="_blank" rel="noreferrer">Jupyter Notebook</a></p><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/sintefmath/JutulDarcy.jl/edit/main/docs/src/examples/two_phase_unstable_gravity.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/JutulDarcy.jl/previews/PR65/examples/five_spot_ensemble" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Quarter-five-spot with variation</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/JutulDarcy.jl/previews/PR65/examples/co2_props" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>CO2 property calculations</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2024.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"examples_co2_brine_2d_vertical.md\":\"DWRl-AZ5\",\"examples_co2_props.md\":\"KH5iAEqG\",\"examples_co2_sloped.md\":\"B6TqgMyF\",\"examples_compositional_5components.md\":\"BMmKVdeg\",\"examples_data_input_file.md\":\"CXSJTiK5\",\"examples_five_spot_ensemble.md\":\"BOnjYmnb\",\"examples_intro_sensitivities.md\":\"DeHi--dh\",\"examples_optimize_simple_bl.md\":\"D0P0DSPQ\",\"examples_two_phase_buckley_leverett.md\":\"D4W1m9Ja\",\"examples_two_phase_gravity_segregation.md\":\"CAD4Gcsz\",\"examples_two_phase_unstable_gravity.md\":\"0k54vR3X\",\"examples_validation_compositional.md\":\"IcTZ4MPz\",\"examples_validation_egg.md\":\"BY6gMYnE\",\"examples_validation_mrst.md\":\"BCXpvF_Z\",\"examples_validation_norne_nohyst.md\":\"B6GXAvdx\",\"examples_validation_olympus_1.md\":\"CwtkXNXa\",\"examples_validation_spe1.md\":\"TBQTZV3_\",\"examples_validation_spe9.md\":\"B9x1vvF3\",\"examples_wells_intro.md\":\"M13yrJxM\",\"extras_faq.md\":\"QuSYC15N\",\"extras_refs.md\":\"Cf_lq409\",\"index.md\":\"ByAw5KzA\",\"man_advanced_compiled.md\":\"CROfxm8S\",\"man_advanced_mpi.md\":\"xKKFkcZ1\",\"man_basics_forces.md\":\"9mDaSI_A\",\"man_basics_input_files.md\":\"CEuFtH_V\",\"man_basics_models.md\":\"CQKDF6un\",\"man_basics_parameters.md\":\"CvfaK2Or\",\"man_basics_plotting.md\":\"B3dfkkPM\",\"man_basics_primary.md\":\"BIHvJsNb\",\"man_basics_secondary.md\":\"-l2Uh1AZ\",\"man_basics_solution.md\":\"BlD1-r-s\",\"man_basics_systems.md\":\"DoMvQmqw\",\"man_basics_utilities.md\":\"BTV4qH_F\",\"man_basics_wells.md\":\"BkhPDHRa\",\"man_first_ex.md\":\"C9d31pqk\",\"man_highlevel.md\":\"By7qXyIZ\",\"man_intro.md\":\"X05x_6Hj\",\"notebooks_empty.md\":\"D1DCvDTH\",\"ref_jutul.md\":\"CEoyZ__x\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"JutulDarcy.jl\",\"description\":\"Documentation for JutulDarcy.jl\",\"base\":\"/JutulDarcy.jl/previews/PR65/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"JutulDarcy.jl\",\"link\":\"/index\"},{\"text\":\"Getting started\",\"link\":\"/man/intro\"},{\"text\":\"Your first JutulDarcy.jl simulation\",\"link\":\"/man/first_ex\"},{\"text\":\"FAQ\",\"link\":\"/extras/faq\"}]},{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"High-level API\",\"link\":\"/man/highlevel\"},{\"text\":\"Input formats\",\"link\":\"/man/basics/input_files\"},{\"text\":\"Driving forces\",\"link\":\"/man/basics/forces\"},{\"text\":\"Supported physical systems\",\"link\":\"/man/basics/systems\"},{\"text\":\"Wells and controls\",\"link\":\"/man/basics/wells\"},{\"text\":\"Solving the equations\",\"link\":\"/man/basics/solution\"},{\"text\":\"Primary variables\",\"link\":\"/man/basics/primary\"},{\"text\":\"Secondary variables (properties)\",\"link\":\"/man/basics/secondary\"},{\"text\":\"Parameters\",\"link\":\"/man/basics/parameters\"},{\"text\":\"Plotting and visualization\",\"link\":\"/man/basics/plotting\"},{\"text\":\"Utilities\",\"link\":\"/man/basics/utilities\"}]},{\"text\":\"Further reading\",\"collapsed\":false,\"items\":[{\"text\":\"Multi-threading and MPI support\",\"link\":\"/man/advanced/mpi\"},{\"text\":\"Standalone reservoir simulator\",\"link\":\"/man/advanced/compiled\"},{\"text\":\"Jutul functions\",\"link\":\"/ref/jutul\"},{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]},{\"text\":\"Examples: Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Intro: Gravity segregation\",\"link\":\"/examples/two_phase_gravity_segregation\"},{\"text\":\"Intro: Two-phase Buckley-Leverett\",\"link\":\"/examples/two_phase_buckley_leverett\"},{\"text\":\"Intro: Wells\",\"link\":\"/examples/wells_intro\"},{\"text\":\"Intro: Simulating Eclipse/DATA input files\",\"link\":\"/examples/data_input_file\"},{\"text\":\"Intro: Sensitivities in JutulDarcy\",\"link\":\"/examples/intro_sensitivities\"},{\"text\":\"Intro: Compositional flow\",\"link\":\"/examples/co2_brine_2d_vertical\"}]},{\"text\":\"Examples: Usage\",\"collapsed\":false,\"items\":[{\"text\":\"Quarter-five-spot with variation\",\"link\":\"/examples/five_spot_ensemble\"},{\"text\":\"Gravity circulation with CPR preconditioner\",\"link\":\"/examples/two_phase_unstable_gravity\"},{\"text\":\"CO2 property calculations\",\"link\":\"/examples/co2_props\"},{\"text\":\"CO2 injection in saline aquifer\",\"link\":\"/examples/co2_sloped\"},{\"text\":\"Compositional with five components\",\"link\":\"/examples/compositional_5components\"},{\"text\":\"Parameter matching of Buckley-Leverett\",\"link\":\"/examples/optimize_simple_bl\"}]},{\"text\":\"Examples: Validation\",\"collapsed\":false,\"items\":[{\"text\":\"Validation: SPE1\",\"link\":\"/examples/validation_spe1\"},{\"text\":\"Validation: SPE9\",\"link\":\"/examples/validation_spe9\"},{\"text\":\"Validation: Compositional\",\"link\":\"/examples/validation_compositional\"},{\"text\":\"Validation: Egg\",\"link\":\"/examples/validation_egg\"},{\"text\":\"Validation: OLYMPUS 1\",\"link\":\"/examples/validation_olympus_1\"},{\"text\":\"Validation: Norne\",\"link\":\"/examples/validation_norne_nohyst\"},{\"text\":\"Validation: MRST input files\",\"link\":\"/examples/validation_mrst\"}]}],\"sidebar\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"JutulDarcy.jl\",\"link\":\"/index\"},{\"text\":\"Getting started\",\"link\":\"/man/intro\"},{\"text\":\"Your first JutulDarcy.jl simulation\",\"link\":\"/man/first_ex\"},{\"text\":\"FAQ\",\"link\":\"/extras/faq\"}]},{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"High-level API\",\"link\":\"/man/highlevel\"},{\"text\":\"Input formats\",\"link\":\"/man/basics/input_files\"},{\"text\":\"Driving forces\",\"link\":\"/man/basics/forces\"},{\"text\":\"Supported physical systems\",\"link\":\"/man/basics/systems\"},{\"text\":\"Wells and controls\",\"link\":\"/man/basics/wells\"},{\"text\":\"Solving the equations\",\"link\":\"/man/basics/solution\"},{\"text\":\"Primary variables\",\"link\":\"/man/basics/primary\"},{\"text\":\"Secondary variables (properties)\",\"link\":\"/man/basics/secondary\"},{\"text\":\"Parameters\",\"link\":\"/man/basics/parameters\"},{\"text\":\"Plotting and visualization\",\"link\":\"/man/basics/plotting\"},{\"text\":\"Utilities\",\"link\":\"/man/basics/utilities\"}]},{\"text\":\"Further reading\",\"collapsed\":false,\"items\":[{\"text\":\"Multi-threading and MPI support\",\"link\":\"/man/advanced/mpi\"},{\"text\":\"Standalone reservoir simulator\",\"link\":\"/man/advanced/compiled\"},{\"text\":\"Jutul functions\",\"link\":\"/ref/jutul\"},{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]},{\"text\":\"Examples: Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Intro: Gravity segregation\",\"link\":\"/examples/two_phase_gravity_segregation\"},{\"text\":\"Intro: Two-phase Buckley-Leverett\",\"link\":\"/examples/two_phase_buckley_leverett\"},{\"text\":\"Intro: Wells\",\"link\":\"/examples/wells_intro\"},{\"text\":\"Intro: Simulating Eclipse/DATA input files\",\"link\":\"/examples/data_input_file\"},{\"text\":\"Intro: Sensitivities in JutulDarcy\",\"link\":\"/examples/intro_sensitivities\"},{\"text\":\"Intro: Compositional flow\",\"link\":\"/examples/co2_brine_2d_vertical\"}]},{\"text\":\"Examples: Usage\",\"collapsed\":false,\"items\":[{\"text\":\"Quarter-five-spot with variation\",\"link\":\"/examples/five_spot_ensemble\"},{\"text\":\"Gravity circulation with CPR preconditioner\",\"link\":\"/examples/two_phase_unstable_gravity\"},{\"text\":\"CO2 property calculations\",\"link\":\"/examples/co2_props\"},{\"text\":\"CO2 injection in saline aquifer\",\"link\":\"/examples/co2_sloped\"},{\"text\":\"Compositional with five components\",\"link\":\"/examples/compositional_5components\"},{\"text\":\"Parameter matching of Buckley-Leverett\",\"link\":\"/examples/optimize_simple_bl\"}]},{\"text\":\"Examples: Validation\",\"collapsed\":false,\"items\":[{\"text\":\"Validation: SPE1\",\"link\":\"/examples/validation_spe1\"},{\"text\":\"Validation: SPE9\",\"link\":\"/examples/validation_spe9\"},{\"text\":\"Validation: Compositional\",\"link\":\"/examples/validation_compositional\"},{\"text\":\"Validation: Egg\",\"link\":\"/examples/validation_egg\"},{\"text\":\"Validation: OLYMPUS 1\",\"link\":\"/examples/validation_olympus_1\"},{\"text\":\"Validation: Norne\",\"link\":\"/examples/validation_norne_nohyst\"},{\"text\":\"Validation: MRST input files\",\"link\":\"/examples/validation_mrst\"}]}],\"editLink\":{\"pattern\":\"https://https://github.com/sintefmath/JutulDarcy.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/sintefmath/JutulDarcy.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2024.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>