import{_ as a,c as i,a5 as n,o as e}from"./chunks/framework.BgSDnNIf.js";const p="/JutulDarcy.jl/previews/PR62/assets/mafaael.BZSLuU-H.jpeg",t="/JutulDarcy.jl/previews/PR62/assets/btimwnx.DimKk99R.jpeg",c=JSON.parse('{"title":"Gravity circulation with CPR preconditioner","description":"","frontmatter":{},"headers":[],"relativePath":"examples/two_phase_unstable_gravity.md","filePath":"examples/two_phase_unstable_gravity.md","lastUpdated":null}'),l={name:"examples/two_phase_unstable_gravity.md"};function h(k,s,r,d,E,o){return e(),i("div",null,s[0]||(s[0]=[n(`<h1 id="Gravity-circulation-with-CPR-preconditioner" tabindex="-1">Gravity circulation with CPR preconditioner <a class="header-anchor" href="#Gravity-circulation-with-CPR-preconditioner" aria-label="Permalink to &quot;Gravity circulation with CPR preconditioner {#Gravity-circulation-with-CPR-preconditioner}&quot;">​</a></h1><p>This example demonstrates a more complex gravity driven instability. The problem is a bit larger than the <a href="/JutulDarcy.jl/previews/PR62/examples/two_phase_gravity_segregation#Gravity-segregation-example">Gravity segregation example</a>, and is therefore set up using the high level API that automatically sets up an iterative linear solver with a constrained pressure residual (CPR) preconditioner and automatic timestepping.</p><p>The high level API uses the more low level <code>Jutul</code> API seen in the other examples under the hood and makes more complex problems easy to set up. The same data structures and functions are used, allowing for deep customization if the defaults are not appropriate.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cmap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seismic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="Define-the-domain" tabindex="-1">Define the domain <a class="header-anchor" href="#Define-the-domain" aria-label="Permalink to &quot;Define the domain {#Define-the-domain}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CartesianMesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((nx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nz), (D, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, D))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(g)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DataDomain wrapping CartesianMesh (3D) with 100x1x100=10000 cells with 17 data fields added:</span></span>
<span class="line"><span>  10000 Cells</span></span>
<span class="line"><span>    :permeability =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :porosity =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :rock_thermal_conductivity =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :fluid_thermal_conductivity =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :rock_density =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>    :cell_centroids =&gt; 3×10000 Matrix{Float64}</span></span>
<span class="line"><span>    :volumes =&gt; 10000 Vector{Float64}</span></span>
<span class="line"><span>  19800 Faces</span></span>
<span class="line"><span>    :neighbors =&gt; 2×19800 Matrix{Int64}</span></span>
<span class="line"><span>    :areas =&gt; 19800 Vector{Float64}</span></span>
<span class="line"><span>    :normals =&gt; 3×19800 Matrix{Float64}</span></span>
<span class="line"><span>    :face_centroids =&gt; 3×19800 Matrix{Float64}</span></span>
<span class="line"><span>  39600 HalfFaces</span></span>
<span class="line"><span>    :half_face_cells =&gt; 39600 Vector{Int64}</span></span>
<span class="line"><span>    :half_face_faces =&gt; 39600 Vector{Int64}</span></span>
<span class="line"><span>  20400 BoundaryFaces</span></span>
<span class="line"><span>    :boundary_areas =&gt; 20400 Vector{Float64}</span></span>
<span class="line"><span>    :boundary_centroids =&gt; 3×20400 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_normals =&gt; 3×20400 Matrix{Float64}</span></span>
<span class="line"><span>    :boundary_neighbors =&gt; 20400 Vector{Int64}</span></span></code></pre></div><h2 id="Set-up-model-and-properties" tabindex="-1">Set up model and properties <a class="header-anchor" href="#Set-up-model-and-properties" aria-label="Permalink to &quot;Set up model and properties {#Set-up-model-and-properties}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Darcy, bar, kg, meter, day </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_units</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:darcy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:kilogram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:meter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoLS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Definition of fluid phases</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rhoVS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 500.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cl, cv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L, V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LiquidPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VaporPhase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ImmiscibleSystem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([L, V])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, sys)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ConstantCompressibilityDensities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sys, p0, [rhoLS, rhoVS], [cl, cv]) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Replace density with a lighter pair</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">replace_variables!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, PhaseMassDensities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> density);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BrooksCoreyRelativePermeabilities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sys, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">replace_variables!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, RelativePermeabilities </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kr)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MultiModel with 1 models and 0 cross-terms. 20000 equations, 20000 degrees of freedom and 69600 parameters.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  models:</span></span>
<span class="line"><span>    1) Reservoir (20000x20000)</span></span>
<span class="line"><span>       ImmiscibleSystem with LiquidPhase, VaporPhase</span></span>
<span class="line"><span>       ∈ MinimalTPFATopology (10000 cells, 19800 faces)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Model storage will be optimized for runtime performance.</span></span></code></pre></div><h3 id="Define-initial-saturation" tabindex="-1">Define initial saturation <a class="header-anchor" href="#Define-initial-saturation" aria-label="Permalink to &quot;Define initial saturation {#Define-initial-saturation}&quot;">​</a></h3><p>Set the left part of the domain to be filled by the vapor phase and the heavy liquid phase in the remainder. To do this, we grab the cell centroids in the x direction from the domain, reshape them to the structured mesh we are working on and define the liquid saturation from there.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> domain[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:cell_centroids</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(c[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plane </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x[i, j]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sL[i, j] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> clamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plane), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatmap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sL, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap, axis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Initial saturation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span></code></pre></div><p><img src="`+p+`" alt=""></p><h3 id="Set-up-initial-state" tabindex="-1">Set up initial state <a class="header-anchor" href="#Set-up-initial-state" aria-label="Permalink to &quot;Set up initial state {#Set-up-initial-state}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sL)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sV </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> .-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sV, sL)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, Pressure </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p0, Saturations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> s0)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Dict{Any, Any} with 1 entry:</span></span>
<span class="line"><span>  :Reservoir =&gt; Dict{Symbol, Any}(:PhaseMassMobilities=&gt;[0.0 0.0 … 0.0 0.0; 0.0…</span></span></code></pre></div><h3 id="Set-the-viscosity-of-the-phases" tabindex="-1">Set the viscosity of the phases <a class="header-anchor" href="#Set-the-viscosity-of-the-phases" aria-label="Permalink to &quot;Set the viscosity of the phases {#Set-the-viscosity-of-the-phases}&quot;">​</a></h3><p>By default, viscosity is a parameter and can be set per-phase and per cell.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">μ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:PhaseViscosities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> μ[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> μ[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5e-3</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>10000-element view(::Matrix{Float64}, 2, :) with eltype Float64:</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> ⋮</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span>
<span class="line"><span> 0.005</span></span></code></pre></div><p>Convert time-steps from days to seconds</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timesteps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> repeat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3600</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_, states, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state0, model, timesteps, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> parameters, info_level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\x1B[92;1mJutul:\x1B[0m Simulating 28 weeks, 4 days as 20 report steps</span></span>
<span class="line"><span>\x1B[34;1mStep  1/20:\x1B[0m Solving start to 1 week, 3 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>┌ Warning: Exception occured in solve: ErrorException(&quot;Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.6779569363968585, rel. value 699.6097521990633. rtol = 0.005, atol = 1.0e-12, max_it = 50&quot;). Attempting to cut time-step since failure_cuts_timestep = true.</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/awbiL/src/simulator/simulator.jl:457</span></span>
<span class="line"><span>┌ Warning: Exception occurred in perform_step!</span></span>
<span class="line"><span>│   inner_exception = Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.6779569363968585, rel. value 699.6097521990633. rtol = 0.005, atol = 1.0e-12, max_it = 50</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/awbiL/src/simulator/simulator.jl:529</span></span>
<span class="line"><span>\x1B[33;1mConvergence:\x1B[0m Report step 1, mini-step #1 (1 day) failed to converge. Reducing mini-step.</span></span>
<span class="line"><span>┌ Warning: Exception occured in solve: ErrorException(&quot;Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.4073443575463845, rel. value 420.35425812929736. rtol = 0.005, atol = 1.0e-12, max_it = 50&quot;). Attempting to cut time-step since failure_cuts_timestep = true.</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/awbiL/src/simulator/simulator.jl:457</span></span>
<span class="line"><span>┌ Warning: Exception occurred in perform_step!</span></span>
<span class="line"><span>│   inner_exception = Bad linear solve: Linear solver: maximum number of iterations exceeded, final residual: 0.4073443575463845, rel. value 420.35425812929736. rtol = 0.005, atol = 1.0e-12, max_it = 50</span></span>
<span class="line"><span>└ @ Jutul ~/.julia/packages/Jutul/awbiL/src/simulator/simulator.jl:529</span></span>
<span class="line"><span>\x1B[33;1mConvergence:\x1B[0m Report step 1, mini-step #2 (12 hours) failed to converge. Reducing mini-step.</span></span>
<span class="line"><span>\x1B[34;1mStep  2/20:\x1B[0m Solving 1 week, 3 days to 2 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  3/20:\x1B[0m Solving 2 weeks, 6 days to 4 weeks, 2 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  4/20:\x1B[0m Solving 4 weeks, 2 days to 5 weeks, 5 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  5/20:\x1B[0m Solving 5 weeks, 5 days to 7 weeks, 1 day, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  6/20:\x1B[0m Solving 7 weeks, 1 day to 8 weeks, 4 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  7/20:\x1B[0m Solving 8 weeks, 4 days to 10 weeks, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  8/20:\x1B[0m Solving 10 weeks to 11 weeks, 3 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  9/20:\x1B[0m Solving 11 weeks, 3 days to 12 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 10/20:\x1B[0m Solving 12 weeks, 6 days to 14 weeks, 2 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 11/20:\x1B[0m Solving 14 weeks, 2 days to 15 weeks, 5 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 12/20:\x1B[0m Solving 15 weeks, 5 days to 17 weeks, 1 day, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 13/20:\x1B[0m Solving 17 weeks, 1 day to 18 weeks, 4 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 14/20:\x1B[0m Solving 18 weeks, 4 days to 20 weeks, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 15/20:\x1B[0m Solving 20 weeks to 21 weeks, 3 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 16/20:\x1B[0m Solving 21 weeks, 3 days to 22 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 17/20:\x1B[0m Solving 22 weeks, 6 days to 24 weeks, 2 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 18/20:\x1B[0m Solving 24 weeks, 2 days to 25 weeks, 5 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 19/20:\x1B[0m Solving 25 weeks, 5 days to 27 weeks, 1 day, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep 20/20:\x1B[0m Solving 27 weeks, 1 day to 28 weeks, 4 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[92;1;4mSimulation complete:\x1B[0m Completed 20 report steps in 8 seconds, 437 milliseconds, 70.78 microseconds and 409 iterations.</span></span>
<span class="line"><span>╭────────────────┬──────────┬──────────────┬──────────╮</span></span>
<span class="line"><span>│ Iteration type │ Avg/step │ Avg/ministep │    Total │</span></span>
<span class="line"><span>│                │ 20 steps │ 65 ministeps │ (wasted) │</span></span>
<span class="line"><span>├────────────────┼──────────┼──────────────┼──────────┤</span></span>
<span class="line"><span>│ Newton         │    20.45 │      6.29231 │  409 (2) │</span></span>
<span class="line"><span>│ Linearization  │     23.6 │      7.26154 │  472 (2) │</span></span>
<span class="line"><span>│ Linear solver  │    46.95 │      14.4462 │  939 (0) │</span></span>
<span class="line"><span>│ Precond apply  │     93.9 │      28.8923 │ 1878 (0) │</span></span>
<span class="line"><span>╰────────────────┴──────────┴──────────────┴──────────╯</span></span>
<span class="line"><span>╭───────────────┬─────────┬────────────┬────────╮</span></span>
<span class="line"><span>│ Timing type   │    Each │   Relative │  Total │</span></span>
<span class="line"><span>│               │      ms │ Percentage │      s │</span></span>
<span class="line"><span>├───────────────┼─────────┼────────────┼────────┤</span></span>
<span class="line"><span>│ Properties    │  0.6725 │     3.26 % │ 0.2751 │</span></span>
<span class="line"><span>│ Equations     │  0.8045 │     4.50 % │ 0.3797 │</span></span>
<span class="line"><span>│ Assembly      │  1.0733 │     6.00 % │ 0.5066 │</span></span>
<span class="line"><span>│ Linear solve  │  1.7662 │     8.56 % │ 0.7224 │</span></span>
<span class="line"><span>│ Linear setup  │  7.3299 │    35.53 % │ 2.9979 │</span></span>
<span class="line"><span>│ Precond apply │  0.8295 │    18.46 % │ 1.5577 │</span></span>
<span class="line"><span>│ Update        │  0.1922 │     0.93 % │ 0.0786 │</span></span>
<span class="line"><span>│ Convergence   │  0.1928 │     1.08 % │ 0.0910 │</span></span>
<span class="line"><span>│ Input/Output  │  0.1970 │     0.15 % │ 0.0128 │</span></span>
<span class="line"><span>│ Other         │  4.4383 │    21.52 % │ 1.8153 │</span></span>
<span class="line"><span>├───────────────┼─────────┼────────────┼────────┤</span></span>
<span class="line"><span>│ Total         │ 20.6285 │   100.00 % │ 8.4371 │</span></span>
<span class="line"><span>╰───────────────┴─────────┴────────────┴────────╯</span></span></code></pre></div><h2 id="Plot-results" tabindex="-1">Plot results <a class="header-anchor" href="#Plot-results" aria-label="Permalink to &quot;Plot results {#Plot-results}&quot;">​</a></h2><p>Plot initial saturation</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state0[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Before&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatmap!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, tmp, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MakieCore.Heatmap{Tuple{MakieCore.EndPoints{Float32}, MakieCore.EndPoints{Float32}, Matrix{Float32}}}</span></span></code></pre></div><p>Plot intermediate saturation</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">÷</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Half way&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> heatmap!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, tmp, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MakieCore.Heatmap{Tuple{MakieCore.EndPoints{Float32}, MakieCore.EndPoints{Float32}, Matrix{Float32}}}</span></span></code></pre></div><p>Plot final saturation</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reshape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :], nx, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;After&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> heatmap!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, tmp, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmap)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], hm)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f</span></span></code></pre></div><p><img src="`+t+'" alt=""></p><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the JutulDarcy.jl GitHub repository <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/main/examples/two_phase_unstable_gravity.jl" target="_blank" rel="noreferrer">as a script</a>, or as a <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/gh-pages/dev/examples/two_phase_unstable_gravity.ipynb" target="_blank" rel="noreferrer">Notebook</a></p><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p>',38)]))}const y=a(l,[["render",h]]);export{c as __pageData,y as default};
