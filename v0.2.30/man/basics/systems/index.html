<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Supported physical systems · JutulDarcy.jl</title><meta name="title" content="Supported physical systems · JutulDarcy.jl"/><meta property="og:title" content="Supported physical systems · JutulDarcy.jl"/><meta property="twitter:title" content="Supported physical systems · JutulDarcy.jl"/><meta name="description" content="Documentation for JutulDarcy.jl."/><meta property="og:description" content="Documentation for JutulDarcy.jl."/><meta property="twitter:description" content="Documentation for JutulDarcy.jl."/><meta property="og:url" content="https://sintefmath.github.io/JutulDarcy.jl/man/basics/systems/"/><meta property="twitter:url" content="https://sintefmath.github.io/JutulDarcy.jl/man/basics/systems/"/><link rel="canonical" href="https://sintefmath.github.io/JutulDarcy.jl/man/basics/systems/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="JutulDarcy.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">JutulDarcy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../../">JutulDarcy.jl</a></li><li><a class="tocitem" href="../../intro/">Getting started</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/two_phase_gravity_segregation/">Gravity segregation</a></li><li><a class="tocitem" href="../../../examples/two_phase_buckley_leverett/">Two-phase Buckley-Leverett</a></li><li><a class="tocitem" href="../../../examples/two_phase_unstable_gravity/">Gravity circulation with CPR preconditioner</a></li><li><a class="tocitem" href="../../../examples/wells_intro/">Intro to wells</a></li><li><a class="tocitem" href="../../../examples/intro_sensitivities/">Intro to sensitivities in JutulDarcy</a></li><li><a class="tocitem" href="../../../examples/co2_sloped/">CO2 injection in saline aquifer</a></li><li><a class="tocitem" href="../../../examples/data_input_file/">Simulating Eclipse/DATA input files</a></li><li><a class="tocitem" href="../../../examples/five_spot_ensemble/">Quarter-five-spot with variation</a></li><li><a class="tocitem" href="../../../examples/co2_brine_2d_vertical/">Intro to compositional flow</a></li><li><a class="tocitem" href="../../../examples/compositional_5components/">Compositional with five components</a></li><li><a class="tocitem" href="../../../examples/optimize_simple_bl/">Parameter optimization of Buckley-Leverett</a></li><li><a class="tocitem" href="../../../examples/validation_spe1/">Validation: SPE1</a></li><li><a class="tocitem" href="../../../examples/validation_spe9/">Validation: SPE9</a></li><li><a class="tocitem" href="../../../examples/validation_compositional/">Validation: Compositional</a></li><li><a class="tocitem" href="../../../examples/validation_egg/">Validation: Egg</a></li><li><a class="tocitem" href="../../../examples/validation_olympus_1/">Validation: OLYMPUS 1</a></li><li><a class="tocitem" href="../../../examples/validation_norne_nohyst/">Validation: Norne</a></li><li><a class="tocitem" href="../../../examples/validation_mrst/">Validation: MRST input files</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../highlevel/">High-level API</a></li><li><a class="tocitem" href="../input_files/">Input formats</a></li><li><a class="tocitem" href="../forces/">Driving forces</a></li><li class="is-active"><a class="tocitem" href>Supported physical systems</a><ul class="internal"><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li><li><a class="tocitem" href="#Single-phase-flow"><span>Single-phase flow</span></a></li><li><a class="tocitem" href="#Multi-phase,-immiscible-flow"><span>Multi-phase, immiscible flow</span></a></li><li><a class="tocitem" href="#Black-oil:-Multi-phase,-pseudo-compositional-flow"><span>Black-oil: Multi-phase, pseudo-compositional flow</span></a></li><li><a class="tocitem" href="#Compositional:-Multi-phase,-multi-component-flow"><span>Compositional: Multi-phase, multi-component flow</span></a></li><li><a class="tocitem" href="#Multi-phase-thermal-flow"><span>Multi-phase thermal flow</span></a></li></ul></li><li><a class="tocitem" href="../wells/">Wells and controls</a></li><li><a class="tocitem" href="../solution/">Solving the equations</a></li><li><a class="tocitem" href="../primary/">Primary variables</a></li><li><a class="tocitem" href="../secondary/">Secondary variables (properties)</a></li><li><a class="tocitem" href="../parameters/">Parameters</a></li><li><a class="tocitem" href="../plotting/">Plotting and visualization</a></li></ul></li><li><span class="tocitem">Advanced usage</span><ul><li><a class="tocitem" href="../../advanced/mpi/">Multi-threading and MPI support</a></li><li><a class="tocitem" href="../../advanced/compiled/">Standalone reservoir simulator</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../../ref/jutul/">Jutul functions</a></li></ul></li><li><span class="tocitem">Additional information </span><ul><li><a class="tocitem" href="../../../extras/refs/">References</a></li><li><a class="tocitem" href="../../../extras/faq/">FAQ</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Supported physical systems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Supported physical systems</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sintefmath/JutulDarcy.jl/blob/main/docs/src/man/basics/systems.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Supported-physical-systems"><a class="docs-heading-anchor" href="#Supported-physical-systems">Supported physical systems</a><a id="Supported-physical-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Supported-physical-systems" title="Permalink"></a></h1><p>JutulDarcy supports a number of different systems. These are <a href="https://sintefmath.github.io/Jutul.jl/dev/usage/#Jutul.JutulSystem"><code>JutulSystem</code></a> instances that describe a particular type of physics for porous media flow. We describe these in roughly the order of complexity that they can model.</p><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>The general form of the flow systems we will discuss is a conservation law for <span>$N$</span> components on residual form:</p><p class="math-container">\[R = \frac{\partial}{\partial t} M_i + \nabla \cdot \vec{V}_i - Q_i, \quad \forall i \in \{1, \dots, N\}\]</p><p>Here, <span>$M_i$</span> is the conserved quantity (usually masses) for component <span>$i$</span> and <span>$\vec{V}_i$</span> the velocity of the conserved quantity. <span>$Q_i$</span> represents source terms that come from direct sources <a href="../forces/#JutulDarcy.SourceTerm"><code>SourceTerm</code></a>, boundary conditions (<a href="../forces/#JutulDarcy.FlowBoundaryCondition"><code>FlowBoundaryCondition</code></a>) or from wells (<a href="../../highlevel/#JutulDarcy.setup_well"><code>setup_well</code></a>, <a href="../../highlevel/#JutulDarcy.setup_vertical_well"><code>setup_vertical_well</code></a>).</p><p>The following table gives an overview of the available features that are described in more detail below:</p><table><tr><th style="text-align: right">System</th><th style="text-align: right">Number of phases</th><th style="text-align: right">Number of components</th><th style="text-align: right"><span>$M$</span></th><th style="text-align: right"><span>$V$</span></th></tr><tr><td style="text-align: right"><a href="#JutulDarcy.SinglePhaseSystem"><code>SinglePhaseSystem</code></a></td><td style="text-align: right">1</td><td style="text-align: right">1</td><td style="text-align: right"><span>$\rho \phi$</span></td><td style="text-align: right"><span>$\rho \vec{v}$</span></td></tr><tr><td style="text-align: right"><a href="#JutulDarcy.ImmiscibleSystem"><code>ImmiscibleSystem</code></a></td><td style="text-align: right">Any</td><td style="text-align: right">(Any)</td><td style="text-align: right"><span>$S_\alpha \rho_\alpha \phi$</span></td><td style="text-align: right"><span>$\rho_\alpha \vec{v}_\alpha$</span></td></tr><tr><td style="text-align: right"><a href="#JutulDarcy.StandardBlackOilSystem"><code>StandardBlackOilSystem</code></a></td><td style="text-align: right">2-3</td><td style="text-align: right">(2-3)</td><td style="text-align: right"><span>$\rho_o^s(b_g S_g + R_s b_o S_o)$</span></td><td style="text-align: right"><span>$b_g \vec{v}_g + R_s b_g \vec{v}_o$</span></td></tr><tr><td style="text-align: right"><a href="#JutulDarcy.MultiPhaseCompositionalSystemLV"><code>MultiPhaseCompositionalSystemLV</code></a></td><td style="text-align: right">2-3</td><td style="text-align: right">Any</td><td style="text-align: right"><span>$\rho_l X_i S_l + \rho_v Y_i S_v$</span></td><td style="text-align: right"><span>$\rho_l X_i \vec{v}_l + \rho_v Y_i \vec{v}_v$</span></td></tr></table><h3 id="Phases"><a class="docs-heading-anchor" href="#Phases">Phases</a><a id="Phases-1"></a><a class="docs-heading-anchor-permalink" href="#Phases" title="Permalink"></a></h3><p>Phases are defined using specific types. Some constructors take a list of phases present in the model. Phases do not contain any data themselves and the distinction between different phases applies primarily for well controls.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.LiquidPhase" href="#JutulDarcy.LiquidPhase"><code>JutulDarcy.LiquidPhase</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LiquidPhase()</code></pre><p><code>AbstractPhase</code> subtype for liquid-like phases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/multiphase.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.AqueousPhase" href="#JutulDarcy.AqueousPhase"><code>JutulDarcy.AqueousPhase</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AqueousPhase()</code></pre><p><code>AbstractPhase</code> subtype for water-like phases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/multiphase.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.VaporPhase" href="#JutulDarcy.VaporPhase"><code>JutulDarcy.VaporPhase</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VaporPhase()</code></pre><p><code>AbstractPhase</code> subtype for vapor or gaseous phases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/multiphase.jl#L51-L55">source</a></section></article><h3 id="Implementation-details"><a class="docs-heading-anchor" href="#Implementation-details">Implementation details</a><a id="Implementation-details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-details" title="Permalink"></a></h3><p>In the above the discrete version of <span>$M_i$</span> is implemented in the update function for <a href="#JutulDarcy.TotalMasses"><code>JutulDarcy.TotalMasses</code></a> that should by convention be named <a href="#JutulDarcy.update_total_masses!"><code>JutulDarcy.update_total_masses!</code></a>. The discrete component fluxes are implemented by <a href="#JutulDarcy.component_mass_fluxes!"><code>JutulDarcy.component_mass_fluxes!</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.TotalMasses" href="#JutulDarcy.TotalMasses"><code>JutulDarcy.TotalMasses</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TotalMasses()</code></pre><p>Variable that defines total component masses in each cell of the domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/multiphase.jl#L149-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.update_total_masses!" href="#JutulDarcy.update_total_masses!"><code>JutulDarcy.update_total_masses!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_total_masses!(totmass, tv, model, arg..., ix)</code></pre><p>Update total masses for a given system. Number of input arguments varies based on physical system under consideration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/flux.jl#L190-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.component_mass_fluxes!" href="#JutulDarcy.component_mass_fluxes!"><code>JutulDarcy.component_mass_fluxes!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">component_mass_fluxes!(q, face, state, model, flux_type, kgrad, upw)</code></pre><p>Implementation of component fluxes for a given system for a given face. Should return a <code>StaticVector</code> with one entry per component.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/flux.jl#L177-L185">source</a></section></article><p>The source terms are implemented by <a href="#Jutul.apply_forces_to_equation!"><code>Jutul.apply_forces_to_equation!</code></a> for boundary conditions and sources, and <a href="@ref"><code>Jutul.update_cross_term_in_entity!</code></a> for wells. We use Julia&#39;s multiple dispatch to pair the right implementation with the right physics system.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Jutul.apply_forces_to_equation!" href="#Jutul.apply_forces_to_equation!"><code>Jutul.apply_forces_to_equation!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_forces_to_equation!(diag_part, storage, model, eq, eq_s, force, time)</code></pre><p>Update an equation with the effect of a force. The default behavior for any force we do not know about is to assume that the force does not impact this particular equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/Jutul.jl/blob/v0.2.37/src/equations.jl#L570-L576">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Jutul.update_cross_term_in_entity!</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Single-phase-flow"><a class="docs-heading-anchor" href="#Single-phase-flow">Single-phase flow</a><a id="Single-phase-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Single-phase-flow" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SinglePhaseSystem" href="#JutulDarcy.SinglePhaseSystem"><code>JutulDarcy.SinglePhaseSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SinglePhaseSystem(phase = LiquidPhase(); reference_density = 1.0)</code></pre><p>A single-phase system that only solves for pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/types.jl#L219-L223">source</a></section></article><p>The simplest form of porous media flow is the single-phase system.</p><p class="math-container">\[r(p) = \frac{\partial}{\partial t}( \rho \phi) + \nabla \cdot (\rho \vec{v}) - \rho q\]</p><p><span>$\rho$</span> is the phase mass density and <span>$\phi$</span> the apparent porosity of the medium, i.e. the void space in the rock available to flow. Where the velocity <span>$\vec{v}$</span> is given by Darcy&#39;s law that relates the the pressure gradient <span>$\nabla p$</span> and hydrostatic head to the velocity field:</p><p class="math-container">\[\vec{v} = - \frac{\mathbf{K}}{\mu} (\nabla p + \rho g \nabla z)\]</p><p>Here, <span>$\mathbf{K}$</span> is a positive-definite permeability tensor, <span>$\mu$</span> the fluid viscosity, <span>$g$</span> the magnitude of gravity oriented down and <span>$z$</span> the depth.</p><div class="admonition is-info"><header class="admonition-header">Single-phase implementation</header><div class="admonition-body"><p>The <a href="#JutulDarcy.SinglePhaseSystem"><code>SinglePhaseSystem</code></a> is a dedicated single phase system. This is mathematically equivalent to an <a href="#JutulDarcy.ImmiscibleSystem"><code>ImmiscibleSystem</code></a> when set up with a single phase. For single phase flow, the fluid <a href="../../../examples/compositional_5components/#Pressure"><code>Pressure</code></a> is the primary variable in each cell. The equation supports two types of compressibility: That of the fluid where density is a function <span>$\rho(p)$</span> of pressure and that of the pores where the porosity <span>$\phi(p)$</span> changes with pressure.</p></div></div><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>JutulDarcy uses the notion of depth rather than coordinate when defining buoyancy forces. This is consistent with the convention in the literature on subsurface flow.</p></div></div><h2 id="Multi-phase,-immiscible-flow"><a class="docs-heading-anchor" href="#Multi-phase,-immiscible-flow">Multi-phase, immiscible flow</a><a id="Multi-phase,-immiscible-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-phase,-immiscible-flow" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.ImmiscibleSystem" href="#JutulDarcy.ImmiscibleSystem"><code>JutulDarcy.ImmiscibleSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ImmiscibleSystem(phases; reference_densities = ones(length(phases)))
ImmiscibleSystem((LiquidPhase(), VaporPhase()), reference_densities = (1000.0, 700.0))</code></pre><p>Immiscible flow system: Each component exists only in a single phase, and the number of components equal the number of phases.</p><p>Set up an immiscible system for the given phases with optional reference densitites. This system is easy to specify with <a href="../../../examples/compositional_5components/#Pressure">Pressure</a> and <a href="../primary/#JutulDarcy.Saturations">Saturations</a> as the default primary variables. Immiscible system assume that there is no mass transfer between phases and that a phase is uniform in composition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/types.jl#L190-L202">source</a></section></article><p>The flow systems immediately become more interesting if we add more phases. We can extend the above single-phase system by introducing the phase saturation of phase with label <span>$\alpha$</span> as <span>$S_\alpha$</span>. The phase saturation represents the volumetric fraction of the rock void space occupied by the phase. If we consider a pair of phases <span>$\{n, w\}$</span> non-wetting and wetting we can write the system as</p><p class="math-container">\[r_\alpha = \frac{\partial}{\partial t} (S_\alpha \rho_\alpha \phi) + \nabla \cdot (\rho_\alpha \vec{v}_\alpha) - \rho_\alpha q_\alpha = 0, \quad \alpha \in \{n, w\}\]</p><p>This requires an additional closure such that the amount of saturation of all phases exactly fills the available fluid volume:</p><p class="math-container">\[S_w + S_n = 1, \quad 1 \ge S_\alpha \ge 0 \quad \alpha \in \{n, w\}\]</p><p>This equation is local and linear in the saturations and can be eliminated to produce the classical two-equation system for two-phase flow,</p><p class="math-container">\[r_n = \frac{\partial}{\partial t} ((1 - S_w) \rho_n \phi) + \nabla \cdot (\rho_n \vec{v}_n) - \rho_n q_n = 0,\\
r_w = \frac{\partial}{\partial t} (S_w \rho_w \phi) + \nabla \cdot (\rho_w \vec{v}_w) - \rho_w q_w = 0.\]</p><p>To complete this description we also need expressions for the phase fluxes. We use the standard multiphase extension of Darcy&#39;s law,</p><p class="math-container">\[\vec{v}_\alpha = - \mathbf{K} \frac{k_{r\alpha}}{\mu_\alpha} (\nabla p\alpha + \rho_\alpha g \nabla z)\]</p><p>Here, we have introduced the relative permeability of the phase <span>$k_{r\alpha}$</span>, an empirical relationship between the saturation and the flow rate. Relative permeability is a complex topic with many different relationships and functional forms, but we limit the discussion to monotone, non-negative functions of their respective saturations, for example a simple Brooks-Corey type of <span>$k_{r\alpha}(S_\alpha) = S_\alpha^2$</span>. We have also introduced separate phase pressures <span>$p_\alpha$</span> that account for capillary pressure, e.g. <span>$p_w = p_n + p_c(S_w)$</span>.</p><h3 id="Primary-variables"><a class="docs-heading-anchor" href="#Primary-variables">Primary variables</a><a id="Primary-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Primary-variables" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Immiscible implementation</header><div class="admonition-body"><p>The <a href="#JutulDarcy.ImmiscibleSystem"><code>ImmiscibleSystem</code></a> implements this system for any number of phases. The primary variables for this system is a single reference <a href="../../../examples/compositional_5components/#Pressure"><code>Pressure</code></a> and phase <a href="../primary/#JutulDarcy.Saturations"><code>Saturations</code></a>. As we do not solve for the volume closure equation, there is one less degree of freedom associated with the saturations than there are number of phases.</p></div></div><h2 id="Black-oil:-Multi-phase,-pseudo-compositional-flow"><a class="docs-heading-anchor" href="#Black-oil:-Multi-phase,-pseudo-compositional-flow">Black-oil: Multi-phase, pseudo-compositional flow</a><a id="Black-oil:-Multi-phase,-pseudo-compositional-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Black-oil:-Multi-phase,-pseudo-compositional-flow" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.StandardBlackOilSystem" href="#JutulDarcy.StandardBlackOilSystem"><code>JutulDarcy.StandardBlackOilSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StandardBlackOilSystem(; rs_max = nothing,
                         rv_max = nothing,
                         phases = (AqueousPhase(), LiquidPhase(), VaporPhase()),
                         reference_densities = [786.507, 1037.84, 0.969758])</code></pre><p>Set up a standard black-oil system. Keyword arguments <code>rs_max</code> and <code>rv_max</code> can either be nothing or callable objects / functions for the maximum Rs and Rv as a function of pressure. <code>phases</code> can be specified together with <code>reference_densities</code> for each phase.</p><p>NOTE: For the black-oil model, the reference densities significantly impact many aspects of the PVT behavior. These should generally be set consistently with the other properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/types.jl#L90-L104">source</a></section></article><p>The black-oil equations is an extension of the immiscible description to handle limited miscibility between the phases. Originally developed for certain types of oil and gas simulation, these equations are useful when the number of components is low and tabulated values for dissolution and vaporization are available.</p><p>The assumptions of the black-oil model is that the &quot;oil&quot; and &quot;gas&quot; pseudo-components have uniform composition throughout the domain. JutulDarcy supports two- and three-phase black oil flow. The difference between two and three phases amounts to an additional immiscible aqueous phase that is identical to that of the previous section. For that reason, we focus on the miscible pseudo-components:</p><p class="math-container">\[r_o = \rho_o^s \left( \frac{\partial}{\partial t}( (b_o S_o + R_v b_g (1 - S_o)) \phi) + \nabla \cdot ( b_o \vec{v}_o + R_v b_o \vec{v}_g) - q_o^s \right ) \\
r_g = \rho_g^s \left( \frac{\partial}{\partial t}( (b_g S_g + R_s b_o S_o) \phi) + \nabla \cdot ( b_g \vec{v}_g + R_s b_g \vec{v}_o) - q_g^s \right )\]</p><p>The model uses the notion of surface (or reference densities) <span>$\rho_o^s, \rho_g^s$</span> to define the densities of the component at specific pressure and temperature conditions where it is assumed that all &quot;gas&quot; has moved to the vapor phase and the defined &quot;oil&quot; is only found in the liquid phase. Keeping this definition in mind, the above equations can be divided by the surface densities to produce a surface volume balance equation where we have defined <code>b_o</code> and <code>b_g</code> as the dimensionless reciprocal formation volume factors that relate a volume at reservoir conditions to surface volumes and <code>R_s</code> for the dissolved volume of gas in the oil phase when brought to surface conditions. <code>R_v</code> is the same definition, but for oil vaporized into the gas phase.</p><div class="admonition is-info"><header class="admonition-header">Blackoil implementation</header><div class="admonition-body"><p>The <a href="#JutulDarcy.StandardBlackOilSystem"><code>StandardBlackOilSystem</code></a> implements the black-oil equations. It is possible to run cases with and without water, with and without <span>$R_s$</span> and with and without <span>$R_v$</span>. The primary variables for the most general case is the reference <a href="../../../examples/compositional_5components/#Pressure"><code>Pressure</code></a>, an <a href="../primary/#JutulDarcy.ImmiscibleSaturation"><code>ImmiscibleSaturation</code></a> for the aqueous phase and the special <a href="../primary/#JutulDarcy.BlackOilUnknown"><code>BlackOilUnknown</code></a> that will represent either <span>$S_o$</span>, <span>$R_s$</span> or <span>$R_v$</span> on a cell-by-cell basis depending on what phases are present and saturated.</p></div></div><p>A full description of the black-oil equations is outside the scope of this documentation. Please see [<a href="../../../extras/refs/#mrst-book-i">1</a>] for more details.</p><h2 id="Compositional:-Multi-phase,-multi-component-flow"><a class="docs-heading-anchor" href="#Compositional:-Multi-phase,-multi-component-flow">Compositional: Multi-phase, multi-component flow</a><a id="Compositional:-Multi-phase,-multi-component-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Compositional:-Multi-phase,-multi-component-flow" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.MultiPhaseCompositionalSystemLV" href="#JutulDarcy.MultiPhaseCompositionalSystemLV"><code>JutulDarcy.MultiPhaseCompositionalSystemLV</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MultiPhaseCompositionalSystemLV(equation_of_state, phases = (LiquidPhase(), VaporPhase()); reference_densities = ones(length(phases)), other_name = &quot;Water&quot;)</code></pre><p>Set up a compositional system for a given <code>equation_of_state</code> from <code>MultiComponentFlash</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/types.jl#L36-L40">source</a></section></article><p>The more general case of multi-component flow is often referred to as a compositional model. The typical version of this model describes the fluid as a system of <span>$N$</span> components where the phases present and fluid properties are determined by an equation-of-state. This can be highly accurate if the equation-of-state is tuned for the mixtures that are encountered, but comes at a significant computational cost as the equation-of-state must be evaluated many times.</p><p>JutulDarcy implements a standard compositional model that assumes local instantaneous equilibrium and that the components are present in up to two phases with an optional immiscible phase added. This is sometimes referred to as a &quot;simple water&quot; or &quot;dead water&quot; description. By default the solvers use <a href="https://github.com/moyner/MultiComponentFlash.jl">MultiComponentFlash.jl</a> to solve thermodynamic equilibrium. This package implements the generalized cubic approach and defaults to Peng-Robinson.</p><p>Assume that we have two phases liquid and vapor referred to as <span>$l$</span> and <span>$v$</span> with the Darcy flux given as in the preceeding sections. We can then write the residual equation for each of the <span>$M$</span> components by the liquid and vapor mole fractions <span>$X_i, Y_i$</span>`of that component as:</p><p class="math-container">\[r_i = \frac{\partial}{\partial t} \left( (\rho_l X_i S_l + \rho_v Y_i S_v) \phi \right) + \nabla \cdot (\rho_l X_i \vec{v}_l + \rho_v Y_i \vec{v}_v) - Q_i, \quad M \in \{1, \dots, M\}\]</p><p>For additional details, please see Chapter 8 - Compositional Simulation with the AD-OO Framework in [<a href="../../../extras/refs/#mrst-book-ii">2</a>].</p><div class="admonition is-info"><header class="admonition-header">Compositional implementation</header><div class="admonition-body"><p>The <a href="#JutulDarcy.MultiPhaseCompositionalSystemLV"><code>MultiPhaseCompositionalSystemLV</code></a> implements the compositional model. The primary variables for the most general case is the reference <a href="../../../examples/compositional_5components/#Pressure"><code>Pressure</code></a>, an <a href="../primary/#JutulDarcy.ImmiscibleSaturation"><code>ImmiscibleSaturation</code></a> for the optional immiscible phase and <span>$M-1$</span> <a href="../primary/#JutulDarcy.OverallMoleFractions"><code>OverallMoleFractions</code></a>.</p></div></div><h2 id="Multi-phase-thermal-flow"><a class="docs-heading-anchor" href="#Multi-phase-thermal-flow">Multi-phase thermal flow</a><a id="Multi-phase-thermal-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-phase-thermal-flow" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.reservoir_system" href="#JutulDarcy.reservoir_system"><code>JutulDarcy.reservoir_system</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reservoir_system(flow = flow_system, thermal = thermal_system)</code></pre><p>Set up a <a href="@ref"><code>Jutul.CompositeSystem</code></a> that combines multiple systems together. In some terminologies this is refered to as a multi-physics system. The classical example is to combine a flow system and a thermal system to create a coupled flow and heat system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/8ecc3cb3f148f96d02ca77dfb79bc71fb8fee6a6/src/utils.jl#L143-L150">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>JutulDarcy.add_thermal_to_model!</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forces/">« Driving forces</a><a class="docs-footer-nextpage" href="../wells/">Wells and controls »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 8 September 2024 18:32">Sunday 8 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
