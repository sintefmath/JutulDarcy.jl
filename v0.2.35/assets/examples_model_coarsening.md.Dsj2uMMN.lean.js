import{_ as a,c as i,a5 as n,o as e}from"./chunks/framework.CJGehonb.js";const p="/JutulDarcy.jl/v0.2.35/assets/qdedtdo.BWC7xQ-9.jpeg",l="/JutulDarcy.jl/v0.2.35/assets/yvzgaby.CigeuZLi.jpeg",t="/JutulDarcy.jl/v0.2.35/assets/mcnptwm.B9LpEozr.jpeg",k="/JutulDarcy.jl/v0.2.35/assets/xdnqblf.BmeVnBY7.jpeg",h="/JutulDarcy.jl/v0.2.35/assets/vagnlan.CBa4DfF5.jpeg",r="/JutulDarcy.jl/v0.2.35/assets/zkjgoso.BuxWQjIw.jpeg",E="/JutulDarcy.jl/v0.2.35/assets/gqkajuu.D4JBcM-d.jpeg",d="/JutulDarcy.jl/v0.2.35/assets/khhfoot.BbGBbULg.jpeg",b=JSON.parse('{"title":"Model coarsening","description":"","frontmatter":{},"headers":[],"relativePath":"examples/model_coarsening.md","filePath":"examples/model_coarsening.md","lastUpdated":null}'),y={name:"examples/model_coarsening.md"};function g(o,s,c,u,F,m){return e(),i("div",null,s[0]||(s[0]=[n(`<h1 id="Model-coarsening" tabindex="-1">Model coarsening <a class="header-anchor" href="#Model-coarsening" aria-label="Permalink to &quot;Model coarsening {#Model-coarsening}&quot;">​</a></h1><p>Running a model at full resolution can be computationally expensive. In many cases, it is possible to coarsen the model to reduce the computational cost. This example demonstrates how to coarsen a model using JutulDarcy.jl. The example uses the Egg model, which is a small oil-water model with heterogeneous permeability. The model is coarsened using different methods and partition sizes, and the results are compared to the fine-scale model. The example demonstrates how to coarsen a model and simulate it using JutulDarcy.jl. The example also demonstrates how to compare the results of the coarse-scale model to the fine-scale model.</p><p>The example is intended to show the workflow of coarsening a model, and represents a starting point for more advanced techniques like upscaling, coarse-model calibration and history matching. The model is therefore intentionally simple and very coarse for quick simulations, and not necessarily accurate model responses.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul, JutulDarcy, HYPRE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GeoEnergyIO</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_dir </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GeoEnergyIO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">test_input_file_path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EGG&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_pth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> joinpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data_dir, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EGG.DATA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fine_case </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_case_from_data_file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data_pth);</span></span></code></pre></div><h2 id="Simulate-the-base-case" tabindex="-1">Simulate the base case <a class="header-anchor" href="#Simulate-the-base-case" aria-label="Permalink to &quot;Simulate the base case {#Simulate-the-base-case}&quot;">​</a></h2><p>We simulate the fine case to get a reference solution to compare against. We also extract the mesh and reservoir for plotting.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fine_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fine_case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fine_reservoir </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fine_mesh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> physical_representation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_reservoir)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws, states </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_case, info_level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\x1B[92;1mJutul:\x1B[0m Simulating 9 years, 44.69 weeks as 135 report steps</span></span>
<span class="line"><span>\x1B[34;1mStep   1/135:\x1B[0m Solving start to 1 day, Δt = 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep   2/135:\x1B[0m Solving 1 day to 5 days, Δt = 4 days</span></span>
<span class="line"><span>\x1B[34;1mStep   3/135:\x1B[0m Solving 5 days to 1 week, 3 days, Δt = 5 days</span></span>
<span class="line"><span>\x1B[34;1mStep   4/135:\x1B[0m Solving 1 week, 3 days to 2 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep   5/135:\x1B[0m Solving 2 weeks, 6 days to 4 weeks, 2 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep   6/135:\x1B[0m Solving 4 weeks, 2 days to 5 weeks, 5 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep   7/135:\x1B[0m Solving 5 weeks, 5 days to 7 weeks, 1 day, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep   8/135:\x1B[0m Solving 7 weeks, 1 day to 8 weeks, 4 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep   9/135:\x1B[0m Solving 8 weeks, 4 days to 10 weeks, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  10/135:\x1B[0m Solving 10 weeks to 11 weeks, 3 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  11/135:\x1B[0m Solving 11 weeks, 3 days to 12 weeks, 6 days, Δt = 1 week, 3 days</span></span>
<span class="line"><span>\x1B[34;1mStep  12/135:\x1B[0m Solving 12 weeks, 6 days to 15 weeks, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  13/135:\x1B[0m Solving 15 weeks to 17 weeks, 1 day, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  14/135:\x1B[0m Solving 17 weeks, 1 day to 19 weeks, 2 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  15/135:\x1B[0m Solving 19 weeks, 2 days to 21 weeks, 3 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  16/135:\x1B[0m Solving 21 weeks, 3 days to 23 weeks, 4 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  17/135:\x1B[0m Solving 23 weeks, 4 days to 25 weeks, 5 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  18/135:\x1B[0m Solving 25 weeks, 5 days to 27 weeks, 6 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  19/135:\x1B[0m Solving 27 weeks, 6 days to 30 weeks, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  20/135:\x1B[0m Solving 30 weeks to 32 weeks, 1 day, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  21/135:\x1B[0m Solving 32 weeks, 1 day to 34 weeks, 2 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  22/135:\x1B[0m Solving 34 weeks, 2 days to 36 weeks, 3 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  23/135:\x1B[0m Solving 36 weeks, 3 days to 38 weeks, 4 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  24/135:\x1B[0m Solving 38 weeks, 4 days to 40 weeks, 5 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  25/135:\x1B[0m Solving 40 weeks, 5 days to 42 weeks, 6 days, Δt = 2 weeks, 1 day</span></span>
<span class="line"><span>\x1B[34;1mStep  26/135:\x1B[0m Solving 42 weeks, 6 days to 47 weeks, 1 day, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  27/135:\x1B[0m Solving 47 weeks, 1 day to 51 weeks, 3 days, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  28/135:\x1B[0m Solving 51 weeks, 3 days to 1 year, 3.537 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  29/135:\x1B[0m Solving 1 year, 3.537 weeks to 1 year, 7.822 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  30/135:\x1B[0m Solving 1 year, 7.822 weeks to 1 year, 12.11 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  31/135:\x1B[0m Solving 1 year, 12.11 weeks to 1 year, 16.39 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  32/135:\x1B[0m Solving 1 year, 16.39 weeks to 1 year, 20.68 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  33/135:\x1B[0m Solving 1 year, 20.68 weeks to 1 year, 24.97 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  34/135:\x1B[0m Solving 1 year, 24.97 weeks to 1 year, 29.25 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  35/135:\x1B[0m Solving 1 year, 29.25 weeks to 1 year, 33.54 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  36/135:\x1B[0m Solving 1 year, 33.54 weeks to 1 year, 37.82 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  37/135:\x1B[0m Solving 1 year, 37.82 weeks to 1 year, 42.11 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  38/135:\x1B[0m Solving 1 year, 42.11 weeks to 1 year, 46.39 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  39/135:\x1B[0m Solving 1 year, 46.39 weeks to 1 year, 50.68 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  40/135:\x1B[0m Solving 1 year, 50.68 weeks to 2 years, 2.788 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  41/135:\x1B[0m Solving 2 years, 2.788 weeks to 2 years, 7.074 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  42/135:\x1B[0m Solving 2 years, 7.074 weeks to 2 years, 11.36 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  43/135:\x1B[0m Solving 2 years, 11.36 weeks to 2 years, 15.64 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  44/135:\x1B[0m Solving 2 years, 15.64 weeks to 2 years, 19.93 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  45/135:\x1B[0m Solving 2 years, 19.93 weeks to 2 years, 24.22 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  46/135:\x1B[0m Solving 2 years, 24.22 weeks to 2 years, 28.5 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  47/135:\x1B[0m Solving 2 years, 28.5 weeks to 2 years, 32.79 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  48/135:\x1B[0m Solving 2 years, 32.79 weeks to 2 years, 37.07 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  49/135:\x1B[0m Solving 2 years, 37.07 weeks to 2 years, 41.36 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  50/135:\x1B[0m Solving 2 years, 41.36 weeks to 2 years, 45.65 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  51/135:\x1B[0m Solving 2 years, 45.65 weeks to 2 years, 49.93 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  52/135:\x1B[0m Solving 2 years, 49.93 weeks to 3 years, 2.039 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  53/135:\x1B[0m Solving 3 years, 2.039 weeks to 3 years, 6.325 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  54/135:\x1B[0m Solving 3 years, 6.325 weeks to 3 years, 10.61 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  55/135:\x1B[0m Solving 3 years, 10.61 weeks to 3 years, 14.9 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  56/135:\x1B[0m Solving 3 years, 14.9 weeks to 3 years, 19.18 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  57/135:\x1B[0m Solving 3 years, 19.18 weeks to 3 years, 23.47 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  58/135:\x1B[0m Solving 3 years, 23.47 weeks to 3 years, 27.75 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  59/135:\x1B[0m Solving 3 years, 27.75 weeks to 3 years, 32.04 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  60/135:\x1B[0m Solving 3 years, 32.04 weeks to 3 years, 36.32 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  61/135:\x1B[0m Solving 3 years, 36.32 weeks to 3 years, 40.61 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  62/135:\x1B[0m Solving 3 years, 40.61 weeks to 3 years, 44.9 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  63/135:\x1B[0m Solving 3 years, 44.9 weeks to 3 years, 49.18 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  64/135:\x1B[0m Solving 3 years, 49.18 weeks to 4 years, 1.29 week, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  65/135:\x1B[0m Solving 4 years, 1.29 week to 4 years, 5.576 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  66/135:\x1B[0m Solving 4 years, 5.576 weeks to 4 years, 9.861 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  67/135:\x1B[0m Solving 4 years, 9.861 weeks to 4 years, 14.15 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  68/135:\x1B[0m Solving 4 years, 14.15 weeks to 4 years, 18.43 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  69/135:\x1B[0m Solving 4 years, 18.43 weeks to 4 years, 22.72 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  70/135:\x1B[0m Solving 4 years, 22.72 weeks to 4 years, 27 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  71/135:\x1B[0m Solving 4 years, 27 weeks to 4 years, 31.29 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  72/135:\x1B[0m Solving 4 years, 31.29 weeks to 4 years, 35.58 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  73/135:\x1B[0m Solving 4 years, 35.58 weeks to 4 years, 39.86 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  74/135:\x1B[0m Solving 4 years, 39.86 weeks to 4 years, 44.15 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  75/135:\x1B[0m Solving 4 years, 44.15 weeks to 4 years, 48.43 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  76/135:\x1B[0m Solving 4 years, 48.43 weeks to 5 years, 3.788 days, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  77/135:\x1B[0m Solving 5 years, 3.788 days to 5 years, 4.827 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  78/135:\x1B[0m Solving 5 years, 4.827 weeks to 5 years, 9.113 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  79/135:\x1B[0m Solving 5 years, 9.113 weeks to 5 years, 13.4 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  80/135:\x1B[0m Solving 5 years, 13.4 weeks to 5 years, 17.68 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  81/135:\x1B[0m Solving 5 years, 17.68 weeks to 5 years, 21.97 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  82/135:\x1B[0m Solving 5 years, 21.97 weeks to 5 years, 26.26 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  83/135:\x1B[0m Solving 5 years, 26.26 weeks to 5 years, 30.54 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  84/135:\x1B[0m Solving 5 years, 30.54 weeks to 5 years, 34.83 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  85/135:\x1B[0m Solving 5 years, 34.83 weeks to 5 years, 39.11 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  86/135:\x1B[0m Solving 5 years, 39.11 weeks to 5 years, 43.4 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  87/135:\x1B[0m Solving 5 years, 43.4 weeks to 5 years, 47.68 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  88/135:\x1B[0m Solving 5 years, 47.68 weeks to 5 years, 51.97 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  89/135:\x1B[0m Solving 5 years, 51.97 weeks to 6 years, 4.078 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  90/135:\x1B[0m Solving 6 years, 4.078 weeks to 6 years, 8.364 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  91/135:\x1B[0m Solving 6 years, 8.364 weeks to 6 years, 12.65 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  92/135:\x1B[0m Solving 6 years, 12.65 weeks to 6 years, 16.93 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  93/135:\x1B[0m Solving 6 years, 16.93 weeks to 6 years, 21.22 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  94/135:\x1B[0m Solving 6 years, 21.22 weeks to 6 years, 25.51 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  95/135:\x1B[0m Solving 6 years, 25.51 weeks to 6 years, 29.79 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  96/135:\x1B[0m Solving 6 years, 29.79 weeks to 6 years, 34.08 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  97/135:\x1B[0m Solving 6 years, 34.08 weeks to 6 years, 38.36 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  98/135:\x1B[0m Solving 6 years, 38.36 weeks to 6 years, 42.65 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep  99/135:\x1B[0m Solving 6 years, 42.65 weeks to 6 years, 46.94 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 100/135:\x1B[0m Solving 6 years, 46.94 weeks to 6 years, 51.22 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 101/135:\x1B[0m Solving 6 years, 51.22 weeks to 7 years, 3.329 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 102/135:\x1B[0m Solving 7 years, 3.329 weeks to 7 years, 7.615 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 103/135:\x1B[0m Solving 7 years, 7.615 weeks to 7 years, 11.9 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 104/135:\x1B[0m Solving 7 years, 11.9 weeks to 7 years, 16.19 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 105/135:\x1B[0m Solving 7 years, 16.19 weeks to 7 years, 20.47 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 106/135:\x1B[0m Solving 7 years, 20.47 weeks to 7 years, 24.76 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 107/135:\x1B[0m Solving 7 years, 24.76 weeks to 7 years, 29.04 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 108/135:\x1B[0m Solving 7 years, 29.04 weeks to 7 years, 33.33 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 109/135:\x1B[0m Solving 7 years, 33.33 weeks to 7 years, 37.61 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 110/135:\x1B[0m Solving 7 years, 37.61 weeks to 7 years, 41.9 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 111/135:\x1B[0m Solving 7 years, 41.9 weeks to 7 years, 46.19 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 112/135:\x1B[0m Solving 7 years, 46.19 weeks to 7 years, 50.47 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 113/135:\x1B[0m Solving 7 years, 50.47 weeks to 8 years, 2.58 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 114/135:\x1B[0m Solving 8 years, 2.58 weeks to 8 years, 6.866 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 115/135:\x1B[0m Solving 8 years, 6.866 weeks to 8 years, 11.15 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 116/135:\x1B[0m Solving 8 years, 11.15 weeks to 8 years, 15.44 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 117/135:\x1B[0m Solving 8 years, 15.44 weeks to 8 years, 19.72 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 118/135:\x1B[0m Solving 8 years, 19.72 weeks to 8 years, 24.01 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 119/135:\x1B[0m Solving 8 years, 24.01 weeks to 8 years, 28.29 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 120/135:\x1B[0m Solving 8 years, 28.29 weeks to 8 years, 32.58 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 121/135:\x1B[0m Solving 8 years, 32.58 weeks to 8 years, 36.87 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 122/135:\x1B[0m Solving 8 years, 36.87 weeks to 8 years, 41.15 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 123/135:\x1B[0m Solving 8 years, 41.15 weeks to 8 years, 45.44 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 124/135:\x1B[0m Solving 8 years, 45.44 weeks to 8 years, 49.72 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 125/135:\x1B[0m Solving 8 years, 49.72 weeks to 9 years, 1.831 week, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 126/135:\x1B[0m Solving 9 years, 1.831 week to 9 years, 6.117 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 127/135:\x1B[0m Solving 9 years, 6.117 weeks to 9 years, 10.4 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 128/135:\x1B[0m Solving 9 years, 10.4 weeks to 9 years, 14.69 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 129/135:\x1B[0m Solving 9 years, 14.69 weeks to 9 years, 18.97 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 130/135:\x1B[0m Solving 9 years, 18.97 weeks to 9 years, 23.26 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 131/135:\x1B[0m Solving 9 years, 23.26 weeks to 9 years, 27.55 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 132/135:\x1B[0m Solving 9 years, 27.55 weeks to 9 years, 31.83 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 133/135:\x1B[0m Solving 9 years, 31.83 weeks to 9 years, 36.12 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 134/135:\x1B[0m Solving 9 years, 36.12 weeks to 9 years, 40.4 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[34;1mStep 135/135:\x1B[0m Solving 9 years, 40.4 weeks to 9 years, 44.69 weeks, Δt = 4 weeks, 2 days</span></span>
<span class="line"><span>\x1B[92;1;4mSimulation complete:\x1B[0m Completed 135 report steps in 29 seconds, 190 milliseconds, 831.8 microseconds and 543 iterations.</span></span>
<span class="line"><span>╭────────────────┬───────────┬───────────────┬──────────╮</span></span>
<span class="line"><span>│ Iteration type │  Avg/step │  Avg/ministep │    Total │</span></span>
<span class="line"><span>│                │ 135 steps │ 162 ministeps │ (wasted) │</span></span>
<span class="line"><span>├────────────────┼───────────┼───────────────┼──────────┤</span></span>
<span class="line"><span>│ Newton         │   4.02222 │       3.35185 │  543 (0) │</span></span>
<span class="line"><span>│ Linearization  │   5.22222 │       4.35185 │  705 (0) │</span></span>
<span class="line"><span>│ Linear solver  │   18.5556 │        15.463 │ 2505 (0) │</span></span>
<span class="line"><span>│ Precond apply  │   37.1111 │       30.9259 │ 5010 (0) │</span></span>
<span class="line"><span>╰────────────────┴───────────┴───────────────┴──────────╯</span></span>
<span class="line"><span>╭───────────────┬─────────┬────────────┬─────────╮</span></span>
<span class="line"><span>│ Timing type   │    Each │   Relative │   Total │</span></span>
<span class="line"><span>│               │      ms │ Percentage │       s │</span></span>
<span class="line"><span>├───────────────┼─────────┼────────────┼─────────┤</span></span>
<span class="line"><span>│ Properties    │  1.8627 │     3.46 % │  1.0114 │</span></span>
<span class="line"><span>│ Equations     │  2.3969 │     5.79 % │  1.6898 │</span></span>
<span class="line"><span>│ Assembly      │  2.3719 │     5.73 % │  1.6722 │</span></span>
<span class="line"><span>│ Linear solve  │  3.0138 │     5.61 % │  1.6365 │</span></span>
<span class="line"><span>│ Linear setup  │ 22.3882 │    41.65 % │ 12.1568 │</span></span>
<span class="line"><span>│ Precond apply │  1.7442 │    29.93 % │  8.7383 │</span></span>
<span class="line"><span>│ Update        │  0.4265 │     0.79 % │  0.2316 │</span></span>
<span class="line"><span>│ Convergence   │  0.2743 │     0.66 % │  0.1934 │</span></span>
<span class="line"><span>│ Input/Output  │  0.4773 │     0.26 % │  0.0773 │</span></span>
<span class="line"><span>│ Other         │  3.2848 │     6.11 % │  1.7836 │</span></span>
<span class="line"><span>├───────────────┼─────────┼────────────┼─────────┤</span></span>
<span class="line"><span>│ Total         │ 53.7584 │   100.00 % │ 29.1908 │</span></span>
<span class="line"><span>╰───────────────┴─────────┴────────────┴─────────╯</span></span></code></pre></div><h2 id="Coarsen-the-model-and-plot-partition" tabindex="-1">Coarsen the model and plot partition <a class="header-anchor" href="#Coarsen-the-model-and-plot-partition" aria-label="Permalink to &quot;Coarsen the model and plot partition {#Coarsen-the-model-and-plot-partition}&quot;">​</a></h2><p>We coarsen the model using a partition size of 20x20x2 and the IJK method where the underlying structure of the mesh is used to subdivide the blocks. This function automatically handles inactive cells and disconnected blocks and can therefore also work on more complex models.</p><p>We pass a triplet of integers to specify the partition size. This will give an essentially structured partition. Later on, we we will look at graph partitioners.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarse_case </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> coarsen_reservoir_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_case, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), method </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :ijk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarse_model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> coarse_case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarse_reservoir </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(coarse_case)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarse_mesh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> physical_representation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(coarse_reservoir)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> coarse_mesh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">partition</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_mesh, p, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :lipariS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+p+`" alt=""></p><h3 id="Compare-fine-scale-and-coarse-scale-permeability" tabindex="-1">Compare fine-scale and coarse-scale permeability <a class="header-anchor" href="#Compare-fine-scale-and-coarse-scale-permeability" aria-label="Permalink to &quot;Compare fine-scale and coarse-scale permeability {#Compare-fine-scale-and-coarse-scale-permeability}&quot;">​</a></h3><p>The fine-scale and coarse-scale permeability fields are compared visually. The coarsening uses a static upscaling, where the permeability is harmonically averaged per direction when coarsening. This is a simple method that can be effective enough for many cases.</p><p>The fine-scale permeability is shown on the left, and the coarse-scale is shown on the right, with the same color axis.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">K_f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fine_reservoir[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:permeability</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">K_c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> coarse_reservoir[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:permeability</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kcaxis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(K_f)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Fine scale permeability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axf, fine_mesh, K_f, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kcaxis, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :turbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Coarse scale permeability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axc, coarse_mesh, K_c, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kcaxis, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :turbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], plt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+l+`" alt=""></p><h3 id="Simulate-the-coarse-scale-model" tabindex="-1">Simulate the coarse-scale model <a class="header-anchor" href="#Simulate-the-coarse-scale-model" aria-label="Permalink to &quot;Simulate the coarse-scale model {#Simulate-the-coarse-scale-model}&quot;">​</a></h3><p>The coarse scale model can be simulated just as the fine-scale model was, but the runtime should be significantly reduced down to around a second.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ws_c, states_c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(coarse_case, info_level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  1.266736 seconds (4.02 M allocations: 318.144 MiB, 8.66% gc time)</span></span></code></pre></div><h3 id="Plot-and-compare-the-coarse-scale-and-fine-scale-solutions" tabindex="-1">Plot and compare the coarse-scale and fine-scale solutions <a class="header-anchor" href="#Plot-and-compare-the-coarse-scale-and-fine-scale-solutions" aria-label="Permalink to &quot;Plot and compare the coarse-scale and fine-scale solutions {#Plot-and-compare-the-coarse-scale-and-fine-scale-solutions}&quot;">​</a></h3><p>We plot the pressure field for the fine-scale and coarse-scale models. The model has little pressure variation, but we see that there are substantial differences between our very coarse model and the original fine-scale.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Statistics</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_model_wells</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_model)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p_c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> states_c[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Pressure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p_f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Pressure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">caxis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(p_c)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(p_f)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Fine scale&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axf, fine_mesh, p_f, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> caxis, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :turbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axf, fine_mesh, w, fontsize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Coarse scale&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axc, coarse_mesh, p_c, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> caxis, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :turbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axc, fine_mesh, w, fontsize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], plt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+t+`" alt=""></p><h3 id="Plot-and-compare-the-saturation-fields" tabindex="-1">Plot and compare the saturation fields <a class="header-anchor" href="#Plot-and-compare-the-saturation-fields" aria-label="Permalink to &quot;Plot and compare the saturation fields {#Plot-and-compare-the-saturation-fields}&quot;">​</a></h3><p>We observe that the saturation fields are quite different between the coarse-scale and fine scale, with the coarse-scale model showing a more uniform saturation field as the leading shock is smeared away.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s_c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> states_c[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s_f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Saturations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, :]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scaxis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s_c)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s_f)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Fine scale&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axf, fine_mesh, s_f, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scaxis, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :turbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axf, fine_mesh, w, fontsize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Coarse scale&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axc, coarse_mesh, s_c, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scaxis, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :turbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axc, fine_mesh, w, fontsize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], plt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+k+`" alt=""></p><h3 id="Plot-the-average-field-scale-pressure-evolution" tabindex="-1">Plot the average field scale pressure evolution <a class="header-anchor" href="#Plot-the-average-field-scale-pressure-evolution" aria-label="Permalink to &quot;Plot the average field scale pressure evolution {#Plot-the-average-field-scale-pressure-evolution}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axf_p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Avg. pressure / bar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axf_p, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Pressure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, states), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Fine&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axf_p, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Pressure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, states_c), label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Coarse&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">axislegend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+h+'" alt=""></p><h3 id="Plot-the-wells-interactively" tabindex="-1">Plot the wells interactively <a class="header-anchor" href="#Plot-the-wells-interactively" aria-label="Permalink to &quot;Plot the wells interactively {#Plot-the-wells-interactively}&quot;">​</a></h3><p>We can plot the well results in the interactive viewer using the comparison feature that allows multiple results to be superimposed in the same figure.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([ws, ws_c], names </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Fine&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Coarse&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :orat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, accumulated </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="'+r+`" alt=""></p><h3 id="Plot-field-scale-measurables-over-time-interactively" tabindex="-1">Plot field scale measurables over time interactively <a class="header-anchor" href="#Plot-field-scale-measurables-over-time-interactively" aria-label="Permalink to &quot;Plot field scale measurables over time interactively {#Plot-field-scale-measurables-over-time-interactively}&quot;">​</a></h3><p>The field-scale quantities match fairly well between the coarse-scale and fine-scale models. There is always a trade-off between accuracy and quality in numerical simulations, where the goal is to find the right balance between accuracy in quantities of interest and computational cost.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fine_m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_measurables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_case, ws, states)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarse_m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_measurables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(coarse_case, ws_c, states_c)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_m)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, v) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pairs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(coarse_m)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :time</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        m[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;coarse_</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir_measurables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, left </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :fopr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, right </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :coarse_fopr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, accumulated </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="`+E+`" alt=""></p><h2 id="Compare-different-partitioning-methods" tabindex="-1">Compare different partitioning methods <a class="header-anchor" href="#Compare-different-partitioning-methods" aria-label="Permalink to &quot;Compare different partitioning methods {#Compare-different-partitioning-methods}&quot;">​</a></h2><p>We have only so far tested a single partitioning method. We can quickly generate a few other coarse models using different partitioning methods and coarsening values. We highlight that we can also use the centroids instead of the IJK indices to partition, for when the mesh may not have a structured background mesh. In addition, we can call different graph partitioners by passing the desired number of blocks. Here, we call a simple METIS-based transmissibility coarsening, but the code contains options to use other weights and partitioners.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">partition_variants </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:centroids</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:ijk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:metis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:metis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">layout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GridLayout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> layout</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rowwidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">floor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(partition_variants)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (no, variant) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(partition_variants)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> no </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rowwidth</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        row </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> no </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rowwidth</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        row </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> no</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cmethod, cdim </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> variant</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    variant_case </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> coarsen_reservoir_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fine_case, cdim, method </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmethod)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reservoir_domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(variant_case)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> physical_representation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(r)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">partition</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$cmethod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> - </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$cdim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, azimuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, elevation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, fine_mesh, p, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :lipariS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    layout[row, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ax</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    _, variant_states </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(variant_case, info_level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    pres </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> variant_states[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Pressure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    axp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Pressure&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, azimuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, elevation </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, w) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axp, fine_mesh, w, fontsize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axp, m, pres, colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> caxis, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :turbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    layout[row, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> axp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+d+'" alt=""></p><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the JutulDarcy.jl GitHub repository <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/main/examples/model_coarsening.jl" target="_blank" rel="noreferrer">as a script</a>, or as a <a href="https://github.com/sintefmath/JutulDarcy.jl/blob/gh-pages/dev/final_site/notebooks/model_coarsening.ipynb" target="_blank" rel="noreferrer">Jupyter Notebook</a></p><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p>',49)]))}const C=a(y,[["render",g]]);export{b as __pageData,C as default};
